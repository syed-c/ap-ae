import{c as z,j as e}from"./chunk-CPh6voF3.js";import{r as M}from"./chunk-CffrGP6S.js";import{C as m,a as u,b as g,d as p,c as P}from"./chunk-Dwq_v72W.js";import{bL as R,bM as A,I as W,B as y,L as F,p as J,i as r,o as X,C as l,bN as q}from"./index-DflORfjh.js";import{F as V}from"./chunk-BP9BFbSw.js";import{C as j}from"./chunk-CbEmr7WL.js";import{T as k}from"./chunk-DbdCK11k.js";import{E as Z}from"./chunk-CbETxTmt.js";import"./chunk-B8auUmee.js";import"./chunk-DK8nT4cj.js";import"./chunk-Drd-rt-S.js";import"./chunk-BEQ5VEiB.js";import"./chunk-yff5u8mE.js";import"./chunk-xExVBHTi.js";function Ne(){const[w,I]=M.useState(""),[s,D]=M.useState(null),N=z({mutationFn:async t=>{let n=t.trim();if(n.startsWith("http"))try{n=new URL(n).pathname}catch{n=t}n.startsWith("/")||(n="/"+n);const H=`https://apztvwpogywvounohqtk.supabase.co/functions/v1/serve-static?path=${encodeURIComponent(n)}&test=1`,v=await fetch(H,{headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFwenR2d3BvZ3l3dm91bm9ocXRrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEyNTg4NzYsImV4cCI6MjA4NjgzNDg3Nn0.vZHtxYONCM5EM83I0sBKxBvLvNU0oGi7olJSy5FwRkM"}}),U=await v.text(),x=v.headers.get("x-static-cache")||"miss",$=v.status,o=new DOMParser().parseFromString(U,"text/html"),f=o.querySelector("title")?.textContent||"",b=o.querySelector('meta[name="description"]')?.getAttribute("content")||"",C=o.querySelector("h1")?.textContent?.trim()||"",L=o.querySelector('link[rel="canonical"]')?.getAttribute("href")||"",O=(o.querySelector('meta[name="robots"]')?.getAttribute("content")||"").toLowerCase().includes("noindex"),S=(o.body?.textContent||"").split(/\s+/).filter(Boolean).length,a={hasTitle:!!f&&f.length>0,titleLength:f.length,titleText:f,hasDescription:!!b&&b.length>0,descriptionLength:b.length,descriptionText:b,hasH1:!!C&&C.length>0,h1Text:C,hasCanonical:!!L,canonicalUrl:L,hasNoIndex:O,hasContent:S>50,contentWordCount:S,cacheStatus:x,statusCode:$},E=q(n),i=[],c=[],d=E.indexable;a.hasNoIndex&&d?i.push("⚠️ CRITICAL: Has noindex but page SHOULD be indexed (registry mismatch)"):!a.hasNoIndex&&!d&&c.push("Missing noindex for private page"),x==="miss"&&d?c.push("Page cache miss - on-demand prerendering used"):x==="miss-indexable"&&d&&i.push("Page not cached and prerendering failed - minimal HTML served"),a.hasTitle?a.titleLength<30?c.push(`Title too short (${a.titleLength} chars, min 30)`):a.titleLength>60&&c.push(`Title too long (${a.titleLength} chars, max 60)`):i.push("Missing <title> tag"),a.hasDescription?a.descriptionLength<100?c.push(`Description too short (${a.descriptionLength} chars, min 100)`):a.descriptionLength>160&&c.push(`Description too long (${a.descriptionLength} chars, max 160)`):i.push("Missing meta description"),a.hasH1||i.push("Missing H1 tag"),!a.hasCanonical&&d&&c.push("Missing canonical URL"),a.hasContent?a.contentWordCount<300&&d&&c.push(`Low word count (${a.contentWordCount} words, aim for 300+)`):i.push(`Thin content (${a.contentWordCount} words, min 50)`);let h=100;return h-=i.length*15,h-=c.length*5,(x==="hit"||x==="prerendered-cached")&&(h+=10),h=Math.max(0,Math.min(100,h)),{url:n,classification:E,checks:a,score:h,issues:i,warnings:c}},onSuccess:t=>{D(t)}}),T=()=>{w.trim()&&N.mutate(w)},B=t=>t>=80?"text-green-500":t>=60?"text-yellow-500":"text-red-500";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(m,{children:[e.jsx(u,{className:"pb-2",children:e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"Indexable Page Patterns"})}),e.jsxs(p,{children:[e.jsx("span",{className:"text-3xl font-bold text-green-500",children:R.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Routes that need prerendering"})]})]}),e.jsxs(m,{children:[e.jsx(u,{className:"pb-2",children:e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"Private Page Patterns"})}),e.jsxs(p,{children:[e.jsx("span",{className:"text-3xl font-bold text-muted-foreground",children:A.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"CSR-only, noindex routes"})]})]}),e.jsxs(m,{children:[e.jsx(u,{className:"pb-2",children:e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"Render Strategy"})}),e.jsxs(p,{children:[e.jsx("span",{className:"text-lg font-bold",children:"Prerender + Bot Detection"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Vercel rewrites bots to static HTML"})]})]})]}),e.jsxs(m,{children:[e.jsxs(u,{children:[e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5"}),"SEO Health Check"]}),e.jsx(P,{children:"Enter any URL to check its SEO health as seen by search engine bots"})]}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(W,{placeholder:"/dubai/jumeirah or https://www.appointpanda.ae/blog",value:w,onChange:t=>I(t.target.value),onKeyDown:t=>t.key==="Enter"&&T(),className:"flex-1"}),e.jsxs(y,{onClick:T,disabled:N.isPending,children:[N.isPending?e.jsx(F,{className:"h-4 w-4 animate-spin"}):e.jsx(J,{className:"h-4 w-4 mr-1"}),"Check"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Quick test:"}),["/","/california","/california/los-angeles","/blog","/clinic/smile-dental"].map(t=>e.jsx(y,{variant:"ghost",size:"sm",className:"h-6 text-xs",onClick:()=>{I(t),N.mutate(t)},children:t},t))]}),s&&e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.url}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 flex-wrap",children:[e.jsxs(r,{variant:"outline",className:s.classification.indexable?"bg-green-500/10 text-green-500":"bg-muted",children:[e.jsx(X,{className:"h-3 w-3 mr-1"}),s.classification.indexable?"INDEXABLE":"PRIVATE"]}),s.classification.pageType&&e.jsx(r,{variant:"outline",children:s.classification.pageType}),e.jsxs(r,{variant:"outline",className:s.checks.cacheStatus==="hit"||s.checks.cacheStatus==="prerendered-cached"?"bg-green-500/10":s.checks.cacheStatus==="prerendered"?"bg-blue-500/10":"bg-yellow-500/10",children:["Cache: ",s.checks.cacheStatus]}),e.jsxs(r,{variant:"outline",children:[s.checks.contentWordCount," words"]})]}),s.classification.matchedRoute&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Matched route: ",e.jsx("code",{className:"bg-muted px-1 rounded",children:s.classification.matchedRoute})]})]}),e.jsx("div",{className:`text-4xl font-bold ${B(s.score)}`,children:s.score})]}),s.issues.length>0&&e.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg",children:[e.jsxs("p",{className:"font-medium text-red-500 mb-2 flex items-center gap-1",children:[e.jsx(j,{className:"h-4 w-4"}),"Issues (",s.issues.length,")"]}),e.jsx("ul",{className:"space-y-1",children:s.issues.map((t,n)=>e.jsxs("li",{className:"text-sm text-red-400",children:["• ",t]},n))})]}),s.warnings.length>0&&e.jsxs("div",{className:"p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:[e.jsxs("p",{className:"font-medium text-yellow-500 mb-2 flex items-center gap-1",children:[e.jsx(k,{className:"h-4 w-4"}),"Warnings (",s.warnings.length,")"]}),e.jsx("ul",{className:"space-y-1",children:s.warnings.map((t,n)=>e.jsxs("li",{className:"text-sm text-yellow-400",children:["• ",t]},n))})]}),s.issues.length===0&&s.warnings.length===0&&e.jsx("div",{className:"p-3 bg-green-500/10 border border-green-500/20 rounded-lg",children:e.jsxs("p",{className:"font-medium text-green-500 flex items-center gap-1",children:[e.jsx(l,{className:"h-4 w-4"}),"All checks passed!"]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm text-muted-foreground",children:"Title Tag"}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.checks.hasTitle?e.jsx(l,{className:"h-4 w-4 text-green-500"}):e.jsx(j,{className:"h-4 w-4 text-red-500"}),e.jsx("span",{className:"text-sm truncate max-w-xs",title:s.checks.titleText,children:s.checks.titleText||"Missing"}),e.jsxs(r,{variant:"outline",className:"text-xs",children:[s.checks.titleLength," chars"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm text-muted-foreground",children:"Meta Description"}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.checks.hasDescription?e.jsx(l,{className:"h-4 w-4 text-green-500"}):e.jsx(j,{className:"h-4 w-4 text-red-500"}),e.jsxs("span",{className:"text-sm truncate max-w-xs",title:s.checks.descriptionText,children:[s.checks.descriptionText?.substring(0,50)||"Missing","..."]}),e.jsxs(r,{variant:"outline",className:"text-xs",children:[s.checks.descriptionLength," chars"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm text-muted-foreground",children:"H1 Tag"}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.checks.hasH1?e.jsx(l,{className:"h-4 w-4 text-green-500"}):e.jsx(j,{className:"h-4 w-4 text-red-500"}),e.jsx("span",{className:"text-sm truncate max-w-xs",title:s.checks.h1Text,children:s.checks.h1Text||"Missing"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm text-muted-foreground",children:"Canonical URL"}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.checks.hasCanonical?e.jsx(l,{className:"h-4 w-4 text-green-500"}):e.jsx(k,{className:"h-4 w-4 text-yellow-500"}),e.jsx("span",{className:"text-sm truncate max-w-xs",children:s.checks.canonicalUrl||"Not set"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm text-muted-foreground",children:"Robots Directive"}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.checks.hasNoIndex?e.jsx(k,{className:"h-4 w-4 text-yellow-500"}):e.jsx(l,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm",children:s.checks.hasNoIndex?"noindex (blocked)":"index, follow"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm text-muted-foreground",children:"Content"}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.checks.hasContent?e.jsx(l,{className:"h-4 w-4 text-green-500"}):e.jsx(j,{className:"h-4 w-4 text-red-500"}),e.jsxs("span",{className:"text-sm",children:[s.checks.contentWordCount," words"]})]})]})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsx(y,{variant:"outline",asChild:!0,children:e.jsxs("a",{href:`https://www.appointpanda.ae${s.url}`,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"View Live Page"]})})})]})]})]}),e.jsxs(m,{children:[e.jsxs(u,{children:[e.jsx(g,{children:"Page Registry"}),e.jsx(P,{children:"All routes classified by indexability and render mode"})]}),e.jsx(p,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2 text-green-500",children:"Indexable Pages (Prerender)"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:R.map(t=>e.jsx(r,{variant:"outline",className:"bg-green-500/10",children:t.route},t.route))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2 text-muted-foreground",children:"Private Pages (CSR)"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:A.map(t=>e.jsx(r,{variant:"outline",className:"bg-muted",children:t.route},t.route))})]})]})})]})]})}export{Ne as default};
