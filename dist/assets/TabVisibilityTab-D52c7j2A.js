import{b as $,u as z,c as K,j as e}from"./chunk-CPh6voF3.js";import{r as l}from"./chunk-CffrGP6S.js";import{B as m,o as U,v as R,i as W,I as Y,w as J,U as X,m as ee,p as se,x as ie,q as te,G as ae,A as oe,T as ne,E as re,P as le,Z as ce,n as de,t as me,s as w,b as O}from"./index-DflORfjh.js";import{C as x,d as y,a as k,b as A,c as E}from"./chunk-Dwq_v72W.js";import{S as P}from"./chunk-DfjE-bP6.js";import{S as I}from"./chunk-CQtADEjB.js";import{T as pe,a as ue,b as M,c as B}from"./chunk-k8HiDHrE.js";import{c as ge}from"./chunk-BSjc5zjM.js";import{E as c}from"./chunk-CcezodbN.js";import{S as be}from"./chunk-C7BdFRQZ.js";import{R as he}from"./chunk-BOvFDp2b.js";import{I as fe}from"./chunk-I1o_Hd8I.js";import{E as D}from"./chunk-Dfi7JVLs.js";import{a as xe,S as ye,P as Se,I as je,A as Ce}from"./chunk-C2VW2Ml6.js";import{U as ve}from"./chunk-D2X27E5n.js";import{F as Te}from"./chunk-BaL04tya.js";import{B as Ne}from"./chunk-B_ghW3Ra.js";import{B as we}from"./chunk-Bl7VVhKV.js";import{C as Oe,a as ke}from"./chunk-j7XJPWWF.js";import{M as Ae}from"./chunk-B7d2qnKb.js";import{F as Ee}from"./chunk-3oqKMbN4.js";import"./chunk-B8auUmee.js";import"./chunk-DK8nT4cj.js";import"./chunk-Drd-rt-S.js";import"./chunk-BEQ5VEiB.js";import"./chunk-yff5u8mE.js";import"./chunk-xExVBHTi.js";import"./chunk-CyRXX0qx.js";import"./chunk-DncHrJ4I.js";import"./chunk-CbETxTmt.js";import"./chunk-DbdCK11k.js";import"./chunk-GLPyMM0F.js";import"./chunk-CedtSHBb.js";const L={LayoutDashboard:xe,Building2:J,Users:X,Shield:U,Calendar:ee,Search:se,Settings:ye,Stethoscope:R,MapPin:ie,UserPlus:ve,FileText:Te,BookOpen:Ne,Bot:we,Lock:te,CreditCard:Oe,ClipboardList:ke,Globe:ae,Mail:oe,Palette:Se,TrendingUp:ne,MessageSquare:Ae,Target:re,Phone:le,Inbox:je,Zap:ce,Star:de,Flag:Ee,Activity:Ce,Clock:me,Eye:c,EyeOff:D},p=[{id:"overview",label:"Command Center",icon:"LayoutDashboard",group:"Overview"},{id:"weekly",label:"Weekly Report",icon:"TrendingUp",group:"Overview"},{id:"clinics",label:"Dental Offices",icon:"Building2",group:"Users & Clinics"},{id:"users",label:"Users",icon:"Users",group:"Users & Clinics"},{id:"claims",label:"Claims",icon:"Shield",group:"Users & Clinics"},{id:"treatments",label:"Treatments",icon:"Stethoscope",group:"Users & Clinics"},{id:"locations",label:"Locations",icon:"MapPin",group:"Users & Clinics"},{id:"review-insights",label:"Review Insights",icon:"MessageSquare",group:"Reputation"},{id:"gmb-connections",label:"GMB Connections",icon:"Globe",group:"Reputation"},{id:"gmb-scraper",label:"Scraper Bot",icon:"Bot",group:"Marketing"},{id:"gmb-bridge",label:"Google Import",icon:"Globe",group:"Marketing"},{id:"outreach",label:"Outreach Center",icon:"Mail",group:"Marketing"},{id:"promotions",label:"Promotions",icon:"Target",group:"Marketing"},{id:"appointments",label:"Appointments",icon:"Calendar",group:"Appointments"},{id:"leads",label:"Lead CRM",icon:"UserPlus",group:"Appointments"},{id:"pages",label:"Page Manager",icon:"FileText",group:"Content & SEO"},{id:"blog",label:"Blog",icon:"BookOpen",group:"Content & SEO"},{id:"seo",label:"SEO Management",icon:"Search",group:"Content & SEO"},{id:"seo-bot",label:"SEO Bot",icon:"Bot",group:"Content & SEO"},{id:"seo-copilot",label:"SEO Copilot",icon:"Target",group:"Content & SEO"},{id:"seo-content-optimizer",label:"Content Optimizer",icon:"Zap",group:"Content & SEO"},{id:"ranking-rules",label:"Ranking Rules",icon:"TrendingUp",group:"Content & SEO"},{id:"pinned-profiles",label:"Pinned Profiles",icon:"Star",group:"Content & SEO"},{id:"top-dentists",label:"Top Dentists",icon:"Star",group:"Content & SEO"},{id:"api-control",label:"API Control",icon:"Zap",group:"Integrations"},{id:"crm-numbers",label:"CRM Numbers",icon:"Phone",group:"Integrations"},{id:"messaging-control",label:"Messaging",icon:"MessageSquare",group:"Integrations"},{id:"marketplace-control",label:"Marketplace Control",icon:"Target",group:"System"},{id:"system-audit",label:"System Audit",icon:"Activity",group:"System"},{id:"feature-flags",label:"Feature Flags",icon:"Flag",group:"System"},{id:"roles",label:"Access Control",icon:"Lock",group:"System"},{id:"platform-services",label:"Platform Services",icon:"Zap",group:"System"},{id:"plans",label:"Plans & Features",icon:"CreditCard",group:"System"},{id:"subscriptions",label:"Revenue",icon:"CreditCard",group:"System"},{id:"ai-controls",label:"AI Controls",icon:"Bot",group:"System"},{id:"automation",label:"Automation Rules",icon:"Zap",group:"System"},{id:"support-admin",label:"Support Tickets",icon:"Shield",group:"System"},{id:"audit",label:"Audit Logs",icon:"ClipboardList",group:"System"},{id:"smoke-test",label:"URL Smoke Test",icon:"Globe",group:"System"},{id:"site-config",label:"Header / Footer",icon:"Palette",group:"System"},{id:"contact-details",label:"Contact Details",icon:"Phone",group:"System"},{id:"settings",label:"Settings",icon:"Settings",group:"System"}],u=[{id:"my-dashboard",label:"My Practice",icon:"LayoutDashboard",group:"Dashboard"},{id:"my-appointments",label:"Appointments",icon:"Calendar",group:"Operations"},{id:"my-availability",label:"Availability",icon:"Clock",group:"Operations"},{id:"my-appointment-types",label:"Appointment Types",icon:"Stethoscope",group:"Operations"},{id:"my-patients",label:"Patients",icon:"Users",group:"Operations"},{id:"my-messages",label:"Messages",icon:"Inbox",group:"Operations"},{id:"my-intake-forms",label:"Intake Forms",icon:"ClipboardList",group:"Operations"},{id:"my-operations",label:"Automation",icon:"Zap",group:"Operations"},{id:"my-profile",label:"Edit Profile",icon:"Building2",group:"Profile"},{id:"my-team",label:"Team",icon:"Users",group:"Profile"},{id:"my-services",label:"Services",icon:"Stethoscope",group:"Profile"},{id:"my-insurance",label:"Insurance",icon:"Shield",group:"Profile"},{id:"my-reputation",label:"Reputation Suite",icon:"Star",group:"Reputation"},{id:"my-settings",label:"Settings",icon:"Settings",group:"Settings"},{id:"my-support",label:"Support Tickets",icon:"Shield",group:"Settings"}];function ds(){const S=$(),[g,F]=l.useState(""),[n,V]=l.useState("admin"),[b,h]=l.useState({adminTabs:Object.fromEntries(p.map(s=>[s.id,!0])),dentistTabs:Object.fromEntries(u.map(s=>[s.id,!0]))}),[_,f]=l.useState(!1),{data:d,isLoading:q}=z({queryKey:["tab-visibility-settings"],queryFn:async()=>{const{data:s,error:t}=await w.from("global_settings").select("*").eq("key","tab_visibility").maybeSingle();if(t)throw t;return s?.value}});l.useEffect(()=>{d&&h({adminTabs:{...Object.fromEntries(p.map(s=>[s.id,!0])),...d.adminTabs},dentistTabs:{...Object.fromEntries(u.map(s=>[s.id,!0])),...d.dentistTabs}})},[d]);const j=K({mutationFn:async s=>{const{error:t}=await w.from("global_settings").upsert({key:"tab_visibility",value:s,description:"Tab visibility settings for admin and dentist dashboards",updated_at:new Date().toISOString()},{onConflict:"key"});if(t)throw t;await ge({action:"UPDATE_TAB_VISIBILITY",entityType:"global_settings",entityId:"tab_visibility",newValues:{hiddenAdminTabs:Object.entries(s.adminTabs).filter(([,i])=>!i).map(([i])=>i),hiddenDentistTabs:Object.entries(s.dentistTabs).filter(([,i])=>!i).map(([i])=>i)}})},onSuccess:()=>{S.invalidateQueries({queryKey:["tab-visibility-settings"]}),O.success("Tab visibility saved successfully"),f(!1)},onError:s=>O.error("Failed to save: "+s.message)}),C=(s,t)=>{h(i=>({...i,[t==="admin"?"adminTabs":"dentistTabs"]:{...i[t==="admin"?"adminTabs":"dentistTabs"],[s]:!i[t==="admin"?"adminTabs":"dentistTabs"][s]}})),f(!0)},v=(s,t)=>{const i=s==="admin"?p:u;h(o=>({...o,[s==="admin"?"adminTabs":"dentistTabs"]:Object.fromEntries(i.map(a=>[a.id,t]))})),f(!0)},G=(s,t)=>{const i={};return s.forEach(o=>{i[o.group]||(i[o.group]=[]),i[o.group].push(o)}),i},T=n==="admin"?p:u,r=n==="admin"?b.adminTabs:b.dentistTabs,Z=G(T),N=Object.entries(Z).reduce((s,[t,i])=>{const o=i.filter(a=>a.label.toLowerCase().includes(g.toLowerCase())||a.id.toLowerCase().includes(g.toLowerCase()));return o.length>0&&(s[t]=o),s},{}),H=Object.values(r).filter(Boolean).length,Q=T.length;return q?e.jsxs("div",{className:"space-y-6",children:[e.jsx(I,{className:"h-12 w-64"}),e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:[1,2,3,4].map(s=>e.jsx(I,{className:"h-32"},s))})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between flex-wrap gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-display font-bold text-foreground flex items-center gap-3",children:[e.jsx(c,{className:"h-8 w-8 text-primary"}),"Tab Visibility Control"]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Control which tabs are visible in Super Admin and Dentist dashboards"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[_&&e.jsxs(m,{onClick:()=>j.mutate(b),disabled:j.isPending,className:"gap-2 bg-teal hover:bg-teal/90",children:[e.jsx(be,{className:"h-4 w-4"}),"Save Changes"]}),e.jsx(m,{variant:"ghost",onClick:()=>S.invalidateQueries({queryKey:["tab-visibility-settings"]}),children:e.jsx(he,{className:"h-4 w-4"})})]})]}),e.jsx(x,{className:"bg-amber-500/10 border-amber-500/30",children:e.jsx(y,{className:"pt-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(fe,{className:"h-5 w-5 text-amber-500 shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-foreground",children:"How This Works"}),e.jsx("p",{className:"text-muted-foreground",children:"Turning off a tab will hide it from the sidebar navigation for all users of that dashboard type. Hidden tabs won't be accessible even via direct URL. All changes are logged to the audit trail."})]})]})})}),e.jsxs(pe,{value:n,onValueChange:s=>V(s),children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs(ue,{className:"bg-muted",children:[e.jsxs(M,{value:"admin",className:"gap-2",children:[e.jsx(U,{className:"h-4 w-4"}),"Super Admin Tabs"]}),e.jsxs(M,{value:"dentist",className:"gap-2",children:[e.jsx(R,{className:"h-4 w-4"}),"Dentist Dashboard Tabs"]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(W,{variant:"outline",children:[H," / ",Q," Visible"]})})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between flex-wrap gap-4",children:[e.jsx(Y,{placeholder:"Search tabs...",value:g,onChange:s=>F(s.target.value),className:"max-w-xs"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>v(n,!0),children:[e.jsx(c,{className:"h-4 w-4 mr-2"}),"Show All"]}),e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>v(n,!1),children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Hide All"]})]})]}),e.jsx(B,{value:"admin",className:"mt-6",children:e.jsx("div",{className:"grid lg:grid-cols-2 xl:grid-cols-3 gap-4",children:Object.entries(N).map(([s,t])=>e.jsxs(x,{children:[e.jsxs(k,{className:"pb-3",children:[e.jsx(A,{className:"text-base font-semibold",children:s}),e.jsxs(E,{className:"text-xs",children:[t.filter(i=>r[i.id]).length," / ",t.length," visible"]})]}),e.jsx(y,{className:"space-y-2",children:t.map(i=>{const o=L[i.icon]||c,a=r[i.id];return e.jsxs("div",{className:`flex items-center justify-between p-2 rounded-lg border transition-colors ${a?"bg-muted/30":"bg-muted/10 opacity-60"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{className:`h-4 w-4 ${a?"text-foreground":"text-muted-foreground"}`}),e.jsx("span",{className:`text-sm ${a?"text-foreground":"text-muted-foreground line-through"}`,children:i.label})]}),e.jsx(P,{checked:a,onCheckedChange:()=>C(i.id,"admin")})]},i.id)})})]},s))})}),e.jsx(B,{value:"dentist",className:"mt-6",children:e.jsx("div",{className:"grid lg:grid-cols-2 xl:grid-cols-3 gap-4",children:Object.entries(N).map(([s,t])=>e.jsxs(x,{children:[e.jsxs(k,{className:"pb-3",children:[e.jsx(A,{className:"text-base font-semibold",children:s}),e.jsxs(E,{className:"text-xs",children:[t.filter(i=>r[i.id]).length," / ",t.length," visible"]})]}),e.jsx(y,{className:"space-y-2",children:t.map(i=>{const o=L[i.icon]||c,a=r[i.id];return e.jsxs("div",{className:`flex items-center justify-between p-2 rounded-lg border transition-colors ${a?"bg-muted/30":"bg-muted/10 opacity-60"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{className:`h-4 w-4 ${a?"text-foreground":"text-muted-foreground"}`}),e.jsx("span",{className:`text-sm ${a?"text-foreground":"text-muted-foreground line-through"}`,children:i.label})]}),e.jsx(P,{checked:a,onCheckedChange:()=>C(i.id,"dentist")})]},i.id)})})]},s))})})]})]})}export{ds as default};
