import{b as as,u as xe,j as e,c as us}from"./chunk-CPh6voF3.js";import{r as i}from"./chunk-CffrGP6S.js";import{b as u,B as c,bA as ve,bC as ze,x as rs,G as is,C as Z,p as Oe,I as Be,a2 as De,a3 as Pe,a5 as Re,a6 as _e,a7 as fe,i as G,S as we,b7 as Fe,a9 as Me,aa as Ue,ab as We,ac as He,ad as Ke,ae as Qe,y as Ce,s as A,L as he,v as ts,Z as ps,aG as gs,al as ds,t as js,w as es}from"./index-DflORfjh.js";import{C as N,d as b,a as le,b as ce,c as Ne}from"./chunk-Dwq_v72W.js";import{P as be}from"./chunk-DSDQubI6.js";import{T as Ve,a as Ye,b as J,c as E,d as Ze,e as C}from"./chunk-NLs5Ye4A.js";import{T as ms,a as hs,b as me,c as je}from"./chunk-k8HiDHrE.js";import{L as Je}from"./chunk-Drd-rt-S.js";import{S as xs}from"./chunk-D0B-jfny.js";import{R as Xe}from"./chunk-BOvFDp2b.js";import{B as ls}from"./chunk-BiqSGqdV.js";import{W as ke}from"./chunk-Bvo6Oh0W.js";import{S as ns}from"./chunk-qKgaU6ML.js";import{C as ue}from"./chunk-GLPyMM0F.js";import{C as fs,a as Ns,b as bs}from"./chunk-CEjy5RHq.js";import{S as vs}from"./chunk-C2VW2Ml6.js";import{F as $e}from"./chunk-BaL04tya.js";import{I as ge}from"./chunk-DZK1lt0q.js";import{C as cs}from"./chunk-Bdl4gyLq.js";import{S as Le}from"./chunk-B51FxpoB.js";import{E as ws}from"./chunk-CbETxTmt.js";import{E as ys}from"./chunk-CcezodbN.js";import{S as Ss}from"./chunk-C7BdFRQZ.js";import"./chunk-B8auUmee.js";import"./chunk-DK8nT4cj.js";import"./chunk-BEQ5VEiB.js";import"./chunk-yff5u8mE.js";import"./chunk-xExVBHTi.js";import"./chunk-CKWDY2Lf.js";const Cs=[{value:200,label:"200 words (Standard)"},{value:300,label:"300 words (Detailed)"},{value:400,label:"400 words (Comprehensive)"},{value:500,label:"500 words (Full)"},{value:750,label:"750 words (Extended)"}],ss="location-enrichment-progress";function ks(){as();const[v,Ee]=i.useState("states"),[O,l]=i.useState(""),[T,oe]=i.useState(new Set),[L,ne]=i.useState(300),[q,pe]=i.useState(!1),[R,te]=i.useState(!1),[ye,V]=i.useState(!1),[X,ae]=i.useState(!1),Y=i.useRef(!1),B=i.useRef(!1),[p,W]=i.useState({status:"idle",total:0,processed:0,errors:0,startedAt:null,logs:[],estimatedTimeRemaining:"-"});i.useEffect(()=>{try{const a=localStorage.getItem(ss);if(a){const o=JSON.parse(a);(o.status==="running"||o.status==="paused")&&(W({...o,status:"paused",startedAt:o.startedAt?new Date(o.startedAt):null,logs:o.logs.map(k=>({...k,timestamp:new Date(k.timestamp)}))}),u.info("Previous generation was interrupted. You can resume or restart."))}}catch(a){console.error("Failed to load saved progress:",a)}},[]),i.useEffect(()=>{if(p.status!=="idle")try{localStorage.setItem(ss,JSON.stringify(p))}catch(a){console.error("Failed to save progress:",a)}},[p]);const{data:P=[],refetch:re}=xe({queryKey:["location-enrichment-states",O],queryFn:async()=>{let a=A.from("states").select("id, name, slug, abbreviation").eq("is_active",!0).order("name");O&&(a=a.ilike("name",`%${O}%`));const{data:o,error:k}=await a;if(k)throw k;const Q=o?.map(y=>`/${y.slug}`)||[],{data:z}=await A.from("seo_pages").select("slug").in("slug",Q).eq("is_optimized",!0),w=new Set(z?.map(y=>y.slug)||[]);return(o||[]).map(y=>({id:y.id,name:y.name,slug:y.slug,type:"state",stateAbbr:y.abbreviation,hasContent:w.has(`/${y.slug}`)}))}}),{data:F=[],refetch:H}=xe({queryKey:["location-enrichment-cities",O],queryFn:async()=>{let a=A.from("cities").select(`
          id, name, slug, dentist_count,
          state:states!inner(id, name, slug, abbreviation, is_active)
        `).eq("is_active",!0).eq("state.is_active",!0).order("name");O&&(a=a.ilike("name",`%${O}%`));const{data:o,error:k}=await a;if(k)throw k;const Q=o?.map(w=>`/${w.state?.slug}/${w.slug}`)||[],z=new Set;if(Q.length>0)for(let y=0;y<Q.length;y+=500){const M=Q.slice(y,y+500),{data:U}=await A.from("seo_pages").select("slug").in("slug",M).eq("is_optimized",!0);U?.forEach(s=>z.add(s.slug))}return(o||[]).map(w=>{const y=w.state;return{id:w.id,name:w.name,slug:w.slug,type:"city",stateAbbr:y?.abbreviation,stateSlug:y?.slug,hasContent:z.has(`/${y?.slug}/${w.slug}`),clinicCount:w.dentist_count}})}}),h=v==="states"?P:F,$=h.filter(a=>!a.hasContent);h.filter(a=>a.hasContent);const Te=async()=>{V(!0),await Promise.all([re(),H()]),V(!1),u.success("Data refreshed!")},ie=a=>{oe(o=>{const k=new Set(o);return k.has(a)?k.delete(a):k.add(a),k})},D=()=>{const a=$.map(o=>o.id);oe(new Set(a)),u.success(`Selected all ${a.length} items needing content`)},de=()=>{oe(new Set)},g=a=>{W(o=>({...o,logs:[{...a,timestamp:new Date},...o.logs].slice(0,500)}))},_=(a,o,k)=>{if(a===0)return"Calculating...";const z=(Date.now()-k.getTime())/a,w=(o-a)*z;return w<6e4?`${Math.ceil(w/1e3)}s`:w<36e5?`${Math.ceil(w/6e4)}m`:`${(w/36e5).toFixed(1)}h`},ee=()=>{B.current=!0,W(a=>({...a,status:"stopped"})),g({item:"",action:"info",message:"Generation stopped by user"}),u.info("Generation stopped")},Ae=()=>{X?(Y.current=!1,ae(!1),W(a=>({...a,status:"running"})),g({item:"",action:"resumed",message:"Generation resumed"}),u.success("Generation resumed")):(Y.current=!0,ae(!0),W(a=>({...a,status:"paused"})),g({item:"",action:"paused",message:"Generation paused"}),u.info("Generation paused"))},se=async()=>{if(T.size===0){u.error("Please select at least one location");return}pe(!0),te(!1),B.current=!1,Y.current=!1,ae(!1);const a=h.filter(M=>T.has(M.id)),o=5,k=[];for(let M=0;M<a.length;M+=o)k.push(a.slice(M,M+o));const Q=new Date;W({status:"running",total:a.length,processed:0,errors:0,startedAt:Q,logs:[],estimatedTimeRemaining:"Calculating..."}),g({item:"",action:"started",message:`Starting bulk generation for ${a.length} ${v} with ${L} words...`});let z=0,w=0,y=0;try{for(let U=0;U<k.length&&!B.current;U++){for(;Y.current&&!B.current;)await new Promise(s=>setTimeout(s,500));if(B.current)break;g({item:"",action:"info",message:`Processing batch ${U+1}/${k.length}...`});for(const s of k[U]){if(B.current)break;for(;Y.current&&!B.current;)await new Promise(j=>setTimeout(j,500));if(B.current)break;try{const j=s.type==="state"?`/${s.slug}`:`/${s.stateSlug}/${s.slug}`,{data:t,error:r}=await A.functions.invoke("seo-content-optimizer",{body:{action:"generate_location_content",pageType:s.type,slug:j,locationName:s.name,stateAbbr:s.stateAbbr,wordCount:L}});if(r)throw r;g({item:s.name,action:"completed",message:"Content generated successfully"}),z++,y++}catch(j){g({item:s.name,action:"error",message:`Error: ${j instanceof Error?j.message:"Unknown error"}`}),w++,z++}const f=_(z,a.length,Q);W(j=>({...j,processed:z,errors:w,estimatedTimeRemaining:f})),await new Promise(j=>setTimeout(j,200))}}const M=B.current?"stopped":"completed";W(U=>({...U,status:M,estimatedTimeRemaining:"-"})),g({item:"",action:"completed",message:`Complete! Generated: ${y}, Errors: ${w}`}),u.success(`Generated content for ${y} locations`),de(),localStorage.removeItem(ss),v==="states"?re():H()}catch{W(U=>({...U,status:"stopped"})),u.error("Bulk generation failed")}finally{pe(!1)}},Ie=a=>{switch(a){case"started":return e.jsx(ve,{className:"h-3 w-3 text-primary"});case"completed":return e.jsx(Z,{className:"h-3 w-3 text-teal"});case"error":return e.jsx(ue,{className:"h-3 w-3 text-coral"});case"paused":return e.jsx(ze,{className:"h-3 w-3 text-amber-500"});case"resumed":return e.jsx(ve,{className:"h-3 w-3 text-teal"});case"info":return e.jsx(he,{className:"h-3 w-3 animate-spin text-primary"})}},K=a=>{switch(a){case"running":return"bg-primary";case"paused":return"bg-amber-500";case"completed":return"bg-teal";case"stopped":return"bg-coral";default:return"bg-muted"}};return e.jsxs("div",{className:"space-y-6",children:[(p.status==="running"||p.status==="paused")&&e.jsx(N,{className:"border-2 border-primary bg-primary/5",children:e.jsxs(b,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`h-3 w-3 rounded-full ${K(p.status)} ${p.status==="running"?"animate-pulse":""}`}),e.jsx("span",{className:"font-semibold text-lg",children:p.status==="running"?"Generating Content...":"Generation Paused"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:Ae,children:[X?e.jsx(ve,{className:"h-4 w-4 mr-1"}):e.jsx(ze,{className:"h-4 w-4 mr-1"}),X?"Resume":"Pause"]}),e.jsxs(c,{variant:"destructive",size:"sm",onClick:ee,children:[e.jsx(xs,{className:"h-4 w-4 mr-1"}),"Stop"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:p.processed}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Processed"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:p.total}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-teal",children:p.processed-p.errors}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Success"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-coral",children:p.errors}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Errors"})]})]}),e.jsx(be,{value:p.processed/p.total*100,className:"h-3 mb-2"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:["ETA: ",p.estimatedTimeRemaining]}),e.jsxs("span",{children:[Math.round(p.processed/p.total*100),"% complete"]})]})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx(rs,{className:"h-5 w-5 text-primary"}),"Location Pages Content"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Generate unique SEO content for State and City pages"})]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:Te,disabled:ye,children:[e.jsx(Xe,{className:`h-4 w-4 mr-2 ${ye?"animate-spin":""}`}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(N,{children:e.jsx(b,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(is,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:P.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total States"})]})]})})}),e.jsx(N,{children:e.jsx(b,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Z,{className:"h-8 w-8 text-teal"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:P.filter(a=>a.hasContent).length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"States with Content"})]})]})})}),e.jsx(N,{children:e.jsx(b,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ls,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:F.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Cities"})]})]})})}),e.jsx(N,{children:e.jsx(b,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Z,{className:"h-8 w-8 text-teal"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:F.filter(a=>a.hasContent).length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Cities with Content"})]})]})})})]}),e.jsxs(ms,{value:v,onValueChange:a=>{Ee(a),de()},children:[e.jsxs(hs,{children:[e.jsxs(me,{value:"states",children:[e.jsx(is,{className:"h-4 w-4 mr-2"}),"States (",P.filter(a=>!a.hasContent).length," need content)"]}),e.jsxs(me,{value:"cities",children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Cities (",F.filter(a=>!a.hasContent).length," need content)"]})]}),e.jsxs(je,{value:v,className:"mt-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Oe,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Be,{placeholder:`Search ${v}...`,value:O,onChange:a=>l(a.target.value),className:"pl-10"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(De,{value:L.toString(),onValueChange:a=>ne(parseInt(a)),children:[e.jsx(Pe,{className:"w-[200px]",children:e.jsx(Re,{placeholder:"Word count"})}),e.jsx(_e,{children:Cs.map(a=>e.jsx(fe,{value:a.value.toString(),children:a.label},a.value))})]})})]}),T.size>0&&e.jsxs("div",{className:"bg-primary/10 border border-primary/20 rounded-lg p-4 mb-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(G,{variant:"secondary",className:"text-sm",children:[T.size," selected"]}),e.jsx(c,{variant:"ghost",size:"sm",onClick:de,children:"Clear selection"})]}),e.jsxs(c,{onClick:()=>te(!0),disabled:q,children:[e.jsx(ke,{className:"h-4 w-4 mr-2"}),"Generate Content for Selected"]})]}),p&&e.jsx(N,{className:"mb-4",children:e.jsxs(b,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:p.status==="running"?"Generating...":"Complete"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[p.processed,"/",p.total," (",p.errors," errors)"]})]}),e.jsx(be,{value:p.processed/p.total*100,className:"mb-4"}),e.jsx(we,{className:"h-32 border rounded p-2",children:p.logs.map((a,o)=>e.jsxs("div",{className:"flex items-start gap-2 text-xs py-1",children:[Ie(a.action),e.jsx("span",{className:"text-muted-foreground",children:a.timestamp.toLocaleTimeString()}),a.item&&e.jsxs("span",{className:"font-medium",children:[a.item,":"]}),e.jsx("span",{children:a.message})]},o))})]})}),e.jsxs(N,{children:[e.jsx(le,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(ce,{className:"text-base",children:[v==="states"?"States":"Cities"," Needing Content"]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:D,children:[e.jsx(ns,{className:"h-4 w-4 mr-2"}),"Select All (",$.length,")"]})]})}),e.jsx(b,{children:e.jsx(we,{className:"h-[400px]",children:e.jsxs(Ve,{children:[e.jsx(Ye,{children:e.jsxs(J,{children:[e.jsx(E,{className:"w-12"}),e.jsx(E,{children:"Name"}),v==="cities"&&e.jsx(E,{children:"State"}),v==="cities"&&e.jsx(E,{children:"Clinics"}),e.jsx(E,{children:"Status"}),e.jsx(E,{children:"Preview"})]})}),e.jsxs(Ze,{children:[$.map(a=>e.jsxs(J,{children:[e.jsx(C,{children:e.jsx(Fe,{checked:T.has(a.id),onCheckedChange:()=>ie(a.id)})}),e.jsx(C,{className:"font-medium",children:a.name}),v==="cities"&&e.jsx(C,{children:a.stateAbbr}),v==="cities"&&e.jsx(C,{children:a.clinicCount}),e.jsx(C,{children:e.jsxs(G,{variant:"outline",className:"text-coral border-coral",children:[e.jsx(ue,{className:"h-3 w-3 mr-1"}),"No Content"]})}),e.jsx(C,{children:e.jsx(Je,{to:a.type==="state"?`/${a.slug}`:`/${a.stateSlug}/${a.slug}`,target:"_blank",className:"text-primary hover:underline text-sm",children:"View Page"})})]},a.id)),$.length===0&&e.jsx(J,{children:e.jsxs(C,{colSpan:v==="cities"?6:4,className:"text-center py-8 text-muted-foreground",children:[e.jsx(Z,{className:"h-8 w-8 mx-auto mb-2 text-teal"}),"All ",v," have content!"]})})]})]})})})]})]})]}),e.jsx(Me,{open:R,onOpenChange:te,children:e.jsxs(Ue,{children:[e.jsxs(We,{children:[e.jsxs(He,{children:["Generate Content for ",T.size," Locations"]}),e.jsxs(Ke,{children:["This will generate unique SEO content for each selected ",v==="states"?"state":"city"," page. Each location will receive ",L," words of unique content."]})]}),e.jsx("div",{className:"py-4",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Estimated time: ~",Math.ceil(T.size*3/60)," minutes"]})}),e.jsxs(Qe,{children:[e.jsx(c,{variant:"outline",onClick:()=>te(!1),children:"Cancel"}),e.jsxs(c,{onClick:se,children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"Start Generation"]})]})]})})]})}const Es=[{value:300,label:"300 words (Standard)"},{value:400,label:"400 words (Detailed)"},{value:500,label:"500 words (Comprehensive)"},{value:750,label:"750 words (Full)"},{value:1e3,label:"1000 words (Extended)"}],os=`You are a senior healthcare SEO content writer and local search strategist.

You are writing a SERVICE-LOCATION PAGE for a dental directory platform (NOT a clinic website).
This page helps users find dentists offering a specific treatment in a specific UAE location.

IMPORTANT CONTEXT:
- This website does NOT provide treatment.
- It connects patients with licensed dentists and clinics.
- Content must guide, educate, and help patients choose — not advertise one clinic.
- The goal is to rank organically on Google using helpful content principles and E-E-A-T.

GOOGLE & QUALITY REQUIREMENTS (MANDATORY):
- Google Helpful Content System compliance
- E-E-A-T (Experience, Expertise, Authoritativeness, Trustworthiness)
- YMYL medical safety guidelines
- Human written tone (no AI generic phrasing)
- Local intent optimization
- Semantic SEO (entities, variations, natural language)
- No keyword stuffing, promotional claims, fake statistics, copied templates, or filler paragraphs

WRITING STYLE:
- Write like a knowledgeable healthcare guide helping a patient choose safely.
- Tone: Clear, human, reassuring, informative. Not robotic, salesy, or repetitive.
- Avoid: "best clinic", "top dentist", "leading clinic", exaggerated claims.
- Use: Practical explanations, decision-making help, realistic expectations, safety guidance, UAE healthcare context.

LOCALIZATION RULES:
- Strongly localize to the specific area and emirate in UAE.
- Include naturally: nearby communities, typical resident needs (family, professionals, expats), accessibility, urban lifestyle relevance, DHA/MOHAP licensing context.
- Do NOT insert random landmarks or fake details.

STRUCTURE:
- H1: Find {SERVICE} in {AREA}, {EMIRATE}
- Intro: Who needs this treatment and why people search locally
- What Is {SERVICE}? — Simple language, realistic expectations
- When Should You Consider It? — Symptoms/situations
- Choosing a Dentist in {AREA} — Experience, technology, consultation clarity, treatment planning
- Cost of {SERVICE} in {EMIRATE} — Price ranges generally, factors affecting price, NO exact numbers
- Safety & Regulations in UAE — DHA/MOHAP standards, why licensed dentists matter
- Questions Patients Usually Ask — 5-7 natural FAQs (informational, not promotional)
- How Our Directory Helps — How platform helps compare clinics
- Closing — Encourage informed decision without pressure

SEO RULES:
- Natural variations: dentist in {AREA}, dental clinic in {AREA}, {SERVICE} in {EMIRATE}, treatment options near me
- Semantic entities: procedure steps, recovery, consultation, treatment planning, oral health goals
- Do NOT repeat keywords unnaturally.

PROHIBITED: No guaranteed outcomes, superiority claims, fake doctor authority, medical diagnosis, or prescriptions.`,qe="service-location-enrichment-progress";function Ts(){as();const[v,Ee]=i.useState(""),[O,l]=i.useState("all"),[T,oe]=i.useState("all"),[L,ne]=i.useState(new Set),[q,pe]=i.useState(400),[R,te]=i.useState(!1),[ye,V]=i.useState(!1),[X,ae]=i.useState(!1),[Y,B]=i.useState(os),[p,W]=i.useState(!1),[P,re]=i.useState(!1),F=i.useRef(!1),H=i.useRef(!1),[h,$]=i.useState({status:"idle",total:0,processed:0,errors:0,startedAt:null,logs:[],currentBatch:0,totalBatches:0,estimatedTimeRemaining:"-"});i.useEffect(()=>{try{const s=localStorage.getItem(qe);if(s){const f=JSON.parse(s);(f.status==="running"||f.status==="paused")&&($({...f,status:"paused",startedAt:f.startedAt?new Date(f.startedAt):null,logs:f.logs.map(j=>({...j,timestamp:new Date(j.timestamp)}))}),u.info("Previous generation was interrupted. You can resume or restart."))}}catch(s){console.error("Failed to load saved progress:",s)}},[]),i.useEffect(()=>{if(h.status!=="idle")try{localStorage.setItem(qe,JSON.stringify(h))}catch(s){console.error("Failed to save progress:",s)}},[h]);const{data:Te=[]}=xe({queryKey:["enrichment-states-filter"],queryFn:async()=>{const{data:s}=await A.from("states").select("id, name, slug, abbreviation").eq("is_active",!0).order("name");return s||[]}}),{data:ie=[]}=xe({queryKey:["enrichment-treatments-filter"],queryFn:async()=>{const{data:s}=await A.from("treatments").select("id, name, slug").eq("is_active",!0).order("name");return s||[]}}),{data:D=[],refetch:de,isLoading:g}=xe({queryKey:["service-location-enrichment",O,T,v],queryFn:async()=>{let s=A.from("cities").select(`
          id, name, slug, dentist_count,
          state:states!inner(id, name, slug, abbreviation, is_active)
        `).eq("is_active",!0).eq("state.is_active",!0);O!=="all"&&(s=s.eq("state.slug",O)),v&&(s=s.ilike("name",`%${v}%`));const{data:f,error:j}=await s;if(j)throw j;let t=A.from("treatments").select("id, name, slug").eq("is_active",!0);T!=="all"&&(t=t.eq("slug",T));const{data:r}=await t,n=[];for(const x of f||[]){const d=x.state;for(const m of r||[])n.push({id:`${x.id}-${m.id}`,cityName:x.name,citySlug:x.slug,stateAbbr:d.abbreviation,stateSlug:d.slug,serviceName:m.name,serviceSlug:m.slug,hasContent:!1,slug:`/${d.slug}/${x.slug}/${m.slug}`})}const S=n.map(x=>x.slug);if(S.length>0){const d=new Set;for(let m=0;m<S.length;m+=500){const Se=S.slice(m,m+500),{data:I}=await A.from("seo_pages").select("slug, is_optimized, word_count").in("slug",Se).or("is_optimized.eq.true,word_count.gt.200");I?.forEach(Ge=>d.add(Ge.slug))}n.forEach(m=>{m.hasContent=d.has(m.slug)})}return n}}),_=D.filter(s=>!s.hasContent),ee=D.filter(s=>s.hasContent),Ae=D.length>0?Math.round(ee.length/D.length*100):0,se=async()=>{ae(!0),await de(),ae(!1),u.success("Data refreshed!")},Ie=s=>{ne(f=>{const j=new Set(f);return j.has(s)?j.delete(s):j.add(s),j})},K=()=>{const s=_.map(f=>f.id);ne(new Set(s)),u.success(`Selected all ${s.length} items needing content`)},a=()=>{ne(new Set)},o=s=>{$(f=>({...f,logs:[{...s,timestamp:new Date},...f.logs].slice(0,500)}))},k=(s,f,j)=>{if(s===0)return"Calculating...";const r=(Date.now()-j.getTime())/s,n=(f-s)*r;return n<6e4?`${Math.ceil(n/1e3)}s`:n<36e5?`${Math.ceil(n/6e4)}m`:`${(n/36e5).toFixed(1)}h`},Q=()=>{H.current=!0,$(s=>({...s,status:"stopped"})),o({item:"",action:"info",message:"Generation stopped by user"}),u.info("Generation stopped")},z=()=>{P?(F.current=!1,re(!1),$(s=>({...s,status:"running"})),o({item:"",action:"resumed",message:"Generation resumed"}),u.success("Generation resumed")):(F.current=!0,re(!0),$(s=>({...s,status:"paused"})),o({item:"",action:"paused",message:"Generation paused"}),u.info("Generation paused"))},w=()=>{B(os),u.success("Prompt reset to default")},y=async()=>{if(L.size===0){u.error("Please select at least one service-location");return}te(!0),V(!1),H.current=!1,F.current=!1,re(!1);const s=D.filter(x=>L.has(x.id)),f=5,j=[];for(let x=0;x<s.length;x+=f)j.push(s.slice(x,x+f));const t=new Date;$({status:"running",total:s.length,processed:0,errors:0,startedAt:t,logs:[],currentBatch:0,totalBatches:j.length,estimatedTimeRemaining:"Calculating..."}),o({item:"",action:"started",message:`Starting bulk generation for ${s.length} service-location pages with ${q} words...`});let r=0,n=0,S=0;try{for(let d=0;d<j.length&&!H.current;d++){for(;F.current&&!H.current;)await new Promise(m=>setTimeout(m,500));if(H.current)break;$(m=>({...m,currentBatch:d+1})),o({item:"",action:"info",message:`Processing batch ${d+1}/${j.length}...`});for(const m of j[d]){if(H.current)break;for(;F.current&&!H.current;)await new Promise(I=>setTimeout(I,500));if(H.current)break;try{const{data:I,error:Ge}=await A.functions.invoke("seo-content-optimizer",{body:{action:"generate_service_location_content",pageType:"service_location",slug:m.slug,cityName:m.cityName,stateAbbr:m.stateAbbr,stateSlug:m.stateSlug,serviceName:m.serviceName,serviceSlug:m.serviceSlug,wordCount:q,customPrompt:Y}});if(Ge)throw Ge;o({item:`${m.serviceName} in ${m.cityName}`,action:"completed",message:"Content generated successfully"}),r++,S++}catch(I){o({item:`${m.serviceName} in ${m.cityName}`,action:"error",message:`Error: ${I instanceof Error?I.message:"Unknown error"}`}),n++,r++}const Se=k(r,s.length,t);$(I=>({...I,processed:r,errors:n,estimatedTimeRemaining:Se})),await new Promise(I=>setTimeout(I,200))}}const x=H.current?"stopped":"completed";$(d=>({...d,status:x,estimatedTimeRemaining:"-"})),o({item:"",action:"completed",message:`${x==="completed"?"Complete!":"Stopped."} Generated: ${S}, Errors: ${n}`}),x==="completed"&&(u.success(`Generated content for ${S} service-location pages`),localStorage.removeItem(qe)),a(),de()}catch(x){$(d=>({...d,status:"stopped"})),o({item:"",action:"error",message:`Fatal error: ${x instanceof Error?x.message:"Unknown error"}`}),u.error("Bulk generation failed")}finally{te(!1)}},M=s=>{switch(s){case"started":return e.jsx(ve,{className:"h-3 w-3 text-primary"});case"completed":return e.jsx(Z,{className:"h-3 w-3 text-teal"});case"error":return e.jsx(ue,{className:"h-3 w-3 text-coral"});case"paused":return e.jsx(ze,{className:"h-3 w-3 text-amber-500"});case"resumed":return e.jsx(ve,{className:"h-3 w-3 text-teal"});case"info":return e.jsx(he,{className:"h-3 w-3 animate-spin text-primary"})}},U=s=>{switch(s){case"running":return"bg-primary";case"paused":return"bg-amber-500";case"completed":return"bg-teal";case"stopped":return"bg-coral";default:return"bg-muted"}};return e.jsxs("div",{className:"space-y-6",children:[(h.status==="running"||h.status==="paused")&&e.jsx(N,{className:"border-2 border-primary bg-primary/5",children:e.jsxs(b,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`h-3 w-3 rounded-full ${U(h.status)} ${h.status==="running"?"animate-pulse":""}`}),e.jsx("span",{className:"font-semibold text-lg",children:h.status==="running"?"Generating Content...":"Generation Paused"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:z,children:[P?e.jsx(ve,{className:"h-4 w-4 mr-1"}):e.jsx(ze,{className:"h-4 w-4 mr-1"}),P?"Resume":"Pause"]}),e.jsxs(c,{variant:"destructive",size:"sm",onClick:Q,children:[e.jsx(xs,{className:"h-4 w-4 mr-1"}),"Stop"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-primary",children:h.processed}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Processed"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold",children:h.total}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-teal",children:h.processed-h.errors}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Success"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-coral",children:h.errors}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Errors"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold",children:h.estimatedTimeRemaining}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"ETA"})]})]}),e.jsx(be,{value:h.processed/h.total*100,className:"h-3 mb-2"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Batch ",h.currentBatch,"/",h.totalBatches]}),e.jsxs("span",{children:[Math.round(h.processed/h.total*100),"% complete"]})]})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx(ts,{className:"h-5 w-5 text-primary"}),"Service-Location Pages Content"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Generate unique SEO content for service + city combination pages (e.g., /ca/los-angeles/teeth-cleaning)"})]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:se,disabled:X||g,children:[e.jsx(Xe,{className:`h-4 w-4 mr-2 ${X?"animate-spin":""}`}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsx(N,{children:e.jsx(b,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(rs,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:D.length.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Pages"})]})]})})}),e.jsx(N,{children:e.jsx(b,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ue,{className:"h-8 w-8 text-coral"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:_.length.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Need Content"})]})]})})}),e.jsx(N,{children:e.jsx(b,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Z,{className:"h-8 w-8 text-teal"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:ee.length.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Have Content"})]})]})})}),e.jsx(N,{children:e.jsx(b,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ts,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:ie.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Services"})]})]})})}),e.jsx(N,{children:e.jsx(b,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ps,{className:"h-8 w-8 text-amber-500"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold",children:[Ae,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Complete"})]})]})})})]}),e.jsx(fs,{open:p,onOpenChange:W,children:e.jsxs(N,{children:[e.jsxs(le,{className:"pb-3",children:[e.jsx(Ns,{asChild:!0,children:e.jsxs("div",{className:"flex items-center justify-between cursor-pointer hover:bg-muted/50 -mx-6 -my-2 px-6 py-2 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(vs,{className:"h-5 w-5 text-primary"}),e.jsx(ce,{className:"text-base",children:"SEO Content Generation Prompt"})]}),e.jsx(gs,{className:`h-5 w-5 transition-transform ${p?"rotate-180":""}`})]})}),e.jsx(Ne,{children:"Customize the AI prompt used to generate SEO content. This prompt ensures content follows Google's E-E-A-T guidelines."})]}),e.jsx(bs,{children:e.jsxs(b,{className:"space-y-4",children:[e.jsx(ds,{value:Y,onChange:s=>B(s.target.value),className:"min-h-[300px] font-mono text-sm",placeholder:"Enter your custom SEO prompt..."}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:w,children:[e.jsx(Xe,{className:"h-4 w-4 mr-2"}),"Reset to Default"]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx($e,{className:"h-4 w-4"}),Y.length," characters"]})]})]})})]})}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Oe,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Be,{placeholder:"Search cities...",value:v,onChange:s=>Ee(s.target.value),className:"pl-10"})]}),e.jsxs(De,{value:O,onValueChange:l,children:[e.jsx(Pe,{className:"w-[180px]",children:e.jsx(Re,{placeholder:"Filter by State"})}),e.jsxs(_e,{children:[e.jsx(fe,{value:"all",children:"All States"}),Te.map(s=>e.jsx(fe,{value:s.slug,children:s.name},s.id))]})]}),e.jsxs(De,{value:T,onValueChange:oe,children:[e.jsx(Pe,{className:"w-[200px]",children:e.jsx(Re,{placeholder:"Filter by Service"})}),e.jsxs(_e,{children:[e.jsx(fe,{value:"all",children:"All Services"}),ie.map(s=>e.jsx(fe,{value:s.slug,children:s.name},s.id))]})]}),e.jsxs(De,{value:q.toString(),onValueChange:s=>pe(parseInt(s)),children:[e.jsx(Pe,{className:"w-[200px]",children:e.jsx(Re,{placeholder:"Word count"})}),e.jsx(_e,{children:Es.map(s=>e.jsx(fe,{value:s.value.toString(),children:s.label},s.value))})]})]}),L.size>0&&e.jsxs("div",{className:"bg-primary/10 border border-primary/20 rounded-lg p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(G,{variant:"secondary",className:"text-lg px-4 py-2",children:[L.size.toLocaleString()," selected"]}),e.jsx(c,{variant:"ghost",size:"sm",onClick:a,children:"Clear selection"})]}),e.jsxs(c,{onClick:()=>V(!0),disabled:R,size:"lg",children:[e.jsx(ke,{className:"h-4 w-4 mr-2"}),"Generate Content for Selected"]})]}),h.logs.length>0&&e.jsxs(N,{children:[e.jsx(le,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(ce,{className:"text-base flex items-center gap-2",children:[e.jsx(js,{className:"h-4 w-4"}),"Generation Log",e.jsx(G,{variant:"outline",className:U(h.status)+" text-white",children:h.status})]}),h.status==="completed"||h.status==="stopped"?e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>{$(s=>({...s,logs:[],status:"idle"})),localStorage.removeItem(qe)},children:"Clear Log"}):null]})}),e.jsx(b,{children:e.jsx(we,{className:"h-48 border rounded p-2",children:h.logs.map((s,f)=>e.jsxs("div",{className:"flex items-start gap-2 text-xs py-1 border-b border-muted last:border-0",children:[M(s.action),e.jsx("span",{className:"text-muted-foreground whitespace-nowrap",children:s.timestamp.toLocaleTimeString()}),s.item&&e.jsxs("span",{className:"font-medium truncate max-w-[200px]",children:[s.item,":"]}),e.jsx("span",{className:s.action==="error"?"text-coral":"",children:s.message})]},f))})})]}),e.jsxs(N,{children:[e.jsx(le,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(ce,{className:"text-base",children:"Service-Location Pages Needing Content"}),e.jsxs(Ne,{children:[_.length.toLocaleString()," pages need unique SEO content"]})]}),e.jsxs(c,{variant:"default",size:"sm",onClick:K,disabled:_.length===0||R,children:[e.jsx(ns,{className:"h-4 w-4 mr-2"}),"Select All (",_.length.toLocaleString(),")"]})]})}),e.jsx(b,{children:e.jsx(we,{className:"h-[500px]",children:e.jsxs(Ve,{children:[e.jsx(Ye,{children:e.jsxs(J,{children:[e.jsx(E,{className:"w-12"}),e.jsx(E,{children:"Service"}),e.jsx(E,{children:"City"}),e.jsx(E,{children:"State"}),e.jsx(E,{children:"Status"}),e.jsx(E,{children:"Preview"})]})}),e.jsxs(Ze,{children:[g?e.jsx(J,{children:e.jsxs(C,{colSpan:6,className:"text-center py-8",children:[e.jsx(he,{className:"h-8 w-8 animate-spin mx-auto mb-2"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading service-location pages..."})]})}):_.length===0?e.jsx(J,{children:e.jsxs(C,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:[e.jsx(Z,{className:"h-8 w-8 mx-auto mb-2 text-teal"}),"All visible service-location pages have content!"]})}):_.slice(0,500).map(s=>e.jsxs(J,{children:[e.jsx(C,{children:e.jsx(Fe,{checked:L.has(s.id),onCheckedChange:()=>Ie(s.id)})}),e.jsx(C,{className:"font-medium",children:s.serviceName}),e.jsx(C,{children:s.cityName}),e.jsx(C,{children:s.stateAbbr}),e.jsx(C,{children:e.jsxs(G,{variant:"outline",className:"text-coral border-coral",children:[e.jsx(ue,{className:"h-3 w-3 mr-1"}),"No Content"]})}),e.jsx(C,{children:e.jsx(Je,{to:s.slug,target:"_blank",className:"text-primary hover:underline text-sm",children:"View Page"})})]},s.id)),_.length>500&&e.jsx(J,{children:e.jsxs(C,{colSpan:6,className:"text-center py-4 text-muted-foreground text-sm",children:["Showing 500 of ",_.length.toLocaleString(),' items. Use "Select All" to generate content for all ',_.length.toLocaleString()," pages."]})})]})]})})})]}),e.jsx(Me,{open:ye,onOpenChange:V,children:e.jsxs(Ue,{className:"max-w-lg",children:[e.jsxs(We,{children:[e.jsxs(He,{children:["Generate Content for ",L.size.toLocaleString()," Service-Location Pages"]}),e.jsxs(Ke,{children:["This will generate unique SEO content for each selected service-location page. Each page will receive ",q," words of unique content about the specific service in that city."]})]}),e.jsxs("div",{className:"py-4 space-y-4",children:[e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Selected pages:"}),e.jsx("span",{className:"font-semibold",children:L.size.toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Word count per page:"}),e.jsx("span",{className:"font-semibold",children:q})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Estimated time:"}),e.jsxs("span",{className:"font-semibold",children:["~",Math.ceil(L.size*3/60)," minutes"]})]})]}),e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-lg p-4 text-sm",children:[e.jsx("p",{className:"font-medium text-amber-600 mb-1",children:"Resilient Generation"}),e.jsx("p",{className:"text-muted-foreground",children:"You can pause, resume, or stop the process at any time. Progress is saved automatically and will resume if the page is refreshed or you lose connection."})]})]}),e.jsxs(Qe,{children:[e.jsx(c,{variant:"outline",onClick:()=>V(!1),children:"Cancel"}),e.jsxs(c,{onClick:y,children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"Start Generation"]})]})]})})]})}const As=[{value:100,label:"100 words (Brief)"},{value:150,label:"150 words (Standard)"},{value:200,label:"200 words (Detailed)"},{value:300,label:"300 words (Comprehensive)"},{value:400,label:"400 words (Extended)"},{value:500,label:"500 words (Full)"}];function nt(){const v=as(),[Ee,O]=i.useState("overview"),[l,T]=i.useState(null),[oe,L]=i.useState(!1),ne=i.useRef(!1),[q,pe]=i.useState(""),[R,te]=i.useState(null),[ye,V]=i.useState(!1),[X,ae]=i.useState(""),[Y,B]=i.useState(!1),[p,W]=i.useState(!1),[P,re]=i.useState(new Set),[F,H]=i.useState(150),[h,$]=i.useState(!1),[Te,ie]=i.useState(!1),[D,de]=i.useState(!1),{data:g,refetch:_}=xe({queryKey:["clinic-enrichment-stats"],queryFn:async()=>{const{count:t}=await A.from("clinics").select("*",{count:"exact",head:!0}).eq("is_active",!0),{count:r}=await A.from("clinics").select("*",{count:"exact",head:!0}).eq("is_active",!0).is("description",null),{count:n}=await A.from("clinics").select("*",{count:"exact",head:!0}).eq("is_active",!0).is("cover_image_url",null);return{total:t||0,noDescription:r||0,noImage:n||0,withDescription:(t||0)-(r||0),withImage:(t||0)-(n||0)}}}),{data:ee=[],refetch:Ae}=xe({queryKey:["clinics-needing-description",q],queryFn:async()=>{let t=A.from("clinics").select(`
          id, name, slug, description, address, rating, review_count, cover_image_url,
          city:cities(name, state:states(abbreviation))
        `).eq("is_active",!0).is("description",null).order("name");q&&(t=t.ilike("name",`%${q}%`));const{data:r,error:n}=await t;if(n)throw n;return r||[]}}),{data:se=[]}=xe({queryKey:["all-clinics-enrichment",q],queryFn:async()=>{const t=[];let n=0;for(;;){let S=A.from("clinics").select(`
            id, name, slug, description, address, rating, review_count, cover_image_url,
            city:cities(name, state:states(abbreviation))
          `).eq("is_active",!0).order("name").range(n,n+1e3-1);q&&(S=S.ilike("name",`%${q}%`));const{data:x,error:d}=await S;if(d)throw d;if(t.push(...x||[]),!x||x.length<1e3)break;n+=1e3}return t}}),Ie=async()=>{W(!0),await Promise.all([_(),Ae(),v.invalidateQueries({queryKey:["all-clinics-enrichment"]})]),W(!1),u.success("Data refreshed!")},K=t=>{T(r=>r?{...r,logs:[...r.logs,{...t,timestamp:new Date}]}:null)},a=()=>{ne.current=!0,u.info("Stopping enrichment... Please wait for current batch to complete.")},o=async(t=25)=>{L(!0),ne.current=!1,T({status:"running",total:t,processed:0,errors:0,logs:[]}),K({clinic:"",action:"started",message:`Starting batch description generation (${t} clinics)...`});try{const{data:r,error:n}=await A.functions.invoke("batch-enrich-clinics",{body:{action:"generate_descriptions",batchSize:t}});if(n)throw n;if(r.results)for(const S of r.results)K({clinic:S.name,action:S.success?"completed":"error",message:S.success?"Description generated successfully":`Error: ${S.error||"Unknown error"}`});T(S=>S?{...S,status:"completed",processed:r.processed||0,errors:r.errors||0}:null),K({clinic:"",action:"completed",message:`Batch complete! Generated: ${r.processed||0}, Errors: ${r.errors||0}`}),u.success(`Generated ${r.processed||0} descriptions with ${r.errors||0} errors`),_(),v.invalidateQueries({queryKey:["clinics-needing-description"]})}catch(r){console.error("Enrichment error:",r),K({clinic:"",action:"error",message:`Error: ${r instanceof Error?r.message:"Unknown error"}`}),T(n=>n?{...n,status:"stopped"}:null),u.error("Failed to generate descriptions")}finally{L(!1),ne.current=!1}},k=us({mutationFn:async({clinicId:t,description:r})=>{const{error:n}=await A.from("clinics").update({description:r,updated_at:new Date().toISOString()}).eq("id",t);if(n)throw n},onSuccess:()=>{v.invalidateQueries({queryKey:["clinics-needing-description"]}),v.invalidateQueries({queryKey:["all-clinics-enrichment"]}),v.invalidateQueries({queryKey:["clinic-enrichment-stats"]}),u.success("Description updated successfully!"),V(!1),te(null)},onError:t=>{u.error(`Failed to update: ${t.message}`)}}),Q=async()=>{if(R){B(!0);try{const{data:t,error:r}=await A.functions.invoke("batch-enrich-clinics",{body:{action:"generate_single_description",clinicId:R.id,clinicName:R.name,clinicAddress:R.address,clinicCity:R.city?.name,clinicState:R.city?.state?.abbreviation}});if(r)throw r;t.description&&(ae(t.description),u.success("AI description generated!"))}catch{u.error("Failed to generate AI description")}finally{B(!1)}}},z=async()=>{try{const{data:t}=await A.from("clinics").select("id").is("cover_image_url",null).eq("is_active",!0);if(!t||t.length===0){u.info("All clinics already have images");return}const r=["https://images.unsplash.com/photo-1629909613654-28e377c37b09?w=800","https://images.unsplash.com/photo-1606811841689-23dfddce3e95?w=800","https://images.unsplash.com/photo-1588776814546-1ffcf47267a5?w=800"];let n=0;for(const S of t){const x=r[Math.floor(Math.random()*r.length)],{error:d}=await A.from("clinics").update({cover_image_url:x}).eq("id",S.id);d||n++}u.success(`Added placeholder images to ${n} clinics`),_()}catch{u.error("Failed to add placeholder images")}},w=t=>{te(t),ae(t.description||""),V(!0)},y=()=>{R&&k.mutate({clinicId:R.id,description:X})},M=t=>{switch(t){case"started":return e.jsx(he,{className:"h-3 w-3 animate-spin text-primary"});case"completed":return e.jsx(Z,{className:"h-3 w-3 text-teal"});case"error":return e.jsx(ue,{className:"h-3 w-3 text-coral"})}},U=t=>{re(r=>{const n=new Set(r);return n.has(t)?n.delete(t):n.add(t),n})},s=t=>{re(new Set(t.map(r=>r.id)))},f=()=>{re(new Set)},j=async()=>{if(P.size===0){u.error("Please select at least one clinic");return}$(!0),ie(!1);const t=25,r=Array.from(P),n=[];for(let d=0;d<r.length;d+=t)n.push(r.slice(d,d+t));T({status:"running",total:r.length,processed:0,errors:0,logs:[]}),K({clinic:"",action:"started",message:`Starting bulk generation for ${r.length} clinics with ${F} words...`});let S=0,x=0;try{for(let d=0;d<n.length;d++){K({clinic:"",action:"started",message:`Processing batch ${d+1}/${n.length} (${Math.min((d+1)*t,r.length)}/${r.length})...`});const{data:m,error:Se}=await A.functions.invoke("batch-enrich-clinics",{body:{action:"generate_bulk_descriptions",clinicIds:n[d],wordCount:F}});if(Se)throw Se;if(m?.results)for(const I of m.results)K({clinic:I.name,action:I.success?"completed":"error",message:I.success?"Description generated successfully":`Error: ${I.error||"Unknown error"}`});S+=m?.processed||0,x+=m?.errors||0,T(I=>I?{...I,processed:S,errors:x}:null),await new Promise(I=>setTimeout(I,150))}T(d=>d?{...d,status:"completed",processed:S,errors:x}:null),K({clinic:"",action:"completed",message:`Bulk complete! Generated: ${S}, Errors: ${x}`}),u.success(`Generated ${S} descriptions with ${x} errors`),f(),_(),v.invalidateQueries({queryKey:["clinics-needing-description"]}),v.invalidateQueries({queryKey:["all-clinics-enrichment"]})}catch(d){console.error("Bulk enrichment error:",d),K({clinic:"",action:"error",message:`Error: ${d instanceof Error?d.message:"Unknown error"}`}),T(m=>m?{...m,status:"stopped"}:null),u.error("Failed to generate descriptions")}finally{$(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-r from-purple/10 via-primary/10 to-teal/10 p-6 border border-primary/20",children:[e.jsxs("div",{className:"absolute inset-0 opacity-20",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 rounded-full bg-purple blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-1/3 w-48 h-48 rounded-full bg-teal blur-3xl"})]}),e.jsxs("div",{className:"relative flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-display font-bold text-foreground flex items-center gap-3",children:[e.jsx("div",{className:"h-12 w-12 rounded-xl bg-gradient-to-br from-purple to-primary flex items-center justify-center",children:e.jsx(Ce,{className:"h-6 w-6 text-white"})}),"Clinic Content Enrichment"]}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"AI-powered description generation and content management"})]}),e.jsxs(c,{variant:"outline",onClick:Ie,disabled:p,className:"border-primary/30",children:[e.jsx(Xe,{className:`h-4 w-4 mr-2 ${p?"animate-spin":""}`}),"Refresh"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(N,{className:"bg-gradient-to-br from-primary/10 to-primary/5 border-primary/20",children:e.jsx(b,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Clinics"}),e.jsx("p",{className:"text-3xl font-bold text-primary",children:g?.total?.toLocaleString()||0})]}),e.jsx(es,{className:"h-10 w-10 text-primary/30"})]})})}),e.jsx(N,{className:"bg-gradient-to-br from-teal/10 to-teal/5 border-teal/20",children:e.jsx(b,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"With Descriptions"}),e.jsx("p",{className:"text-3xl font-bold text-teal",children:g?.withDescription?.toLocaleString()||0}),e.jsxs("p",{className:"text-xs text-coral mt-1",children:[g?.noDescription?.toLocaleString()||0," missing"]})]}),e.jsx($e,{className:"h-10 w-10 text-teal/30"})]})})}),e.jsx(N,{className:"bg-gradient-to-br from-purple/10 to-purple/5 border-purple/20",children:e.jsx(b,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"With Images"}),e.jsx("p",{className:"text-3xl font-bold text-purple",children:g?.withImage?.toLocaleString()||0}),e.jsxs("p",{className:"text-xs text-coral mt-1",children:[g?.noImage?.toLocaleString()||0," missing"]})]}),e.jsx(ge,{className:"h-10 w-10 text-purple/30"})]})})}),e.jsx(N,{className:"bg-gradient-to-br from-gold/10 to-gold/5 border-gold/20",children:e.jsxs(b,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Completion"}),e.jsxs("p",{className:"text-3xl font-bold text-gold",children:[g?.total?Math.round((g.withDescription||0)/g.total*100):0,"%"]})]}),e.jsx(Ce,{className:"h-10 w-10 text-gold/30"})]}),e.jsx(be,{value:g?.total?(g.withDescription||0)/g.total*100:0,className:"mt-3 h-2 [&>div]:bg-gold"})]})})]}),(l||h)&&l&&l.status!=="completed"&&l.status!=="stopped"&&e.jsx(N,{className:"border-2 border-primary bg-primary/5 animate-in fade-in",children:e.jsxs(b,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-primary animate-pulse"}),e.jsxs("span",{className:"font-semibold text-lg",children:["Generating Content... ",l.processed,"/",l.total]}),e.jsxs(G,{variant:"outline",className:"text-xs",children:[l.errors," errors"]})]}),oe&&e.jsxs(c,{variant:"destructive",size:"sm",onClick:a,children:[e.jsx(cs,{className:"h-4 w-4 mr-1"}),"Stop"]})]}),e.jsx(be,{value:l.total>0?l.processed/l.total*100:0,className:"mb-3 h-3"}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[e.jsxs("span",{children:[Math.round(l.total>0?l.processed/l.total*100:0),"% complete"]}),e.jsxs("span",{children:[l.total-l.processed," remaining"]})]})]})}),l&&(l.status==="completed"||l.status==="stopped")&&e.jsx(N,{className:`border-2 ${l.status==="completed"?"border-teal/50 bg-teal/5":"border-gold/50 bg-gold/5"}`,children:e.jsxs(b,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[l.status==="completed"?e.jsx(Z,{className:"h-5 w-5 text-teal"}):e.jsx(ue,{className:"h-5 w-5 text-gold"}),e.jsx("span",{className:"font-semibold",children:l.status==="completed"?"Generation Complete":"Generation Stopped"}),e.jsxs(G,{variant:"outline",children:[l.processed," processed"]}),l.errors>0&&e.jsxs(G,{variant:"destructive",children:[l.errors," errors"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>T(null),children:"Dismiss"}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>{O("overview")},children:"View Logs"})]})]}),e.jsx(be,{value:l.processed/l.total*100,className:"mt-3 h-2"})]})}),e.jsxs(ms,{value:Ee,onValueChange:O,children:[e.jsxs(hs,{className:"grid w-full grid-cols-6 h-12",children:[e.jsxs(me,{value:"overview",className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden md:inline",children:"Quick Actions"})]}),e.jsxs(me,{value:"descriptions",className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden md:inline",children:"Clinics"})," (",g?.noDescription||0,")"]}),e.jsxs(me,{value:"locations",className:"flex items-center gap-2",children:[e.jsx(rs,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden md:inline",children:"Locations"})]}),e.jsxs(me,{value:"service-locations",className:"flex items-center gap-2",children:[e.jsx(ts,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden md:inline",children:"Services"})]}),e.jsxs(me,{value:"manage",className:"flex items-center gap-2",children:[e.jsx(Le,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden md:inline",children:"Manage"})]}),e.jsxs(me,{value:"images",className:"flex items-center gap-2",children:[e.jsx(ge,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden md:inline",children:"Images"})]})]}),e.jsxs(je,{value:"overview",className:"space-y-4",children:[e.jsxs(N,{children:[e.jsxs(le,{children:[e.jsxs(ce,{className:"flex items-center gap-2",children:[e.jsx(ke,{className:"h-5 w-5 text-primary"}),"Batch Enrichment Actions"]}),e.jsx(Ne,{children:"Generate content for multiple clinics at once using AI"})]}),e.jsx(b,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"p-6 border-2 border-dashed border-primary/30 rounded-xl bg-primary/5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"h-12 w-12 rounded-xl bg-primary/20 flex items-center justify-center",children:e.jsx($e,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:"Generate Descriptions"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[g?.noDescription?.toLocaleString()||0," clinics need descriptions"]})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Use AI to generate unique, professional descriptions for clinics automatically."}),e.jsx("div",{className:"flex flex-wrap gap-2",children:oe?e.jsxs(c,{variant:"destructive",onClick:a,className:"flex-1",children:[e.jsx(cs,{className:"h-4 w-4 mr-2"}),"Stop"]}):e.jsxs(e.Fragment,{children:[e.jsxs(c,{onClick:()=>o(25),disabled:(g?.noDescription||0)===0,className:"flex-1",children:[e.jsx(ve,{className:"h-4 w-4 mr-2"}),"Generate 25"]}),e.jsx(c,{variant:"outline",onClick:()=>o(100),disabled:(g?.noDescription||0)===0,className:"flex-1",children:"Generate 100"})]})})]}),e.jsxs("div",{className:"p-6 border-2 border-dashed border-purple/30 rounded-xl bg-purple/5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"h-12 w-12 rounded-xl bg-purple/20 flex items-center justify-center",children:e.jsx(ge,{className:"h-6 w-6 text-purple"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:"Add Placeholder Images"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[g?.noImage?.toLocaleString()||0," clinics need images"]})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Add professional dental clinic placeholder images to all clinics without cover photos."}),e.jsxs(c,{onClick:z,disabled:(g?.noImage||0)===0,className:"w-full bg-purple hover:bg-purple/90",children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Add Images to All"]})]})]})})]}),l&&e.jsxs(N,{children:[e.jsxs(le,{children:[e.jsxs(ce,{className:"flex items-center gap-2",children:[l.status==="running"&&e.jsx(he,{className:"h-5 w-5 animate-spin text-primary"}),l.status==="completed"&&e.jsx(Z,{className:"h-5 w-5 text-teal"}),l.status==="stopped"&&e.jsx(ue,{className:"h-5 w-5 text-gold"}),"Enrichment Progress"]}),e.jsxs(Ne,{children:[l.processed," of ",l.total," processed (",l.errors," errors)"]})]}),e.jsxs(b,{children:[e.jsx(be,{value:l.processed/l.total*100,className:"mb-4 h-3"}),e.jsx(we,{className:"h-64 border rounded-lg p-4 bg-muted/30",children:e.jsx("div",{className:"space-y-2",children:l.logs.map((t,r)=>e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[M(t.action),e.jsx("span",{className:"text-muted-foreground font-mono text-xs",children:t.timestamp.toLocaleTimeString()}),t.clinic&&e.jsx("span",{className:"font-medium",children:t.clinic}),e.jsx("span",{className:"text-muted-foreground",children:t.message})]},r))})})]})]})]}),e.jsx(je,{value:"locations",className:"space-y-4",children:e.jsx(ks,{})}),e.jsx(je,{value:"service-locations",className:"space-y-4",children:e.jsx(Ts,{})}),e.jsxs(je,{value:"descriptions",className:"space-y-4",children:[P.size>0&&e.jsx(N,{className:"border-2 border-primary/30 bg-primary/5",children:e.jsx(b,{className:"py-4",children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(G,{className:"bg-primary text-white text-lg px-3 py-1",children:[P.size," selected"]}),e.jsx(c,{variant:"ghost",size:"sm",onClick:f,children:"Clear Selection"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(De,{value:F.toString(),onValueChange:t=>H(Number(t)),children:[e.jsx(Pe,{className:"w-[200px]",children:e.jsx(Re,{placeholder:"Word count"})}),e.jsx(_e,{children:As.map(t=>e.jsx(fe,{value:t.value.toString(),children:t.label},t.value))})]}),e.jsxs(c,{onClick:()=>ie(!0),disabled:h,className:"gap-2 bg-gradient-to-r from-primary to-teal",children:[h?e.jsx(he,{className:"h-4 w-4 animate-spin"}):e.jsx(ke,{className:"h-4 w-4"}),"Generate Descriptions"]})]})]})})}),e.jsxs(N,{children:[e.jsx(le,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(ce,{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5 text-primary"}),D?"All Clinics":"Clinics Needing Descriptions"]}),e.jsx(Ne,{children:D?`${se.length.toLocaleString()} total clinics`:`${ee.length.toLocaleString()} clinics without descriptions`})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(c,{variant:D?"default":"outline",size:"sm",onClick:()=>{de(!D),f()},className:"gap-2",children:[e.jsx(es,{className:"h-4 w-4"}),D?"Show Missing Only":"Show All Clinics"]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>s(D?se:ee),className:"gap-2",children:[e.jsx(ns,{className:"h-4 w-4"}),"Select All"]}),e.jsxs("div",{className:"relative w-64",children:[e.jsx(Oe,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Be,{placeholder:"Search clinics...",value:q,onChange:t=>pe(t.target.value),className:"pl-10"})]})]})]})}),e.jsx(b,{children:e.jsx(we,{className:"h-[500px]",children:e.jsxs(Ve,{children:[e.jsx(Ye,{children:e.jsxs(J,{className:"bg-muted/50",children:[e.jsx(E,{className:"w-12",children:e.jsx(Fe,{checked:(D?se:ee).length>0&&P.size===(D?se:ee).length,onCheckedChange:t=>{t?s(D?se:ee):f()}})}),e.jsx(E,{className:"font-bold",children:"Clinic Name"}),e.jsx(E,{className:"font-bold",children:"Location"}),e.jsx(E,{className:"font-bold",children:"Rating"}),e.jsx(E,{className:"font-bold",children:"Status"}),e.jsx(E,{className:"text-right font-bold",children:"Actions"})]})}),e.jsx(Ze,{children:(D?se:ee).map(t=>e.jsxs(J,{className:`hover:bg-muted/30 ${P.has(t.id)?"bg-primary/5":""}`,children:[e.jsx(C,{children:e.jsx(Fe,{checked:P.has(t.id),onCheckedChange:()=>U(t.id)})}),e.jsx(C,{className:"font-medium",children:t.name}),e.jsxs(C,{children:[t.city?.name,t.city?.state?.abbreviation?`, ${t.city.state.abbreviation}`:""]}),e.jsx(C,{children:t.rating?e.jsxs("span",{className:"flex items-center gap-1",children:[t.rating," ",e.jsx("span",{className:"text-gold",children:"★"})]}):e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx(C,{children:t.description?e.jsx(G,{variant:"outline",className:"text-teal border-teal/50",children:"Has Description"}):e.jsx(G,{variant:"outline",className:"text-coral border-coral/50",children:"Missing Description"})}),e.jsx(C,{className:"text-right",children:e.jsxs("div",{className:"flex gap-1 justify-end",children:[e.jsxs(c,{size:"sm",variant:"ghost",onClick:()=>w(t),children:[e.jsx(Le,{className:"h-4 w-4 mr-1"}),"Write"]}),e.jsx(c,{size:"sm",variant:"ghost",asChild:!0,children:e.jsx(Je,{to:`/clinic/${t.slug}`,target:"_blank",children:e.jsx(ws,{className:"h-4 w-4"})})})]})})]},t.id))})]})})})]})]}),e.jsx(je,{value:"manage",className:"space-y-4",children:e.jsxs(N,{children:[e.jsx(le,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(ce,{className:"flex items-center gap-2",children:[e.jsx(es,{className:"h-5 w-5 text-primary"}),"All Clinics"]}),e.jsx(Ne,{children:"Manage descriptions for all clinics"})]}),e.jsxs("div",{className:"relative w-64",children:[e.jsx(Oe,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Be,{placeholder:"Search clinics...",value:q,onChange:t=>pe(t.target.value),className:"pl-10"})]})]})}),e.jsx(b,{children:e.jsx(we,{className:"h-[500px]",children:e.jsxs(Ve,{children:[e.jsx(Ye,{children:e.jsxs(J,{className:"bg-muted/50",children:[e.jsx(E,{className:"font-bold",children:"Clinic Name"}),e.jsx(E,{className:"font-bold",children:"Location"}),e.jsx(E,{className:"font-bold",children:"Description"}),e.jsx(E,{className:"font-bold",children:"Image"}),e.jsx(E,{className:"text-right font-bold",children:"Actions"})]})}),e.jsx(Ze,{children:se.map(t=>e.jsxs(J,{className:"hover:bg-muted/30",children:[e.jsx(C,{className:"font-medium",children:t.name}),e.jsxs(C,{children:[t.city?.name,t.city?.state?.abbreviation?`, ${t.city.state.abbreviation}`:""]}),e.jsx(C,{children:t.description?e.jsxs(G,{className:"bg-teal/20 text-teal border-0",children:[e.jsx(Z,{className:"h-3 w-3 mr-1"}),"Has Description"]}):e.jsx(G,{variant:"outline",className:"text-coral border-coral/50",children:"Missing"})}),e.jsx(C,{children:t.cover_image_url?e.jsxs(G,{className:"bg-purple/20 text-purple border-0",children:[e.jsx(Z,{className:"h-3 w-3 mr-1"}),"Has Image"]}):e.jsx(G,{variant:"outline",className:"text-coral border-coral/50",children:"Missing"})}),e.jsx(C,{className:"text-right",children:e.jsxs("div",{className:"flex gap-1 justify-end",children:[e.jsx(c,{size:"sm",variant:"ghost",onClick:()=>w(t),children:e.jsx(Le,{className:"h-4 w-4"})}),e.jsx(c,{size:"sm",variant:"ghost",asChild:!0,children:e.jsx(Je,{to:`/clinic/${t.slug}`,target:"_blank",children:e.jsx(ys,{className:"h-4 w-4"})})})]})})]},t.id))})]})})})]})}),e.jsx(je,{value:"images",className:"space-y-4",children:e.jsxs(N,{children:[e.jsxs(le,{children:[e.jsxs(ce,{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"h-5 w-5 text-purple"}),"Image Management"]}),e.jsxs(Ne,{children:[g?.noImage?.toLocaleString()||0," clinics without images"]})]}),e.jsx(b,{children:e.jsxs("div",{className:"text-center py-12 bg-muted/30 rounded-xl",children:[e.jsx(ge,{className:"h-20 w-20 mx-auto text-muted-foreground/30 mb-6"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"Add Placeholder Images"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Click the button below to add professional dental clinic placeholder images to all clinics without cover photos. These are high-quality, royalty-free images."}),e.jsxs(c,{size:"lg",onClick:z,disabled:(g?.noImage||0)===0,className:"bg-purple hover:bg-purple/90",children:[e.jsx(ge,{className:"h-5 w-5 mr-2"}),"Add Placeholder Images (",g?.noImage?.toLocaleString()||0," clinics)"]})]})})]})})]}),e.jsx(Me,{open:ye,onOpenChange:V,children:e.jsxs(Ue,{className:"max-w-2xl",children:[e.jsxs(We,{children:[e.jsxs(He,{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"h-5 w-5 text-primary"}),"Edit Description"]}),e.jsxs(Ke,{children:[R?.name," • ",R?.city?.name,R?.city?.state?.abbreviation?`, ${R.city.state.abbreviation}`:""]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs(c,{variant:"outline",size:"sm",onClick:Q,disabled:Y,children:[Y?e.jsx(he,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(ke,{className:"h-4 w-4 mr-2"}),"Generate with AI"]})}),e.jsx(ds,{placeholder:"Enter clinic description...",value:X,onChange:t=>ae(t.target.value),className:"min-h-[200px]"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[X.length," characters"]})]}),e.jsxs(Qe,{children:[e.jsx(c,{variant:"outline",onClick:()=>V(!1),children:"Cancel"}),e.jsxs(c,{onClick:y,disabled:k.isPending||!X.trim(),children:[k.isPending?e.jsx(he,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Save Description"]})]})]})}),e.jsx(Me,{open:Te,onOpenChange:ie,children:e.jsxs(Ue,{children:[e.jsxs(We,{children:[e.jsxs(He,{className:"flex items-center gap-2",children:[e.jsx(ke,{className:"h-5 w-5 text-primary"}),"Generate Descriptions"]}),e.jsxs(Ke,{children:["You are about to generate AI descriptions for ",P.size," clinic(s)."]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"p-4 bg-muted rounded-lg space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:"Clinics Selected:"}),e.jsx(G,{className:"bg-primary",children:P.size})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:"Word Count Target:"}),e.jsxs(G,{variant:"outline",children:[F," words"]})]})]}),e.jsx("div",{className:"p-4 border rounded-lg",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Note:"})," This will use AI to generate unique, professional descriptions for each selected clinic. The process may take a few minutes depending on the number of clinics."]})})]}),e.jsxs(Qe,{children:[e.jsx(c,{variant:"outline",onClick:()=>ie(!1),children:"Cancel"}),e.jsxs(c,{onClick:j,className:"gap-2 bg-gradient-to-r from-primary to-teal",children:[e.jsx(Ce,{className:"h-4 w-4"}),"Start Generation"]})]})]})})]})}export{nt as default};
