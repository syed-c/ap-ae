import{u as xe,b as ge,c as Y,j as e}from"./chunk-CPh6voF3.js";import{r as y}from"./chunk-CffrGP6S.js";import{u as nt,a as rt,b as it,c as lt,g as ct}from"./chunk-Cd8N9UEo.js";import{f as Es,s as E,b as h,B as v,aF as gs,aG as js,a as f,a2 as V,a3 as K,a5 as R,a6 as H,a7 as p,I as z,al as he,L as Z,a9 as Se,bc as Fe,aa as Te,ab as qe,ac as ke,U as ms,x as ot,i as J,n as dt,w as ut,y as Le,p as ht,Q as mt}from"./index-DflORfjh.js";import{g as xt}from"./chunk-D4Vl1TkM.js";import{C as O,a as me,d as U,b as fe}from"./chunk-Dwq_v72W.js";import{S as Be}from"./chunk-DfjE-bP6.js";import{T as Qe,a as ze,b as re,c as P,d as Me,e as S}from"./chunk-NLs5Ye4A.js";import{A as Oe,h as Ue,a as Ge,b as Ve,c as Ke,d as Re,e as He,f as We,g as Je}from"./chunk--UsBvJF_.js";import{A as gt,a as jt}from"./chunk-BY_S87Nl.js";import{T as pt,a as ft,b as Ze,c as Xe}from"./chunk-k8HiDHrE.js";import{P as de}from"./chunk-HAC-i_a2.js";import{I as xs}from"./chunk-DZK1lt0q.js";import{G as yt}from"./chunk-DqEkDSiw.js";import{T as Ce}from"./chunk-BRVan1jG.js";import{L as Ds}from"./chunk-CG1o0-Xj.js";import{C as Nt}from"./chunk-C14yCe0w.js";import{F as vt}from"./chunk-BaL04tya.js";import{B as Fs}from"./chunk-B_ghW3Ra.js";import{E as Ts}from"./chunk-CcezodbN.js";import{E as qs}from"./chunk-Dfi7JVLs.js";import{W as cs}from"./chunk-Bvo6Oh0W.js";import{R as wt}from"./chunk-BOvFDp2b.js";import{T as ks}from"./chunk-DbdCK11k.js";import{L as os}from"./chunk-B0x3dbdo.js";import{E as Ls}from"./chunk-CbETxTmt.js";import{S as ds}from"./chunk-B51FxpoB.js";import"./chunk-BSjc5zjM.js";import"./chunk-B8auUmee.js";import"./chunk-DK8nT4cj.js";import"./chunk-Drd-rt-S.js";import"./chunk-BEQ5VEiB.js";import"./chunk-yff5u8mE.js";import"./chunk-xExVBHTi.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=Es("FolderTree",[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=Es("Tags",[["path",{d:"m15 5 6.3 6.3a2.4 2.4 0 0 1 0 3.4L17 19",key:"1cbfv1"}],["path",{d:"M9.586 5.586A2 2 0 0 0 8.172 5H3a1 1 0 0 0-1 1v5.172a2 2 0 0 0 .586 1.414L8.29 18.29a2.426 2.426 0 0 0 3.42 0l3.58-3.58a2.426 2.426 0 0 0 0-3.42z",key:"135mg7"}],["circle",{cx:"6.5",cy:"9.5",r:".5",fill:"currentColor",key:"5pm5xn"}]]);function Ct(a,t){if(!a||!t)return 0;const n=new Set(a.toLowerCase().split(/\s+/).filter(m=>m.length>3)),r=new Set(t.toLowerCase().split(/\s+/).filter(m=>m.length>3));if(n.size===0||r.size===0)return 0;const o=new Set([...n].filter(m=>r.has(m))),d=new Set([...n,...r]);return o.size/d.size}function bt(){return xe({queryKey:["blog-topic-clusters"],queryFn:async()=>{const{data:a,error:t}=await E.from("blog_topic_clusters").select("*").order("cluster_name");if(t)throw t;return a||[]}})}function _t(){const a=ge();return Y({mutationFn:async t=>{const{data:n,error:r}=await E.from("blog_topic_clusters").insert([t]).select().single();if(r)throw r;return n},onSuccess:()=>{a.invalidateQueries({queryKey:["blog-topic-clusters"]}),h.success("Topic cluster created")},onError:t=>h.error("Failed to create cluster: "+t.message)})}function At(){const a=ge();return Y({mutationFn:async t=>{const{error:n}=await E.from("blog_topic_clusters").delete().eq("id",t);if(n)throw n},onSuccess:()=>{a.invalidateQueries({queryKey:["blog-topic-clusters"]}),h.success("Topic cluster deleted")},onError:t=>h.error("Failed to delete cluster: "+t.message)})}function St(){return Y({mutationFn:async({title:a,content:t,excludeId:n})=>{let r=E.from("blog_posts").select("id, slug, title, content, excerpt").eq("status","published");n&&(r=r.neq("id",n));const{data:o,error:d}=await r;if(d)throw d;const m=`${a} ${t}`.toLowerCase(),_=[];for(const w of o||[]){const T=`${w.title} ${xt(w.content)} ${w.excerpt||""}`.toLowerCase(),N=Ct(m,T);N>.4&&_.push({id:w.id,slug:w.slug,title:w.title,similarity:Math.round(N*100)})}return _.sort((w,T)=>T.similarity-w.similarity),{hasSimilarPosts:_.length>0,similarPosts:_.slice(0,5),highestSimilarity:_[0]?.similarity||0}}})}function Ft(){return Y({mutationFn:async({content:a,category:t})=>{const[n,r]=await Promise.all([E.from("treatments").select("slug, name").eq("is_active",!0),E.from("cities").select("slug, name, states(slug)").eq("is_active",!0).limit(50)]),o=[],d=a.toLowerCase();for(const m of n.data||[])d.includes(m.name.toLowerCase())&&o.push({text:m.name,url:`/services/${m.slug}`,type:"treatment"});for(const m of r.data||[])if(d.includes(m.name.toLowerCase())){const _=Array.isArray(m.states)?m.states[0]:m.states;_?.slug&&o.push({text:m.name,url:`/${_.slug}/${m.slug}`,type:"city"})}return{suggestions:o.slice(0,10),count:o.length}}})}function Tt(){return Y({mutationFn:async({title:a,content:t})=>{const{data:n,error:r}=await E.from("blog_topic_clusters").select("*");if(r)throw r;if(!n?.length)return{cluster:null,confidence:0};const o=`${a} ${t}`.toLowerCase();let d=null;for(const m of n){let _=0;o.includes(m.primary_keyword.toLowerCase())&&(_+=5);for(const w of m.related_keywords||[])o.includes(w.toLowerCase())&&(_+=1);(!d||_>d.score)&&(d={cluster:m,score:_})}return d&&d.score>0?{cluster:d.cluster,confidence:Math.min(100,d.score*15)}:{cluster:null,confidence:0}}})}function qt(){return xe({queryKey:["blog-categories"],queryFn:async()=>{const{data:a,error:t}=await E.from("blog_categories").select("*").eq("is_active",!0).order("name");if(t)throw t;return a}})}function kt(){return xe({queryKey:["blog-categories-all"],queryFn:async()=>{const{data:a,error:t}=await E.from("blog_categories").select("*").order("name");if(t)throw t;return a}})}function Lt(){const a=ge();return Y({mutationFn:async t=>{const n=t.name?.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"")||"",{data:r,error:o}=await E.from("blog_categories").insert([{...t,slug:n}]).select().single();if(o)throw o;return r},onSuccess:()=>{a.invalidateQueries({queryKey:["blog-categories"]}),a.invalidateQueries({queryKey:["blog-categories-all"]}),h.success("Category created")},onError:t=>h.error("Failed: "+t.message)})}function It(){const a=ge();return Y({mutationFn:async({id:t,updates:n})=>{const{error:r}=await E.from("blog_categories").update(n).eq("id",t);if(r)throw r},onSuccess:()=>{a.invalidateQueries({queryKey:["blog-categories"]}),a.invalidateQueries({queryKey:["blog-categories-all"]}),h.success("Category updated")},onError:t=>h.error("Failed: "+t.message)})}function $t(){const a=ge();return Y({mutationFn:async t=>{const{error:n}=await E.from("blog_categories").delete().eq("id",t);if(n)throw n},onSuccess:()=>{a.invalidateQueries({queryKey:["blog-categories"]}),a.invalidateQueries({queryKey:["blog-categories-all"]}),h.success("Category deleted")},onError:t=>h.error("Failed: "+t.message)})}function Pt(){return xe({queryKey:["blog-authors"],queryFn:async()=>{const{data:a,error:t}=await E.from("blog_authors").select("*").eq("is_active",!0).order("name");if(t)throw t;return a}})}function Et(){return xe({queryKey:["blog-authors-all"],queryFn:async()=>{const{data:a,error:t}=await E.from("blog_authors").select("*").order("name");if(t)throw t;return a}})}function Dt(){const a=ge();return Y({mutationFn:async t=>{const{data:n,error:r}=await E.from("blog_authors").insert([t]).select().single();if(r)throw r;return n},onSuccess:()=>{a.invalidateQueries({queryKey:["blog-authors"]}),a.invalidateQueries({queryKey:["blog-authors-all"]}),h.success("Author created")},onError:t=>h.error("Failed: "+t.message)})}function Bt(){const a=ge();return Y({mutationFn:async({id:t,updates:n})=>{const{error:r}=await E.from("blog_authors").update(n).eq("id",t);if(r)throw r},onSuccess:()=>{a.invalidateQueries({queryKey:["blog-authors"]}),a.invalidateQueries({queryKey:["blog-authors-all"]}),h.success("Author updated")},onError:t=>h.error("Failed: "+t.message)})}function Qt(){const a=ge();return Y({mutationFn:async t=>{const{error:n}=await E.from("blog_authors").delete().eq("id",t);if(n)throw n},onSuccess:()=>{a.invalidateQueries({queryKey:["blog-authors"]}),a.invalidateQueries({queryKey:["blog-authors-all"]}),h.success("Author deleted")},onError:t=>h.error("Failed: "+t.message)})}function zt(){return Y({mutationFn:async({action:a,title:t,content:n,excerpt:r})=>{const{data:o,error:d}=await E.functions.invoke("blog-ai-assistant",{body:{action:a,title:t,content:n,excerpt:r}});if(d)throw d;return o}})}function Mt(){return Y({mutationFn:async({title:a})=>{const{data:t,error:n}=await E.functions.invoke("blog-ai-assistant",{body:{action:"generate_image",title:a}});if(n)throw n;return t}})}function Ps(a){return a.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"").substring(0,60)}function Ot(a,t,n,r={titleMin:40,titleMax:60,descMin:120,descMax:160}){const o=a?.length||0,d=t?.length||0;return{title:{isValid:o>=r.titleMin&&o<=r.titleMax,message:o<r.titleMin?`Title too short (${o}/${r.titleMin} min)`:o>r.titleMax?`Title too long (${o}/${r.titleMax} max)`:`Good length (${o} chars)`,length:o},description:{isValid:d>=r.descMin&&d<=r.descMax,message:d<r.descMin?`Description too short (${d}/${r.descMin} min)`:d>r.descMax?`Description too long (${d}/${r.descMax} max)`:`Good length (${d} chars)`,length:d},h1:{isValid:!!n&&n.length>0&&n.length<=70,message:n?n.length>70?"H1 too long":"Good H1":"H1 is required"}}}function Ut(a,t,n){const r=a.clipboardData?.getData("text/html"),o=a.clipboardData?.getData("text/plain")||"";if(!r||!r.includes("<a"))return;a.preventDefault();const d=new DOMParser().parseFromString(r,"text/html");d.querySelectorAll("a[href]").forEach(B=>{const ee=B.getAttribute("href")?.trim(),I=(B.textContent||ee||"").trim();if(ee&&I){const W=`[${I}](${ee})`;B.replaceWith(d.createTextNode(W))}});const m=d.body.textContent||o,_=a.currentTarget,w=_.selectionStart,T=_.selectionEnd,N=t.substring(0,w)+m+t.substring(T);n(N);const L=(m.match(/\[.*?\]\(.*?\)/g)||[]).length;L>0&&h.success(`Pasted content with ${L} link${L>1?"s":""} preserved`)}function we(){return Math.random().toString(36).substring(2,11)}function Gt({selectedText:a,onInsertLink:t,onClearSelection:n}){const[r,o]=y.useState(""),[d,m]=y.useState(""),[_,w]=y.useState(!1),T=L=>{L&&a&&o(a),L||(o(""),m(""),n()),w(L)},N=()=>{if(!r||!d){h.error("Please fill in both text and URL");return}t(r,d),o(""),m(""),w(!1),h.success("Link inserted")};return e.jsxs(Se,{open:_,onOpenChange:T,children:[e.jsx(Fe,{asChild:!0,children:e.jsxs(v,{type:"button",variant:a?"default":"ghost",size:"sm",className:a?"h-6 px-2 text-xs bg-primary text-primary-foreground":"h-6 px-2 text-xs",children:[e.jsx(Ds,{className:"h-3 w-3 mr-1"}),a?`Link "${a.slice(0,15)}${a.length>15?"...":""}"`:"Insert Link"]})}),e.jsxs(Te,{className:"max-w-md",children:[e.jsx(qe,{children:e.jsx(ke,{children:"Insert Link"})}),e.jsxs("div",{className:"space-y-4 pt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Link Text (Anchor Text)"}),e.jsx(z,{value:r,onChange:L=>o(L.target.value),placeholder:"e.g., Best dentist in Boston"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This text will be clickable and displayed to users"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"URL"}),e.jsx(z,{value:d,onChange:L=>m(L.target.value),placeholder:"e.g., /massachusetts/boston or https://..."}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Use relative paths like /state/city for internal links"})]}),e.jsx(v,{onClick:N,className:"w-full",children:"Insert Anchor Link"})]})]})]})}function Vt({blocks:a,onChange:t,blogTitle:n}){const[r,o]=y.useState(null),[d,m]=y.useState({}),[_,w]=y.useState({}),T=i=>{const A={id:we(),type:i,...i==="heading"&&{headingLevel:"h2",headingText:"",content:""},...i==="image"&&{imageUrl:"",imageAlt:""}};t([...a,A])},N=(i,A)=>{t(a.map(j=>j.id===i?{...j,...A}:j))},L=i=>{t(a.filter(A=>A.id!==i))},B=(i,A)=>{const j=a.findIndex(g=>g.id===i);if(j<0)return;const l=A==="up"?j-1:j+1;if(l<0||l>=a.length)return;const q=[...a];[q[j],q[l]]=[q[l],q[j]],t(q)},ee=async(i,A)=>{const j=A||n||"dental healthcare";o(i);try{const{data:l,error:q}=await E.functions.invoke("blog-ai-assistant",{body:{action:"generate_image",title:j}});if(q)throw q;l?.imageUrl?(N(i,{imageUrl:l.imageUrl}),h.success("Image generated")):h.error("Failed to generate image")}catch(l){h.error(l?.message||"Image generation failed")}finally{o(null)}},I=(i,A)=>{const j=A.selectionStart,l=A.selectionEnd,q=A.value.substring(j,l).trim();q&&j!==l?(m(g=>({...g,[i]:q})),w(g=>({...g,[i]:{start:j,end:l}}))):(m(g=>({...g,[i]:""})),w(g=>({...g,[i]:{start:0,end:0}})))},W=i=>{m(A=>({...A,[i]:""})),w(A=>({...A,[i]:{start:0,end:0}}))},ce=(i,A,j)=>{const l=a.find(Q=>Q.id===i);if(!l)return;const q=`[${A}](${j})`,g=_[i],b=l.content||"";if(g&&g.start!==g.end&&d[i]===A){const Q=b.substring(0,g.start)+q+b.substring(g.end);N(i,{content:Q})}else{const Q=b+(b?" ":"")+q;N(i,{content:Q})}W(i)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs(v,{type:"button",variant:"outline",size:"sm",onClick:()=>T("heading"),children:[e.jsx(de,{className:"h-4 w-4 mr-1"}),"Add Heading + Content"]}),e.jsxs(v,{type:"button",variant:"outline",size:"sm",onClick:()=>T("image"),children:[e.jsx(xs,{className:"h-4 w-4 mr-1"}),"Add Image"]})]}),a.length===0&&e.jsx("p",{className:"text-muted-foreground text-sm text-center py-8 border rounded-md border-dashed",children:"No content blocks yet. Click above to add headings or images."}),a.map((i,A)=>e.jsxs(O,{className:"relative group",children:[e.jsxs(me,{className:"p-3 flex flex-row items-center justify-between gap-2 bg-muted/30",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(yt,{className:"h-4 w-4 text-muted-foreground cursor-grab"}),i.type==="heading"&&`${i.headingLevel?.toUpperCase()||"H2"} Block`,i.type==="image"&&"Image Block",i.type==="dentist-list"&&`Dentist List (${i.clinicIds?.length||0} clinics)`,i.type==="faq-list"&&`FAQ Section (${i.faqs?.length||0} items)`]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(v,{type:"button",variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>B(i.id,"up"),disabled:A===0,children:e.jsx(gs,{className:"h-4 w-4"})}),e.jsx(v,{type:"button",variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>B(i.id,"down"),disabled:A===a.length-1,children:e.jsx(js,{className:"h-4 w-4"})}),e.jsx(v,{type:"button",variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive hover:text-destructive",onClick:()=>L(i.id),children:e.jsx(Ce,{className:"h-4 w-4"})})]})]}),e.jsxs(U,{className:"p-4 space-y-3",children:[i.type==="heading"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"w-28",children:[e.jsx(f,{className:"text-xs text-muted-foreground",children:"Level"}),e.jsxs(V,{value:i.headingLevel||"h2",onValueChange:j=>N(i.id,{headingLevel:j}),children:[e.jsx(K,{className:"mt-1",children:e.jsx(R,{})}),e.jsxs(H,{children:[e.jsx(p,{value:"h1",children:"H1"}),e.jsx(p,{value:"h2",children:"H2"}),e.jsx(p,{value:"h3",children:"H3"})]})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(f,{className:"text-xs text-muted-foreground",children:"Heading Text"}),e.jsx(z,{value:i.headingText||"",onChange:j=>N(i.id,{headingText:j.target.value}),placeholder:"Enter heading...",className:"mt-1"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx(f,{className:"text-xs text-muted-foreground",children:"Content / Description"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Gt,{selectedText:d[i.id]||"",onInsertLink:(j,l)=>ce(i.id,j,l),onClearSelection:()=>W(i.id)}),e.jsxs("span",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(Ds,{className:"h-3 w-3"}),"Select text + click to link"]})]})]}),e.jsx(he,{value:i.content||"",onChange:j=>N(i.id,{content:j.target.value}),onSelect:j=>I(i.id,j.currentTarget),onPaste:j=>Ut(j,i.content||"",l=>N(i.id,{content:l})),placeholder:"Write content here. Select any text and click 'Insert Link' to add an anchor link.",rows:6,className:"mt-1 font-mono text-sm"})]})]}),i.type==="image"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-3 items-end",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(f,{className:"text-xs text-muted-foreground",children:"Image URL"}),e.jsx(z,{value:i.imageUrl||"",onChange:j=>N(i.id,{imageUrl:j.target.value}),placeholder:"https://...",className:"mt-1"})]}),e.jsxs(v,{type:"button",variant:"outline",size:"sm",onClick:()=>ee(i.id,n),disabled:r===i.id,children:[r===i.id?e.jsx(Z,{className:"h-4 w-4 animate-spin mr-1"}):e.jsx(xs,{className:"h-4 w-4 mr-1"}),"Generate"]})]}),e.jsxs("div",{children:[e.jsx(f,{className:"text-xs text-muted-foreground",children:"Alt Text"}),e.jsx(z,{value:i.imageAlt||"",onChange:j=>N(i.id,{imageAlt:j.target.value}),placeholder:"Describe the image...",className:"mt-1"})]}),i.imageUrl&&e.jsx("div",{className:"mt-2 rounded-md overflow-hidden border max-w-xs",children:e.jsx("img",{src:i.imageUrl,alt:i.imageAlt||"preview",className:"w-full h-32 object-cover",onError:j=>j.target.style.display="none"})})]}),i.type==="dentist-list"&&e.jsxs("div",{className:"bg-emerald-500/10 border border-emerald-500/30 rounded-lg p-4",children:[e.jsxs("p",{className:"text-sm font-medium text-emerald-600 mb-2",children:["ðŸ“ Dentist List: ",i.locationLabel]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[i.clinicIds?.length||0," clinics will be dynamically displayed with booking buttons"]})]}),i.type==="faq-list"&&e.jsxs("div",{className:"bg-violet-500/10 border border-violet-500/30 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm font-medium text-violet-600 mb-2",children:"â“ FAQ Section"}),e.jsxs("ul",{className:"text-xs text-muted-foreground space-y-1",children:[i.faqs?.slice(0,3).map((j,l)=>e.jsxs("li",{className:"truncate",children:["â€¢ ",j.question]},l)),(i.faqs?.length||0)>3&&e.jsxs("li",{className:"text-muted-foreground/70",children:["+ ",(i.faqs?.length||0)-3," more"]})]})]})]})]},i.id))]})}function ue(a){return a.map(t=>t.type==="heading"?`${t.headingLevel==="h1"?"# ":t.headingLevel==="h3"?"### ":"## "}${t.headingText||""}

${t.content||""}`:t.type==="image"?`![${t.imageAlt||"image"}](${t.imageUrl||""})`:t.type==="dentist-list"?`<!-- DENTIST_LIST:${JSON.stringify({clinicIds:t.clinicIds,locationLabel:t.locationLabel})} -->`:t.type==="faq-list"?`<!-- FAQ_LIST:${JSON.stringify({faqs:t.faqs})} -->`:"").join(`

`)}function us(a){if(!a?.trim())return[];const t=a.split(`
`),n=[];let r=null;const o=()=>{r&&(r.type==="heading"&&(r.content=(r.content||"").trim()),n.push(r),r=null)};for(const d of t){const m=d.match(/<!-- DENTIST_LIST:(.+?) -->/),_=d.match(/<!-- FAQ_LIST:(.+?) -->/);if(m){o();try{const B=JSON.parse(m[1]);n.push({id:we(),type:"dentist-list",clinicIds:B.clinicIds,locationLabel:B.locationLabel})}catch{}continue}if(_){o();try{const B=JSON.parse(_[1]);n.push({id:we(),type:"faq-list",faqs:B.faqs})}catch{}continue}const w=d.match(/^#\s+(.*)$/),T=d.match(/^##\s+(.*)$/),N=d.match(/^###\s+(.*)$/),L=d.match(/^!\[(.*?)\]\((.*?)\)$/);w||T||N?(o(),r={id:we(),type:"heading",headingLevel:w?"h1":N?"h3":"h2",headingText:(w||T||N)[1],content:""}):L?(o(),n.push({id:we(),type:"image",imageAlt:L[1],imageUrl:L[2]})):r&&r.type==="heading"?r.content=((r.content||"")+`
`+d).trimStart():d.trim()&&(o(),r={id:we(),type:"heading",headingLevel:"h2",headingText:"",content:d})}return o(),n}function Kt({blocks:a,onInsert:t}){const[n,r]=y.useState(""),[o,d]=y.useState(""),[m,_]=y.useState("5"),[w,T]=y.useState(!1),[N,L]=y.useState("end"),{data:B}=xe({queryKey:["blog-insert-states"],queryFn:async()=>{const{data:l}=await E.from("states").select("id, name, slug, abbreviation").eq("is_active",!0).order("name");return l||[]}}),{data:ee}=xe({queryKey:["blog-insert-cities",n],enabled:!!n,queryFn:async()=>{const{data:l}=await E.from("cities").select("id, name, slug").eq("state_id",n).eq("is_active",!0).order("name");return l||[]}}),{data:I,isLoading:W}=xe({queryKey:["blog-insert-clinics",o,m],enabled:!!o,queryFn:async()=>{const{data:l}=await E.from("clinics").select("id, name, slug, address, phone, rating, review_count, cover_image_url").eq("city_id",o).eq("is_active",!0).eq("is_duplicate",!1).order("rating",{ascending:!1,nullsFirst:!1}).order("review_count",{ascending:!1,nullsFirst:!1}).limit(parseInt(m));return l||[]}});B?.find(l=>l.id===n)?.name;const ce=B?.find(l=>l.id===n)?.abbreviation||"",i=ee?.find(l=>l.id===o)?.name||"",A=a.map((l,q)=>({value:q.toString(),label:l.type==="heading"?`${l.headingLevel?.toUpperCase()}: ${l.headingText?.slice(0,40)||"Untitled"}${(l.headingText?.length||0)>40?"...":""}`:l.type==="dentist-list"?`Dentist List: ${l.locationLabel}`:l.type==="faq-list"?`FAQ Section (${l.faqs?.length||0} items)`:`Image: ${l.imageAlt?.slice(0,30)||"No alt"}`})),j=()=>{if(!I||I.length===0){h.error("No clinics to insert");return}const l=`${i}, ${ce}`,q={id:Math.random().toString(36).substring(2,11),type:"dentist-list",clinicIds:I.map(b=>b.id),locationLabel:l,headingText:`Top ${m} Dentists in ${l}`},g=N==="end"?null:N==="start"?-1:parseInt(N);t([q],g),h.success(`Inserted Top ${m} dentists from ${l}`),T(!1)};return e.jsxs(O,{className:"border-emerald-500/30 bg-gradient-to-br from-emerald-500/5 to-teal/5",children:[e.jsxs(me,{className:"p-4 pb-2",children:[e.jsxs("button",{type:"button",onClick:()=>T(!w),className:"w-full flex items-center justify-between",children:[e.jsxs(fe,{className:"text-sm flex items-center gap-2",children:[e.jsx(ms,{className:"h-4 w-4 text-emerald-500"}),"Insert Dentist List"]}),w?e.jsx(gs,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(js,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Add a curated list of top dentists with booking buttons (same UI as location pages)"})]}),w&&e.jsxs(U,{className:"p-4 pt-2 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{className:"text-xs",children:"Select State"}),e.jsxs(V,{value:n,onValueChange:l=>{r(l),d("")},children:[e.jsx(K,{className:"h-9",children:e.jsx(R,{placeholder:"Choose a state..."})}),e.jsx(H,{children:B?.map(l=>e.jsx(p,{value:l.id,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(ot,{className:"h-3 w-3"}),l.name," (",l.abbreviation,")"]})},l.id))})]})]}),n&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{className:"text-xs",children:"Select City"}),e.jsxs(V,{value:o,onValueChange:d,children:[e.jsx(K,{className:"h-9",children:e.jsx(R,{placeholder:"Choose a city..."})}),e.jsx(H,{children:ee?.map(l=>e.jsx(p,{value:l.id,children:l.name},l.id))})]})]}),o&&e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{className:"text-xs",children:"Number of Dentists"}),e.jsxs(V,{value:m,onValueChange:_,children:[e.jsx(K,{className:"h-9",children:e.jsx(R,{})}),e.jsxs(H,{children:[e.jsx(p,{value:"3",children:"Top 3"}),e.jsx(p,{value:"5",children:"Top 5"}),e.jsx(p,{value:"10",children:"Top 10"}),e.jsx(p,{value:"15",children:"Top 15"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{className:"text-xs",children:"Insert Position"}),e.jsxs(V,{value:N,onValueChange:L,children:[e.jsx(K,{className:"h-9",children:e.jsx(R,{})}),e.jsxs(H,{children:[e.jsx(p,{value:"start",children:"At Beginning"}),A.map(l=>e.jsxs(p,{value:l.value,children:["After: ",l.label]},l.value)),e.jsx(p,{value:"end",children:"At End"})]})]})]})]}),o&&I&&I.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(f,{className:"text-xs flex items-center gap-2",children:["Preview",e.jsxs(J,{variant:"secondary",className:"text-[10px]",children:[I.length," clinics"]})]}),e.jsx("div",{className:"max-h-48 overflow-y-auto rounded-lg border bg-background/50 p-2 space-y-2",children:I.map((l,q)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-md bg-muted/50 text-xs",children:[e.jsx("span",{className:"w-5 h-5 rounded-full bg-primary/20 flex items-center justify-center text-[10px] font-bold text-primary shrink-0",children:q+1}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:l.name}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[l.rating&&e.jsxs("span",{className:"flex items-center gap-0.5",children:[e.jsx(dt,{className:"h-2.5 w-2.5 fill-amber-400 text-amber-400"}),l.rating]}),l.address&&e.jsx("span",{className:"truncate",children:l.address})]})]})]},l.id))})]}),W&&e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx(Z,{className:"h-5 w-5 animate-spin text-primary"})}),o&&I&&I.length>0&&e.jsxs(v,{type:"button",onClick:j,className:"w-full",variant:"default",children:[e.jsx(ut,{className:"h-4 w-4 mr-2"}),"Insert Top ",m," Dentists ",N==="end"?"at End":N==="start"?"at Beginning":`after Block ${parseInt(N)+1}`]}),o&&!W&&I&&I.length===0&&e.jsx("p",{className:"text-xs text-center text-muted-foreground py-2",children:"No clinics found in this city. Try selecting a different location."})]})]})}function hs(a){let t=a.replace(/```json\s*/gi,"").replace(/```\s*/g,"").trim();const n=t.indexOf("["),r=t.lastIndexOf("]");if(n!==-1&&r!==-1&&r>n)t=t.slice(n,r+1);else{const o=t.indexOf("{"),d=t.lastIndexOf("}");if(o===-1||d===-1||d<=o)throw new Error("No JSON boundaries found");t=t.slice(o,d+1)}try{return JSON.parse(t)}catch{const o=t.replace(/,\s*}/g,"}").replace(/,\s*]/g,"]").replace(/[\x00-\x1F\x7F]/g,"");return JSON.parse(o)}}function Rt(a){try{return hs(a)}catch{const t=a.replace(/```json\s*/gi,"").replace(/```\s*/g,"").trim(),n=t.lastIndexOf("}");if(n===-1)throw new Error("No complete JSON object found");const r=t.indexOf("[");if(r!==-1){const m=t.slice(r,n+1)+"]";return hs(m)}const o=t.indexOf("{"),d=t.slice(o,n+1);return hs(d)}}function Ye(a){if(!a||typeof a!="object")return null;const t=typeof a.question=="string"&&a.question||typeof a.q=="string"&&a.q||typeof a.Question=="string"&&a.Question||"",n=typeof a.answer=="string"&&a.answer||typeof a.a=="string"&&a.a||typeof a.Answer=="string"&&a.Answer||"",r=t.trim(),o=n.trim();return!r||!o?null:{question:r,answer:o}}function Ht(a){const t=a;if(Array.isArray(t))return t.map(Ye).filter(Boolean);if(t?.faqs&&Array.isArray(t.faqs))return t.faqs.map(Ye).filter(Boolean);const n=typeof t?.raw=="string"?t.raw:null;if(!n)return[];const r=Rt(n);return Array.isArray(r)?r.map(Ye).filter(Boolean):r?.faqs&&Array.isArray(r.faqs)?r.faqs.map(Ye).filter(Boolean):[]}function Wt({blocks:a,onInsert:t,blogTitle:n="",blogContent:r=""}){const[o,d]=y.useState(!1),[m,_]=y.useState(!1),[w,T]=y.useState([]),[N,L]=y.useState("end"),[B,ee]=y.useState("5"),[I,W]=y.useState(""),ce=async()=>{const g=I||n;if(!g){h.error("Please enter a topic or add a blog title first");return}_(!0);try{const{data:b,error:Q}=await E.functions.invoke("blog-ai-assistant",{body:{action:"generate_faqs",title:g,content:r||g,count:parseInt(B)}});if(Q){console.error("FAQ generation error:",Q),h.error(Q.message||"Failed to generate FAQs");return}const $=Ht(b);$.length>0?(T($),h.success(`Generated ${$.length} FAQs`)):b?.error?h.error(b.error):(console.error("Unexpected FAQ response:",b),h.error("Failed to parse FAQ from a response. Please try again."))}catch(b){console.error("FAQ generation error:",b),h.error(b?.message||"Failed to generate FAQs")}finally{_(!1)}},i=(g,b,Q)=>{T($=>$.map((ye,es)=>es===g?{...ye,[b]:Q}:ye))},A=g=>{T(b=>b.filter((Q,$)=>$!==g))},j=()=>{T(g=>[...g,{question:"",answer:""}])},l=()=>{if(w.length===0){h.error("No FAQs to insert");return}const g=w.filter($=>$.question.trim()&&$.answer.trim());if(g.length===0){h.error("All FAQs are empty");return}const b={id:Math.random().toString(36).substring(2,11),type:"faq-list",faqs:g,headingText:"Frequently Asked Questions"},Q=N==="end"?null:N==="start"?-1:parseInt(N);t([b],Q),h.success(`Inserted ${g.length} FAQs`),T([]),d(!1)},q=a.map((g,b)=>({value:b.toString(),label:g.type==="heading"?`${g.headingLevel?.toUpperCase()}: ${g.headingText?.slice(0,40)||"Untitled"}${(g.headingText?.length||0)>40?"...":""}`:g.type==="dentist-list"?`Dentist List: ${g.locationLabel}`:g.type==="faq-list"?`FAQ Section (${g.faqs?.length||0} items)`:`Image: ${g.imageAlt?.slice(0,30)||"No alt"}`}));return e.jsxs(O,{className:"border-violet-500/30 bg-gradient-to-br from-violet-500/5 to-purple-500/5",children:[e.jsxs(me,{className:"p-4 pb-2",children:[e.jsxs("button",{type:"button",onClick:()=>d(!o),className:"w-full flex items-center justify-between",children:[e.jsxs(fe,{className:"text-sm flex items-center gap-2",children:[e.jsx(Nt,{className:"h-4 w-4 text-violet-500"}),"AI FAQ Generator"]}),o?e.jsx(gs,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(js,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Generate FAQs using AI (renders as dropdown accordion)"})]}),o&&e.jsxs(U,{className:"p-4 pt-2 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{className:"text-xs",children:"Topic (optional - uses blog title by default)"}),e.jsx(z,{value:I,onChange:g=>W(g.target.value),placeholder:n||"Enter topic for FAQs...",className:"h-9"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{className:"text-xs",children:"Number of FAQs"}),e.jsxs(V,{value:B,onValueChange:ee,children:[e.jsx(K,{className:"h-9",children:e.jsx(R,{})}),e.jsxs(H,{children:[e.jsx(p,{value:"3",children:"3 FAQs"}),e.jsx(p,{value:"5",children:"5 FAQs"}),e.jsx(p,{value:"7",children:"7 FAQs"}),e.jsx(p,{value:"10",children:"10 FAQs"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{className:"text-xs",children:"Insert Position"}),e.jsxs(V,{value:N,onValueChange:L,children:[e.jsx(K,{className:"h-9",children:e.jsx(R,{})}),e.jsxs(H,{children:[e.jsx(p,{value:"start",children:"At Beginning"}),q.map(g=>e.jsxs(p,{value:g.value,children:["After: ",g.label]},g.value)),e.jsx(p,{value:"end",children:"At End"})]})]})]})]}),e.jsxs(v,{type:"button",variant:"outline",onClick:ce,disabled:m||!I&&!n,className:"w-full",children:[m?e.jsx(Z,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Le,{className:"h-4 w-4 mr-2"}),m?"Generating...":"Generate FAQs with AI"]}),!I&&!n&&e.jsx("p",{className:"text-xs text-amber-600 text-center",children:"âš ï¸ Please add a blog title or enter a custom topic above"}),w.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(f,{className:"text-xs flex items-center gap-2",children:["Generated FAQs",e.jsx(J,{variant:"secondary",className:"text-[10px]",children:w.length})]}),e.jsxs(v,{type:"button",variant:"ghost",size:"sm",onClick:j,className:"h-7 text-xs",children:[e.jsx(de,{className:"h-3 w-3 mr-1"}),"Add FAQ"]})]}),e.jsx("div",{className:"max-h-80 overflow-y-auto space-y-3 pr-1",children:w.map((g,b)=>e.jsx("div",{className:"p-3 rounded-lg border bg-background/50 space-y-2",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"w-5 h-5 rounded-full bg-violet-500/20 flex items-center justify-center text-[10px] font-bold text-violet-600 shrink-0 mt-1",children:b+1}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(z,{value:g.question,onChange:Q=>i(b,"question",Q.target.value),placeholder:"Question...",className:"h-8 text-sm font-medium"}),e.jsx(he,{value:g.answer,onChange:Q=>i(b,"answer",Q.target.value),placeholder:"Answer...",rows:2,className:"text-xs"})]}),e.jsx(v,{type:"button",variant:"ghost",size:"icon",onClick:()=>A(b),className:"h-7 w-7 text-destructive hover:text-destructive shrink-0",children:e.jsx(Ce,{className:"h-3 w-3"})})]})},b))}),e.jsxs(v,{type:"button",onClick:l,className:"w-full",children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Insert ",w.length," FAQs ",N==="end"?"at End":N==="start"?"at Beginning":`after Block ${parseInt(N)+1}`]})]})]})]})}function qa(){const[a,t]=y.useState("posts"),[n,r]=y.useState({status:"",search:"",category:"",author:""}),{data:o,isLoading:d}=nt(n.status||void 0),{data:m}=bt(),{data:_}=qt(),{data:w}=kt(),{data:T}=Pt(),{data:N}=Et(),L=rt(),B=it(),ee=lt(),I=St(),W=Ft(),ce=Tt(),i=Lt(),A=It(),j=$t(),l=Dt(),q=Bt(),g=Qt(),b=_t(),Q=At(),$=zt(),ye=Mt(),[es,ss]=y.useState(!1),[je,ps]=y.useState(null),[be,ts]=y.useState(null),[_e,as]=y.useState([]),[Ie,$e]=y.useState(new Set),[Ne,Bs]=y.useState(null),[fs,ys]=y.useState(null),[Ns,vs]=y.useState(!1),[Qs,ns]=y.useState(!1),[zs,rs]=y.useState(!1),[Ms,ws]=y.useState(!1),[Pe,Cs]=y.useState(null),[Ee,bs]=y.useState(null),[Os,Us]=y.useState(null),[c,k]=y.useState({title:"",slug:"",excerpt:"",content:"",category:"",author_id:"",author_name:"",seo_title:"",seo_description:"",featured_image_url:"",status:"draft",is_featured:!1,topic_cluster_id:""}),[X,se]=y.useState([]),[ie,Gs]=y.useState(!0),[le,ve]=y.useState({name:"",description:"",color:"#6366f1",is_active:!0}),[te,pe]=y.useState({name:"",email:"",bio:"",role:"Author",is_active:!0}),[ae,Ae]=y.useState({cluster_name:"",primary_keyword:"",related_keywords:"",intent_type:"informational"});y.useEffect(()=>{c.title&&!je&&k(s=>({...s,slug:Ps(s.title)}))},[c.title,je]),y.useEffect(()=>{if(c.seo_title||c.seo_description){const s=Ot(c.seo_title,c.seo_description,c.title);Bs(s)}},[c.seo_title,c.seo_description,c.title]);const is=()=>ie&&X.length>0?ue(X):c.content,Vs=async()=>{const s=is();if(!c.title||!s){h.error("Title and content required - add some content blocks first");return}try{const u=await $.mutateAsync({action:"generate_excerpt",title:c.title,content:s});u.raw&&(k(x=>({...x,excerpt:u.raw.replace(/^["']|["']$/g,"")})),h.success("Excerpt generated"))}catch{h.error("Failed to generate excerpt")}},Ks=async()=>{const s=is();if(!c.title||!s){h.error("Title and content required - add some content blocks first");return}try{const u=await $.mutateAsync({action:"generate_seo",title:c.title,content:s});u.seo_title&&u.seo_description&&(k(x=>({...x,seo_title:u.seo_title,seo_description:u.seo_description})),h.success("SEO metadata generated"))}catch{h.error("Failed to generate SEO")}},Rs=async()=>{const s=is();if(!c.title||!s){h.error("Title and content required - add some content blocks first");return}try{const u=await $.mutateAsync({action:"detect_topic_cluster",title:c.title,content:s});ys(C=>({...C,cluster:u}));const x=await ce.mutateAsync({title:c.title,content:s});x.cluster?(k(C=>({...C,topic_cluster_id:x.cluster.id})),h.success(`Matched to cluster: ${x.cluster.cluster_name}`)):u.cluster_name&&h.info(`Suggested new cluster: ${u.cluster_name}`)}catch{h.error("Failed to detect cluster")}},_s=async()=>{const s=ie?ue(X):c.content;if(!s||s.trim().length<50){h.error("Add more content before analyzing for links");return}try{h.info("Analyzing content for internal linking opportunities...");const[u,x]=await Promise.all([W.mutateAsync({content:s,category:c.category}),$.mutateAsync({action:"suggest_internal_links",content:s})]),C=[];if(u.suggestions&&C.push(...u.suggestions.map(F=>({text:F.text,anchor_text:F.text,url:F.url,type:F.type,reason:`Found "${F.text}" mentioned in content`}))),x.links)for(const F of x.links)C.some(ne=>ne.url===F.url||ne.url===F.suggested_url)||C.push({text:F.anchor_text,anchor_text:F.anchor_text,url:F.url||F.suggested_url,type:F.type,reason:F.reason});as(C.slice(0,20)),$e(new Set),C.length>0?h.success(`Found ${C.length} internal linking opportunities`):h.info("No internal linking opportunities found. Try adding more relevant content.")}catch(u){console.error("Link suggestion error:",u),h.error("Failed to analyze content for links")}},Hs=(s,u)=>{const x=s.text||s.anchor_text,C=s.url;if(!x||!C){h.error("Invalid link data");return}const F=`[${x}](${C})`;if(ie){const G=X.map(D=>{if(D.content){const M=new RegExp(`\\b${De(x)}\\b`,"i");if(M.test(D.content))return{...D,content:D.content.replace(M,F)}}if(D.type==="heading"&&D.headingText){const M=new RegExp(`\\b${De(x)}\\b`,"i");if(M.test(D.headingText))return{...D,headingText:D.headingText.replace(M,F)}}return D});G.some((D,M)=>{const oe=X[M];return D.content!==oe?.content||D.headingText!==oe?.headingText})?(se(G),$e(D=>new Set([...D,u])),h.success(`Linked "${x}" â†’ ${C}`)):h.error(`Could not find "${x}" in content`)}else{const G=new RegExp(`\\b${De(x)}\\b`,"i");if(G.test(c.content)){const ne=c.content.replace(G,F);k(D=>({...D,content:ne})),$e(D=>new Set([...D,u])),h.success(`Linked "${x}" â†’ ${C}`)}else h.error(`Could not find "${x}" in content`)}},Ws=()=>{let s=0,u=ie?ue(X):c.content;const x=new Set(Ie);_e.forEach((C,F)=>{if(Ie.has(F))return;const G=C.text||C.anchor_text,ne=C.url;if(!G||!ne)return;const D=`[${G}](${ne})`,M=new RegExp(`\\b${De(G)}\\b`,"i");M.test(u)&&(u=u.replace(M,D),x.add(F),s++)}),s>0?(ie?se(us(u)):k(C=>({...C,content:u})),$e(x),h.success(`Inserted ${s} internal links`)):h.info("No matching text found for remaining links")},De=s=>s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),Js=async()=>{if(!c.title){h.error("Title required to generate image");return}try{h.info("Generating featured image...");const s=await ye.mutateAsync({title:c.title});s.imageUrl?(k(u=>({...u,featured_image_url:s.imageUrl})),h.success("Featured image generated")):h.error("Failed to generate image")}catch(s){h.error(s?.message?String(s.message):"Failed to generate image")}},Zs=(s,u)=>{const x=s.clipboardData?.getData("text/html");if(!x||!x.includes("<a"))return;const C=new DOMParser().parseFromString(x,"text/html");C.querySelectorAll("a[href]").forEach(M=>{const oe=M.getAttribute("href")?.trim();if(!oe)return;const ls=(M.textContent||oe).trim();M.replaceWith(C.createTextNode(`[${ls}](${oe})`))});const F=C.body.innerText||C.body.textContent||"";if(!F.trim())return;s.preventDefault();const G=s.currentTarget,ne=G.selectionStart??G.value.length,D=G.selectionEnd??ne;k(M=>{const oe=M[u]||"",ls=oe.slice(0,ne)+F+oe.slice(D);return{...M,[u]:ls}}),requestAnimationFrame(()=>{try{G.selectionStart=G.selectionEnd=ne+F.length}catch{}})},Xs=async()=>{if(c.title&&c.content){const s=await I.mutateAsync({title:c.title,content:c.content,excludeId:je?.id});ts(s.hasSimilarPosts?s:null)}},Ys=async()=>{if(!c.title||!c.slug){h.error("Title and slug are required");return}if(c.status==="published"&&be?.highestSimilarity>60){h.error("Cannot publish: too similar to existing content");return}let s=c.author_name;if(c.author_id){const C=T?.find(F=>F.id===c.author_id);C&&(s=C.name)}const u=ie?ue(X):c.content,x={...c,content:u,author_name:s,author_id:c.author_id||null,topic_cluster_id:c.topic_cluster_id||null};je?await B.mutateAsync({id:je.id,updates:x}):await L.mutateAsync(x),As(),ss(!1)},As=()=>{ps(null),ts(null),as([]),ys(null),vs(!1),se([]),k({title:"",slug:"",excerpt:"",content:"",category:"",author_id:"",author_name:"",seo_title:"",seo_description:"",featured_image_url:"",status:"draft",is_featured:!1,topic_cluster_id:""})},et=s=>{ps(s);const u=ct(s);se(us(u)),k({title:s.title,slug:s.slug,excerpt:s.excerpt||"",content:u,category:s.category||"",author_id:s.author_id||"",author_name:s.author_name||"",seo_title:s.seo_title||"",seo_description:s.seo_description||"",featured_image_url:s.featured_image_url||"",status:s.status||"draft",is_featured:s.is_featured,topic_cluster_id:s.topic_cluster_id||""}),ts(null),as([]),ss(!0)},Ss=o?.filter(s=>{const u=!n.search||s.title?.toLowerCase().includes(n.search.toLowerCase())||s.slug?.toLowerCase().includes(n.search.toLowerCase()),x=!n.category||n.category==="all"||s.category===n.category,C=!n.author||n.author==="all"||s.author_name===n.author;return u&&x&&C})||[],st=o?.filter(s=>s.status==="published").length||0,tt=o?.filter(s=>s.status==="draft").length||0,at=o?.filter(s=>s.is_featured).length||0;return d?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(Z,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-display font-bold text-foreground",children:"Blog Management"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Create, manage, and optimize blog content"})]})}),e.jsxs(pt,{value:a,onValueChange:s=>t(s),children:[e.jsxs(ft,{className:"grid grid-cols-4 w-full max-w-xl",children:[e.jsxs(Ze,{value:"posts",className:"flex items-center gap-2",children:[e.jsx(vt,{className:"h-4 w-4"}),"Posts"]}),e.jsxs(Ze,{value:"categories",className:"flex items-center gap-2",children:[e.jsx($s,{className:"h-4 w-4"}),"Categories"]}),e.jsxs(Ze,{value:"authors",className:"flex items-center gap-2",children:[e.jsx(ms,{className:"h-4 w-4"}),"Authors"]}),e.jsxs(Ze,{value:"clusters",className:"flex items-center gap-2",children:[e.jsx(Is,{className:"h-4 w-4"}),"Clusters"]})]}),e.jsxs(Xe,{value:"posts",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsx(O,{className:"card-modern",children:e.jsxs(U,{className:"p-4 flex items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-xl bg-primary/10 flex items-center justify-center",children:e.jsx(Fs,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:o?.length||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Posts"})]})]})}),e.jsx(O,{className:"card-modern",children:e.jsxs(U,{className:"p-4 flex items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-xl bg-teal/10 flex items-center justify-center",children:e.jsx(Ts,{className:"h-6 w-6 text-teal"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:st}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Published"})]})]})}),e.jsx(O,{className:"card-modern",children:e.jsxs(U,{className:"p-4 flex items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-xl bg-gold/10 flex items-center justify-center",children:e.jsx(qs,{className:"h-6 w-6 text-gold"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:tt}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Drafts"})]})]})}),e.jsx(O,{className:"card-modern",children:e.jsxs(U,{className:"p-4 flex items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-xl bg-coral/10 flex items-center justify-center",children:e.jsx(Le,{className:"h-6 w-6 text-coral"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:at}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Featured"})]})]})})]}),e.jsx(O,{className:"card-modern",children:e.jsx(U,{className:"p-4",children:e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-[200px] relative",children:[e.jsx(ht,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(z,{placeholder:"Search posts...",value:n.search,onChange:s=>r({...n,search:s.target.value}),className:"pl-10"})]}),e.jsxs(V,{value:n.status||"all",onValueChange:s=>r({...n,status:s==="all"?"":s}),children:[e.jsx(K,{className:"w-40",children:e.jsx(R,{placeholder:"All Statuses"})}),e.jsxs(H,{children:[e.jsx(p,{value:"all",children:"All Statuses"}),e.jsx(p,{value:"draft",children:"Draft"}),e.jsx(p,{value:"published",children:"Published"})]})]}),e.jsxs(V,{value:n.category||"all",onValueChange:s=>r({...n,category:s}),children:[e.jsx(K,{className:"w-48",children:e.jsx(R,{placeholder:"All Categories"})}),e.jsxs(H,{children:[e.jsx(p,{value:"all",children:"All Categories"}),_?.map(s=>e.jsx(p,{value:s.name,children:s.name},s.id))]})]}),e.jsxs(V,{value:n.author||"all",onValueChange:s=>r({...n,author:s}),children:[e.jsx(K,{className:"w-48",children:e.jsx(R,{placeholder:"All Authors"})}),e.jsxs(H,{children:[e.jsx(p,{value:"all",children:"All Authors"}),T?.map(s=>e.jsx(p,{value:s.name,children:s.name},s.id))]})]}),e.jsxs(Se,{open:es,onOpenChange:ss,children:[e.jsx(Fe,{asChild:!0,children:e.jsxs(v,{onClick:()=>As(),children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"New Post"]})}),e.jsxs(Te,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(qe,{children:e.jsxs(ke,{className:"flex items-center gap-2",children:[je?"Edit Post":"New Post",e.jsxs(v,{variant:"ghost",size:"sm",onClick:()=>vs(!Ns),className:"ml-auto",children:[e.jsx(cs,{className:"h-4 w-4 mr-1"}),"AI Tools"]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 py-4",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Title *"}),e.jsx(z,{value:c.title,onChange:s=>k({...c,title:s.target.value}),placeholder:"Enter post title"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Slug *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(z,{value:c.slug,onChange:s=>k({...c,slug:s.target.value}),placeholder:"post-slug"}),e.jsx(v,{type:"button",variant:"outline",size:"icon",onClick:()=>k({...c,slug:Ps(c.title)}),title:"Regenerate slug",children:e.jsx(wt,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Category"}),e.jsxs(V,{value:c.category||"none",onValueChange:s=>k({...c,category:s==="none"?"":s}),children:[e.jsx(K,{children:e.jsx(R,{placeholder:"Select category"})}),e.jsxs(H,{children:[e.jsx(p,{value:"none",children:"None"}),_?.map(s=>e.jsx(p,{value:s.name,children:s.name},s.id))]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Author"}),e.jsxs(V,{value:c.author_id||"none",onValueChange:s=>k({...c,author_id:s==="none"?"":s}),children:[e.jsx(K,{children:e.jsx(R,{placeholder:"Select author"})}),e.jsxs(H,{children:[e.jsx(p,{value:"none",children:"None"}),T?.map(s=>e.jsxs(p,{value:s.id,children:[s.name," (",s.role,")"]},s.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(f,{children:"Featured Image"}),e.jsxs(v,{type:"button",variant:"ghost",size:"sm",onClick:Js,disabled:ye.isPending||!c.title,title:"Generate AI image based on title",children:[ye.isPending?e.jsx(Z,{className:"h-3 w-3 animate-spin mr-1"}):e.jsx(xs,{className:"h-3 w-3 mr-1"}),"Generate"]})]}),e.jsx(z,{value:c.featured_image_url,onChange:s=>k({...c,featured_image_url:s.target.value}),placeholder:"https://... or generate with AI"}),c.featured_image_url&&e.jsx("div",{className:"mt-2 relative w-full h-24 rounded-md overflow-hidden border",children:e.jsx("img",{src:c.featured_image_url,alt:"Featured preview",className:"w-full h-full object-cover",onError:s=>{s.target.style.display="none"}})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(f,{children:"Excerpt"}),e.jsxs(v,{type:"button",variant:"ghost",size:"sm",onClick:Vs,disabled:$.isPending,children:[$.isPending?e.jsx(Z,{className:"h-3 w-3 animate-spin mr-1"}):e.jsx(Le,{className:"h-3 w-3 mr-1"}),"Generate"]})]}),e.jsx(he,{value:c.excerpt,onChange:s=>k({...c,excerpt:s.target.value}),placeholder:"Brief summary...",rows:2})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(f,{children:"Content"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{className:"text-xs text-muted-foreground",children:"Block Editor"}),e.jsx(Be,{checked:ie,onCheckedChange:s=>{s?se(us(c.content)):k(u=>({...u,content:ue(X)})),Gs(s)}})]})]}),ie?e.jsx(Vt,{blocks:X,onChange:se,blogTitle:c.title}):e.jsx(he,{value:c.content,onChange:s=>k({...c,content:s.target.value}),onPaste:s=>Zs(s,"content"),placeholder:"Write your post content here (Markdown supported)...",rows:12,className:"font-mono text-sm"})]}),be&&e.jsxs(gt,{variant:"destructive",children:[e.jsx(ks,{className:"h-4 w-4"}),e.jsxs(jt,{children:[e.jsx("strong",{children:"Similar content detected!"})," ",be.highestSimilarity,"% similar to existing posts.",be.highestSimilarity>60&&e.jsx("p",{className:"mt-1 font-medium",children:"Cannot publish until similarity is reduced."})]})]}),e.jsx(Kt,{blocks:X,onInsert:(s,u)=>{if(ie)se(u===null?x=>[...x,...s]:u===-1?x=>[...s,...x]:x=>[...x.slice(0,u+1),...s,...x.slice(u+1)]);else{const x=ue(s);k(C=>({...C,content:C.content+`

`+x}))}}}),e.jsx(Wt,{blocks:X,blogTitle:c.title,blogContent:ie?ue(X):c.content,onInsert:(s,u)=>{if(ie)se(u===null?x=>[...x,...s]:u===-1?x=>[...s,...x]:x=>[...x.slice(0,u+1),...s,...x.slice(u+1)]);else{const x=ue(s);k(C=>({...C,content:C.content+`

`+x}))}}}),e.jsxs(O,{className:"border-primary/30 bg-gradient-to-br from-primary/5 to-primary/10",children:[e.jsxs(me,{className:"p-4 pb-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(fe,{className:"text-sm flex items-center gap-2",children:[e.jsx(os,{className:"h-4 w-4 text-primary"}),"AI Internal Linking"]}),e.jsxs("div",{className:"flex gap-1",children:[_e.length>0&&Ie.size<_e.length&&e.jsxs(v,{type:"button",variant:"outline",size:"sm",onClick:Ws,title:"Insert all links into content",children:[e.jsx(de,{className:"h-3 w-3 mr-1"}),"Insert All"]}),e.jsxs(v,{type:"button",variant:"default",size:"sm",onClick:_s,disabled:W.isPending||$.isPending||!c.content&&X.length===0,children:[W.isPending||$.isPending?e.jsx(Z,{className:"h-3 w-3 animate-spin mr-1"}):e.jsx(Le,{className:"h-3 w-3 mr-1"}),"Analyze"]})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"AI scans your content and suggests links to services, locations, blogs, and clinics"})]}),e.jsx(U,{className:"p-4 pt-2",children:_e.length>0?e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:_e.map((s,u)=>{const x=Ie.has(u);return e.jsx("div",{className:`p-2 rounded-md border text-xs transition-colors ${x?"bg-teal/10 border-teal/30":"bg-background hover:border-primary/50"}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"font-medium text-foreground truncate",children:['"',s.text||s.anchor_text,'"']}),e.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline flex items-center gap-1 text-[11px]",children:[e.jsx("span",{className:"truncate",children:s.url}),e.jsx(Ls,{className:"h-2.5 w-2.5 shrink-0"})]}),s.reason&&e.jsx("p",{className:"text-muted-foreground mt-0.5 line-clamp-2",children:s.reason})]}),e.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[s.type&&e.jsx(J,{variant:"secondary",className:"text-[10px]",children:s.type}),x?e.jsx(J,{className:"bg-teal text-white text-[10px]",children:"âœ“ Inserted"}):e.jsxs(v,{type:"button",variant:"ghost",size:"sm",className:"h-6 px-2 text-[10px]",onClick:()=>Hs(s,u),title:"Insert this link into content",children:[e.jsx(de,{className:"h-3 w-3 mr-0.5"}),"Insert"]})]})]})},u)})}):e.jsxs("div",{className:"text-center py-4 text-muted-foreground text-xs",children:[e.jsx(os,{className:"h-8 w-8 mx-auto mb-2 opacity-30"}),e.jsx("p",{children:'Click "Analyze" to find internal linking opportunities'}),e.jsx("p",{className:"mt-1",children:"AI will scan your content and match it with existing pages"})]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(O,{children:[e.jsx(me,{className:"p-4 pb-2",children:e.jsx(fe,{className:"text-sm",children:"Publish"})}),e.jsxs(U,{className:"p-4 pt-0 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Status"}),e.jsxs(V,{value:c.status,onValueChange:s=>k({...c,status:s}),children:[e.jsx(K,{children:e.jsx(R,{})}),e.jsxs(H,{children:[e.jsx(p,{value:"draft",children:"Draft"}),e.jsx(p,{value:"published",children:"Published"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(f,{children:"Featured"}),e.jsx(Be,{checked:c.is_featured,onCheckedChange:s=>k({...c,is_featured:s})})]})]})]}),e.jsxs(O,{children:[e.jsx(me,{className:"p-4 pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(fe,{className:"text-sm",children:"SEO"}),e.jsx(v,{type:"button",variant:"ghost",size:"sm",onClick:Ks,disabled:$.isPending,children:$.isPending?e.jsx(Z,{className:"h-3 w-3 animate-spin"}):e.jsx(Le,{className:"h-3 w-3"})})]})}),e.jsxs(U,{className:"p-4 pt-0 space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(f,{className:"text-xs",children:"SEO Title"}),e.jsx(z,{value:c.seo_title,onChange:s=>k({...c,seo_title:s.target.value}),placeholder:"SEO title",className:"text-sm"}),Ne?.title&&e.jsx("p",{className:`text-xs ${Ne.title.isValid?"text-teal":"text-coral"}`,children:Ne.title.message})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(f,{className:"text-xs",children:"Meta Description"}),e.jsx(he,{value:c.seo_description,onChange:s=>k({...c,seo_description:s.target.value}),placeholder:"SEO description",rows:2,className:"text-sm"}),Ne?.description&&e.jsx("p",{className:`text-xs ${Ne.description.isValid?"text-teal":"text-coral"}`,children:Ne.description.message})]})]})]}),e.jsxs(O,{children:[e.jsx(me,{className:"p-4 pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(fe,{className:"text-sm",children:"Topic Cluster"}),e.jsx(v,{type:"button",variant:"ghost",size:"sm",onClick:Rs,disabled:$.isPending||ce.isPending,children:$.isPending||ce.isPending?e.jsx(Z,{className:"h-3 w-3 animate-spin"}):e.jsx(cs,{className:"h-3 w-3"})})]})}),e.jsxs(U,{className:"p-4 pt-0",children:[e.jsxs(V,{value:c.topic_cluster_id||"none",onValueChange:s=>k({...c,topic_cluster_id:s==="none"?"":s}),children:[e.jsx(K,{children:e.jsx(R,{placeholder:"Select cluster"})}),e.jsxs(H,{children:[e.jsx(p,{value:"none",children:"None"}),m?.map(s=>e.jsx(p,{value:s.id,children:s.cluster_name},s.id))]})]}),fs?.cluster&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["AI suggests: ",fs.cluster.cluster_name||"Unknown"]})]})]}),Ns&&e.jsxs(O,{className:"border-primary/30 bg-primary/5",children:[e.jsx(me,{className:"p-4 pb-2",children:e.jsxs(fe,{className:"text-sm flex items-center gap-2",children:[e.jsx(cs,{className:"h-4 w-4 text-primary"}),"AI Tools"]})}),e.jsxs(U,{className:"p-4 pt-0 space-y-2",children:[e.jsxs(v,{type:"button",variant:"outline",size:"sm",className:"w-full justify-start",onClick:Xs,disabled:I.isPending,children:[I.isPending?e.jsx(Z,{className:"h-3 w-3 animate-spin mr-2"}):e.jsx(ks,{className:"h-3 w-3 mr-2"}),"Check Similarity"]}),e.jsxs(v,{type:"button",variant:"outline",size:"sm",className:"w-full justify-start",onClick:_s,disabled:W.isPending||$.isPending,children:[W.isPending||$.isPending?e.jsx(Z,{className:"h-3 w-3 animate-spin mr-2"}):e.jsx(os,{className:"h-3 w-3 mr-2"}),"Suggest Links"]})]})]}),e.jsxs(v,{onClick:Ys,className:"w-full",disabled:L.isPending||B.isPending||c.status==="published"&&be?.highestSimilarity>60,children:[(L.isPending||B.isPending)&&e.jsx(Z,{className:"h-4 w-4 animate-spin mr-2"}),je?"Update":"Create"," Post"]})]})]})]})]})]})})}),e.jsx(O,{className:"card-modern",children:e.jsx(U,{className:"p-0",children:e.jsxs(Qe,{children:[e.jsx(ze,{children:e.jsxs(re,{children:[e.jsx(P,{children:"Title"}),e.jsx(P,{children:"Category"}),e.jsx(P,{children:"Author"}),e.jsx(P,{children:"Cluster"}),e.jsx(P,{children:"Status"}),e.jsx(P,{children:"Created"}),e.jsx(P,{className:"text-right",children:"Actions"})]})}),e.jsxs(Me,{children:[Ss.map(s=>e.jsxs(re,{children:[e.jsxs(S,{children:[e.jsx("div",{className:"font-medium",children:s.title}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["/blog/",s.slug]})]}),e.jsx(S,{children:e.jsx(J,{variant:"outline",children:s.category||"-"})}),e.jsx(S,{className:"text-muted-foreground",children:s.author_name||"-"}),e.jsx(S,{className:"text-muted-foreground text-xs",children:m?.find(u=>u.id===s.topic_cluster_id)?.cluster_name||"-"}),e.jsxs(S,{children:[s.status==="published"?e.jsxs(J,{className:"bg-teal text-white",children:[e.jsx(Ts,{className:"h-3 w-3 mr-1"}),"Published"]}):e.jsxs(J,{variant:"secondary",children:[e.jsx(qs,{className:"h-3 w-3 mr-1"}),"Draft"]}),s.is_featured&&e.jsx(J,{className:"ml-1 bg-gold text-white",children:"Featured"})]}),e.jsx(S,{className:"text-muted-foreground",children:s.created_at?mt(new Date(s.created_at),"MMM d, yyyy"):"-"}),e.jsxs(S,{className:"text-right",children:[s.status==="published"&&e.jsx(v,{variant:"ghost",size:"sm",asChild:!0,children:e.jsx("a",{href:`/blog/${s.slug}`,target:"_blank",rel:"noopener noreferrer",children:e.jsx(Ls,{className:"h-4 w-4"})})}),e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>et(s),children:e.jsx(ds,{className:"h-4 w-4"})}),e.jsxs(Oe,{children:[e.jsx(Ue,{asChild:!0,children:e.jsx(v,{variant:"ghost",size:"sm",className:"text-destructive",children:e.jsx(Ce,{className:"h-4 w-4"})})}),e.jsxs(Ge,{children:[e.jsxs(Ve,{children:[e.jsx(Ke,{children:"Delete Post?"}),e.jsxs(Re,{children:['This will permanently delete "',s.title,'".']})]}),e.jsxs(He,{children:[e.jsx(We,{children:"Cancel"}),e.jsx(Je,{onClick:()=>ee.mutate(s.id),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})]})]})]},s.id)),Ss.length===0&&e.jsx(re,{children:e.jsxs(S,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:[e.jsx(Fs,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No posts found"})]})})]})]})})})]}),e.jsxs(Xe,{value:"categories",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Categories"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage blog categories"})]}),e.jsxs(Se,{open:Qs,onOpenChange:ns,children:[e.jsx(Fe,{asChild:!0,children:e.jsxs(v,{onClick:()=>{Cs(null),ve({name:"",description:"",color:"#6366f1",is_active:!0})},children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Add Category"]})}),e.jsxs(Te,{children:[e.jsx(qe,{children:e.jsx(ke,{children:Pe?"Edit Category":"New Category"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Name"}),e.jsx(z,{value:le.name,onChange:s=>ve({...le,name:s.target.value}),placeholder:"Category name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Description"}),e.jsx(he,{value:le.description,onChange:s=>ve({...le,description:s.target.value}),placeholder:"Description",rows:2})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Color"}),e.jsx(z,{type:"color",value:le.color,onChange:s=>ve({...le,color:s.target.value})})]}),e.jsxs("div",{className:"flex items-center justify-between pt-6",children:[e.jsx(f,{children:"Active"}),e.jsx(Be,{checked:le.is_active,onCheckedChange:s=>ve({...le,is_active:s})})]})]}),e.jsxs(v,{onClick:async()=>{Pe?await A.mutateAsync({id:Pe.id,updates:le}):await i.mutateAsync(le),ns(!1)},className:"w-full",disabled:i.isPending||A.isPending,children:[(i.isPending||A.isPending)&&e.jsx(Z,{className:"h-4 w-4 animate-spin mr-2"}),Pe?"Update":"Create"]})]})]})]})]}),e.jsx(O,{children:e.jsx(U,{className:"p-0",children:e.jsxs(Qe,{children:[e.jsx(ze,{children:e.jsxs(re,{children:[e.jsx(P,{children:"Name"}),e.jsx(P,{children:"Slug"}),e.jsx(P,{children:"Description"}),e.jsx(P,{children:"Posts"}),e.jsx(P,{children:"Status"}),e.jsx(P,{className:"text-right",children:"Actions"})]})}),e.jsxs(Me,{children:[w?.map(s=>e.jsxs(re,{children:[e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:s.color}}),e.jsx("span",{className:"font-medium",children:s.name})]})}),e.jsx(S,{className:"text-muted-foreground",children:s.slug}),e.jsx(S,{className:"text-muted-foreground text-sm max-w-[200px] truncate",children:s.description||"-"}),e.jsx(S,{children:s.post_count}),e.jsx(S,{children:e.jsx(J,{variant:s.is_active?"default":"secondary",children:s.is_active?"Active":"Inactive"})}),e.jsxs(S,{className:"text-right",children:[e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>{Cs(s),ve({name:s.name,description:s.description||"",color:s.color,is_active:s.is_active}),ns(!0)},children:e.jsx(ds,{className:"h-4 w-4"})}),e.jsxs(Oe,{children:[e.jsx(Ue,{asChild:!0,children:e.jsx(v,{variant:"ghost",size:"sm",className:"text-destructive",children:e.jsx(Ce,{className:"h-4 w-4"})})}),e.jsxs(Ge,{children:[e.jsxs(Ve,{children:[e.jsx(Ke,{children:"Delete Category?"}),e.jsxs(Re,{children:['This will delete "',s.name,'".']})]}),e.jsxs(He,{children:[e.jsx(We,{children:"Cancel"}),e.jsx(Je,{onClick:()=>j.mutate(s.id),className:"bg-destructive text-destructive-foreground",children:"Delete"})]})]})]})]})]},s.id)),(!w||w.length===0)&&e.jsx(re,{children:e.jsxs(S,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:[e.jsx($s,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No categories found"})]})})]})]})})})]}),e.jsxs(Xe,{value:"authors",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Authors"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage blog authors"})]}),e.jsxs(Se,{open:zs,onOpenChange:rs,children:[e.jsx(Fe,{asChild:!0,children:e.jsxs(v,{onClick:()=>{bs(null),pe({name:"",email:"",bio:"",role:"Author",is_active:!0})},children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Add Author"]})}),e.jsxs(Te,{children:[e.jsx(qe,{children:e.jsx(ke,{children:Ee?"Edit Author":"New Author"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Name"}),e.jsx(z,{value:te.name,onChange:s=>pe({...te,name:s.target.value}),placeholder:"Author name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Email"}),e.jsx(z,{type:"email",value:te.email,onChange:s=>pe({...te,email:s.target.value}),placeholder:"author@example.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Role"}),e.jsxs(V,{value:te.role,onValueChange:s=>pe({...te,role:s}),children:[e.jsx(K,{children:e.jsx(R,{})}),e.jsxs(H,{children:[e.jsx(p,{value:"Author",children:"Author"}),e.jsx(p,{value:"Editor",children:"Editor"}),e.jsx(p,{value:"Admin",children:"Admin"}),e.jsx(p,{value:"Guest",children:"Guest Writer"}),e.jsx(p,{value:"Expert",children:"Dental Expert"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Bio"}),e.jsx(he,{value:te.bio,onChange:s=>pe({...te,bio:s.target.value}),placeholder:"Short bio...",rows:3})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(f,{children:"Active"}),e.jsx(Be,{checked:te.is_active,onCheckedChange:s=>pe({...te,is_active:s})})]}),e.jsxs(v,{onClick:async()=>{Ee?await q.mutateAsync({id:Ee.id,updates:te}):await l.mutateAsync(te),rs(!1)},className:"w-full",disabled:l.isPending||q.isPending,children:[(l.isPending||q.isPending)&&e.jsx(Z,{className:"h-4 w-4 animate-spin mr-2"}),Ee?"Update":"Create"]})]})]})]})]}),e.jsx(O,{children:e.jsx(U,{className:"p-0",children:e.jsxs(Qe,{children:[e.jsx(ze,{children:e.jsxs(re,{children:[e.jsx(P,{children:"Name"}),e.jsx(P,{children:"Email"}),e.jsx(P,{children:"Role"}),e.jsx(P,{children:"Posts"}),e.jsx(P,{children:"Status"}),e.jsx(P,{className:"text-right",children:"Actions"})]})}),e.jsxs(Me,{children:[N?.map(s=>e.jsxs(re,{children:[e.jsx(S,{className:"font-medium",children:s.name}),e.jsx(S,{className:"text-muted-foreground",children:s.email||"-"}),e.jsx(S,{children:e.jsx(J,{variant:"outline",children:s.role})}),e.jsx(S,{children:s.post_count}),e.jsx(S,{children:e.jsx(J,{variant:s.is_active?"default":"secondary",children:s.is_active?"Active":"Inactive"})}),e.jsxs(S,{className:"text-right",children:[e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>{bs(s),pe({name:s.name,email:s.email||"",bio:s.bio||"",role:s.role,is_active:s.is_active}),rs(!0)},children:e.jsx(ds,{className:"h-4 w-4"})}),e.jsxs(Oe,{children:[e.jsx(Ue,{asChild:!0,children:e.jsx(v,{variant:"ghost",size:"sm",className:"text-destructive",children:e.jsx(Ce,{className:"h-4 w-4"})})}),e.jsxs(Ge,{children:[e.jsxs(Ve,{children:[e.jsx(Ke,{children:"Delete Author?"}),e.jsxs(Re,{children:['This will delete "',s.name,'".']})]}),e.jsxs(He,{children:[e.jsx(We,{children:"Cancel"}),e.jsx(Je,{onClick:()=>g.mutate(s.id),className:"bg-destructive text-destructive-foreground",children:"Delete"})]})]})]})]})]},s.id)),(!N||N.length===0)&&e.jsx(re,{children:e.jsxs(S,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:[e.jsx(ms,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No authors found"})]})})]})]})})})]}),e.jsxs(Xe,{value:"clusters",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Topic Clusters"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Organize content into SEO topic clusters"})]}),e.jsxs(Se,{open:Ms,onOpenChange:ws,children:[e.jsx(Fe,{asChild:!0,children:e.jsxs(v,{onClick:()=>{Us(null),Ae({cluster_name:"",primary_keyword:"",related_keywords:"",intent_type:"informational"})},children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Add Cluster"]})}),e.jsxs(Te,{children:[e.jsx(qe,{children:e.jsx(ke,{children:Os?"Edit Cluster":"New Topic Cluster"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Cluster Name"}),e.jsx(z,{value:ae.cluster_name,onChange:s=>Ae({...ae,cluster_name:s.target.value}),placeholder:"e.g., Dental Implants"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Primary Keyword"}),e.jsx(z,{value:ae.primary_keyword,onChange:s=>Ae({...ae,primary_keyword:s.target.value}),placeholder:"e.g., dental implants"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Related Keywords (comma-separated)"}),e.jsx(he,{value:ae.related_keywords,onChange:s=>Ae({...ae,related_keywords:s.target.value}),placeholder:"implant cost, implant procedure, implant recovery",rows:2})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Intent Type"}),e.jsxs(V,{value:ae.intent_type,onValueChange:s=>Ae({...ae,intent_type:s}),children:[e.jsx(K,{children:e.jsx(R,{})}),e.jsxs(H,{children:[e.jsx(p,{value:"informational",children:"Informational"}),e.jsx(p,{value:"transactional",children:"Transactional"}),e.jsx(p,{value:"navigational",children:"Navigational"}),e.jsx(p,{value:"commercial",children:"Commercial"})]})]})]}),e.jsxs(v,{onClick:async()=>{const s={cluster_name:ae.cluster_name,primary_keyword:ae.primary_keyword,related_keywords:ae.related_keywords.split(",").map(u=>u.trim()).filter(Boolean),intent_type:ae.intent_type};await b.mutateAsync(s),ws(!1)},className:"w-full",disabled:b.isPending,children:[b.isPending&&e.jsx(Z,{className:"h-4 w-4 animate-spin mr-2"}),"Create Cluster"]})]})]})]})]}),e.jsx(O,{children:e.jsx(U,{className:"p-0",children:e.jsxs(Qe,{children:[e.jsx(ze,{children:e.jsxs(re,{children:[e.jsx(P,{children:"Cluster Name"}),e.jsx(P,{children:"Primary Keyword"}),e.jsx(P,{children:"Related Keywords"}),e.jsx(P,{children:"Intent"}),e.jsx(P,{className:"text-right",children:"Actions"})]})}),e.jsxs(Me,{children:[m?.map(s=>e.jsxs(re,{children:[e.jsx(S,{className:"font-medium",children:s.cluster_name}),e.jsx(S,{children:e.jsx(J,{variant:"outline",children:s.primary_keyword})}),e.jsx(S,{className:"max-w-[200px]",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.related_keywords?.slice(0,3).map((u,x)=>e.jsx(J,{variant:"secondary",className:"text-xs",children:u},x)),(s.related_keywords?.length||0)>3&&e.jsxs(J,{variant:"secondary",className:"text-xs",children:["+",(s.related_keywords?.length||0)-3]})]})}),e.jsx(S,{children:e.jsx(J,{children:s.intent_type||"informational"})}),e.jsx(S,{className:"text-right",children:e.jsxs(Oe,{children:[e.jsx(Ue,{asChild:!0,children:e.jsx(v,{variant:"ghost",size:"sm",className:"text-destructive",children:e.jsx(Ce,{className:"h-4 w-4"})})}),e.jsxs(Ge,{children:[e.jsxs(Ve,{children:[e.jsx(Ke,{children:"Delete Cluster?"}),e.jsxs(Re,{children:['This will delete "',s.cluster_name,'".']})]}),e.jsxs(He,{children:[e.jsx(We,{children:"Cancel"}),e.jsx(Je,{onClick:()=>Q.mutate(s.id),className:"bg-destructive text-destructive-foreground",children:"Delete"})]})]})]})})]},s.id)),(!m||m.length===0)&&e.jsx(re,{children:e.jsxs(S,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:[e.jsx(Is,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No topic clusters found"})]})})]})]})})})]})]})]})}export{qa as default};
