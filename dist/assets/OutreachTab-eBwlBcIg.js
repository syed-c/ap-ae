import{b as $e,u as ge,c as N,j as e}from"./chunk-CPh6voF3.js";import{r as c}from"./chunk-CffrGP6S.js";import{A as M,bA as Ue,$ as q,a9 as X,bc as fe,B as i,aa as Z,ab as ee,ac as se,a as t,I as x,a2 as L,a3 as O,a5 as I,a6 as H,a7 as w,al as je,y as ae,i as te,L as be,U as Ve,b as d,s as p}from"./index-DflORfjh.js";import{C as h,d as u,a as R,b as Y,c as le}from"./chunk-Dwq_v72W.js";import{S as ve}from"./chunk-DfjE-bP6.js";import{T as ye,a as Ne,b as k,c as m,d as we,e as o}from"./chunk-NLs5Ye4A.js";import{T as Qe,a as Be,b as $,c as U}from"./chunk-k8HiDHrE.js";import{A as Ke,b as Je,a as We}from"./chunk-BY_S87Nl.js";import{E as _e}from"./chunk-CcezodbN.js";import{T as Ce}from"./chunk-9wfNkVpc.js";import{P as Te}from"./chunk-HAC-i_a2.js";import{S as ke}from"./chunk-C8UDNHIm.js";import{M as Se}from"./chunk-_WnrCass.js";import{S as Ge}from"./chunk-B51FxpoB.js";import{F as Xe}from"./chunk-BaL04tya.js";import{C as Ze}from"./chunk-GLPyMM0F.js";import{C as es}from"./chunk-wy0nNZZG.js";import"./chunk-B8auUmee.js";import"./chunk-DK8nT4cj.js";import"./chunk-Drd-rt-S.js";import"./chunk-BEQ5VEiB.js";import"./chunk-yff5u8mE.js";import"./chunk-xExVBHTi.js";const ss=(_,S="{{clinic_name}}")=>{const E={welcome:`
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body style="margin:0;padding:0;background-color:#f8fafc;font-family:'Segoe UI',Roboto,sans-serif;">
  <table width="100%" cellpadding="0" cellspacing="0" style="background-color:#f8fafc;padding:40px 20px;">
    <tr>
      <td align="center">
        <table width="600" cellpadding="0" cellspacing="0" style="background-color:#ffffff;border-radius:16px;overflow:hidden;box-shadow:0 4px 6px rgba(0,0,0,0.05);">
          <!-- Header -->
          <tr>
            <td style="background:linear-gradient(135deg,#0d9488 0%,#14b8a6 100%);padding:40px 40px 30px;text-align:center;">
              <h1 style="margin:0;color:#ffffff;font-size:28px;font-weight:700;">Welcome to AppointPanda</h1>
              <p style="margin:10px 0 0;color:rgba(255,255,255,0.9);font-size:16px;">Your clinic listing is now live!</p>
            </td>
          </tr>
          <!-- Content -->
          <tr>
            <td style="padding:40px;">
              <p style="margin:0 0 20px;font-size:16px;color:#334155;line-height:1.6;">Hi ${S} Team,</p>
              <p style="margin:0 0 20px;font-size:16px;color:#334155;line-height:1.6;">Congratulations! Your dental practice is now visible to thousands of patients searching for quality dental care in your area.</p>
              <div style="background-color:#f0fdfa;border-left:4px solid #0d9488;padding:20px;margin:24px 0;border-radius:0 8px 8px 0;">
                <p style="margin:0;font-size:14px;color:#0d9488;font-weight:600;">üéâ Your listing is live and ready to attract new patients!</p>
              </div>
              <p style="margin:0 0 30px;font-size:16px;color:#334155;line-height:1.6;">To maximize your visibility and start receiving bookings, we recommend claiming your profile to unlock premium features.</p>
              <a href="{{claim_link}}" style="display:inline-block;background:linear-gradient(135deg,#0d9488 0%,#14b8a6 100%);color:#ffffff;text-decoration:none;padding:16px 32px;border-radius:8px;font-weight:600;font-size:16px;">Claim Your Profile ‚Üí</a>
            </td>
          </tr>
          <!-- Footer -->
          <tr>
            <td style="background-color:#f8fafc;padding:30px 40px;border-top:1px solid #e2e8f0;">
              <p style="margin:0;font-size:12px;color:#64748b;text-align:center;">¬© 2026 AppointPanda. All rights reserved.</p>
              <p style="margin:10px 0 0;font-size:12px;color:#64748b;text-align:center;"><a href="{{unsubscribe_link}}" style="color:#0d9488;">Unsubscribe</a></p>
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</body>
</html>`,claim_reminder:`
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body style="margin:0;padding:0;background-color:#f8fafc;font-family:'Segoe UI',Roboto,sans-serif;">
  <table width="100%" cellpadding="0" cellspacing="0" style="background-color:#f8fafc;padding:40px 20px;">
    <tr>
      <td align="center">
        <table width="600" cellpadding="0" cellspacing="0" style="background-color:#ffffff;border-radius:16px;overflow:hidden;box-shadow:0 4px 6px rgba(0,0,0,0.05);">
          <tr>
            <td style="background:linear-gradient(135deg,#f59e0b 0%,#fbbf24 100%);padding:40px 40px 30px;text-align:center;">
              <h1 style="margin:0;color:#ffffff;font-size:28px;font-weight:700;">Don't Miss Out!</h1>
              <p style="margin:10px 0 0;color:rgba(255,255,255,0.9);font-size:16px;">Claim your profile to unlock premium features</p>
            </td>
          </tr>
          <tr>
            <td style="padding:40px;">
              <p style="margin:0 0 20px;font-size:16px;color:#334155;line-height:1.6;">Hi ${S} Team,</p>
              <p style="margin:0 0 20px;font-size:16px;color:#334155;line-height:1.6;">Your clinic profile on AppointPanda is getting noticed! To take full control and access all features, claim your profile now.</p>
              <div style="background-color:#fffbeb;border-left:4px solid #f59e0b;padding:20px;margin:24px 0;border-radius:0 8px 8px 0;">
                <p style="margin:0;font-size:14px;color:#92400e;font-weight:600;">‚è∞ Limited time: Get 30% off your first month when you claim today!</p>
              </div>
              <a href="{{claim_link}}" style="display:inline-block;background:linear-gradient(135deg,#f59e0b 0%,#fbbf24 100%);color:#ffffff;text-decoration:none;padding:16px 32px;border-radius:8px;font-weight:600;font-size:16px;">Claim Your Profile ‚Üí</a>
            </td>
          </tr>
          <tr>
            <td style="background-color:#f8fafc;padding:30px 40px;border-top:1px solid #e2e8f0;">
              <p style="margin:0;font-size:12px;color:#64748b;text-align:center;">¬© 2026 AppointPanda. All rights reserved.</p>
              <p style="margin:10px 0 0;font-size:12px;color:#64748b;text-align:center;"><a href="{{unsubscribe_link}}" style="color:#0d9488;">Unsubscribe</a></p>
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</body>
</html>`,review_request:`
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body style="margin:0;padding:0;background-color:#f8fafc;font-family:'Segoe UI',Roboto,sans-serif;">
  <table width="100%" cellpadding="0" cellspacing="0" style="background-color:#f8fafc;padding:40px 20px;">
    <tr>
      <td align="center">
        <table width="600" cellpadding="0" cellspacing="0" style="background-color:#ffffff;border-radius:16px;overflow:hidden;box-shadow:0 4px 6px rgba(0,0,0,0.05);">
          <tr>
            <td style="background:linear-gradient(135deg,#6366f1 0%,#8b5cf6 100%);padding:40px 40px 30px;text-align:center;">
              <h1 style="margin:0;color:#ffffff;font-size:28px;font-weight:700;">How Was Your Visit?</h1>
              <p style="margin:10px 0 0;color:rgba(255,255,255,0.9);font-size:16px;">Your feedback helps us improve</p>
            </td>
          </tr>
          <tr>
            <td style="padding:40px;text-align:center;">
              <p style="margin:0 0 20px;font-size:16px;color:#334155;line-height:1.6;">Hi {{patient_name}},</p>
              <p style="margin:0 0 30px;font-size:16px;color:#334155;line-height:1.6;">Thank you for visiting ${S}! We'd love to hear about your experience.</p>
              <div style="margin:30px 0;">
                <a href="{{review_link}}" style="display:inline-block;background:linear-gradient(135deg,#6366f1 0%,#8b5cf6 100%);color:#ffffff;text-decoration:none;padding:18px 40px;border-radius:8px;font-weight:600;font-size:16px;">Leave a Review ‚≠ê</a>
              </div>
              <p style="margin:30px 0 0;font-size:14px;color:#64748b;">It only takes 30 seconds and helps other patients find great care!</p>
            </td>
          </tr>
          <tr>
            <td style="background-color:#f8fafc;padding:30px 40px;border-top:1px solid #e2e8f0;">
              <p style="margin:0;font-size:12px;color:#64748b;text-align:center;">¬© 2026 AppointPanda. All rights reserved.</p>
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</body>
</html>`};return E[_]||E.welcome};function ks(){const _=$e(),[S,E]=c.useState("campaigns"),[Pe,z]=c.useState(!1),[Ee,ie]=c.useState(!1),[ze,ne]=c.useState(!1),[D,De]=c.useState(null),[C,A]=c.useState("desktop"),[F,V]=c.useState(null),[Q,Ae]=c.useState(null),[B,re]=c.useState(""),[P,ce]=c.useState(""),[b,de]=c.useState({claim_status:"unclaimed",limit:5}),[n,g]=c.useState({name:"",slug:"",subject:"",html_content:"",plain_content:"",category:"outreach",is_active:!0}),[r,v]=c.useState({name:"",description:"",template_id:"",target_filter:'{"source": "gmb", "claim_status": "unclaimed"}',schedule_config:'{"frequency": "daily"}',max_sends_per_day:50,max_sends_per_clinic:3,is_active:!1}),{data:f,isLoading:as}=ge({queryKey:["email-templates"],queryFn:async()=>{const{data:s,error:a}=await p.from("email_templates").select("*").order("created_at",{ascending:!1});if(a)throw a;return s}}),{data:T,isLoading:ts}=ge({queryKey:["outreach-campaigns"],queryFn:async()=>{const{data:s,error:a}=await p.from("outreach_campaigns").select("*").order("created_at",{ascending:!1});if(a)throw a;return s}}),oe=N({mutationFn:async s=>{const{error:a}=await p.from("email_templates").insert([s]);if(a)throw a},onSuccess:()=>{_.invalidateQueries({queryKey:["email-templates"]}),z(!1),W(),d.success("Template created")},onError:s=>d.error(s.message)}),me=N({mutationFn:async({id:s,data:a})=>{const{error:l}=await p.from("email_templates").update(a).eq("id",s);if(l)throw l},onSuccess:()=>{_.invalidateQueries({queryKey:["email-templates"]}),z(!1),V(null),W(),d.success("Template updated")}}),xe=N({mutationFn:async s=>{const{error:a}=await p.from("outreach_campaigns").insert([{...s,target_filter:JSON.parse(s.target_filter),schedule_config:JSON.parse(s.schedule_config)}]);if(a)throw a},onSuccess:()=>{_.invalidateQueries({queryKey:["outreach-campaigns"]}),ie(!1),pe(),d.success("Campaign created")},onError:s=>d.error(s.message)}),Fe=N({mutationFn:async({id:s,active:a})=>{const{error:l}=await p.from("outreach_campaigns").update({is_active:a}).eq("id",s);if(l)throw l},onSuccess:()=>_.invalidateQueries({queryKey:["outreach-campaigns"]})}),Me=N({mutationFn:async s=>{const{data:a,error:l}=await p.functions.invoke("send-outreach",{body:{action:"run-campaign",campaignId:s}});if(l)throw l;return a},onSuccess:s=>{d.success(`Queued ${s.queued} messages`)},onError:s=>d.error(s.message)}),K=N({mutationFn:async({email:s,templateId:a})=>{if(!s||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.trim()))throw new Error("Please enter a valid email address");const y=a&&a!=="default"?a:void 0,{data:j,error:ue}=await p.functions.invoke("send-outreach",{body:{action:"send-test",testEmail:s.trim(),templateId:y}});if(ue)throw ue;if(!j.success)throw new Error(j.error);return j},onSuccess:s=>{d.success(s.message||"Test email sent successfully!"),re("")},onError:s=>d.error(s.message)}),J=N({mutationFn:async({templateId:s,filter:a,limit:l})=>{const{data:y,error:j}=await p.functions.invoke("send-outreach",{body:{action:"send-bulk",templateId:s,targetFilter:a,limit:l}});if(j)throw j;if(!y.success)throw new Error(y.error);return y},onSuccess:s=>{d.success(`Sent ${s.sent} emails (${s.failed} failed)`)},onError:s=>d.error(s.message)}),W=()=>{g({name:"",slug:"",subject:"",html_content:"",plain_content:"",category:"outreach",is_active:!0})},pe=()=>{v({name:"",description:"",template_id:"",target_filter:'{"source": "gmb", "claim_status": "unclaimed"}',schedule_config:'{"frequency": "daily"}',max_sends_per_day:50,max_sends_per_clinic:3,is_active:!1})},qe=s=>{V(s),g({name:s.name,slug:s.slug,subject:s.subject,html_content:s.html_content,plain_content:s.plain_content||"",category:s.category||"outreach",is_active:s.is_active}),z(!0)},Le=s=>{De(s),ne(!0)},he=s=>{const a={clinic_name:"Premium Dental Care",patient_name:"Sarah Johnson",claim_link:"https://appointpanda.ae/claim/abc123",review_link:"https://appointpanda.ae/review/abc123",unsubscribe_link:"https://appointpanda.ae/unsubscribe"};let l=s;return Object.entries(a).forEach(([y,j])=>{l=l.replace(new RegExp(`{{${y}}}`,"g"),j)}),l},G=s=>{const a=ss(s);g(l=>({...l,html_content:a})),d.success("Professional template applied")},Oe=()=>{F?me.mutate({id:F.id,data:n}):oe.mutate(n)},Ie=()=>{Q||xe.mutate(r)},He=T?.reduce((s,a)=>s+(a.total_sent||0),0)||0,Re=T?.reduce((s,a)=>s+(a.total_opened||0),0)||0,Ye=T?.filter(s=>s.is_active).length||0;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-display font-bold text-foreground",children:"Outreach Center"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Email campaigns and templates for clinic outreach"})]})}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsx(h,{className:"card-modern",children:e.jsxs(u,{className:"p-4 flex items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-xl bg-primary/10 flex items-center justify-center",children:e.jsx(M,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:f?.length||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Templates"})]})]})}),e.jsx(h,{className:"card-modern",children:e.jsxs(u,{className:"p-4 flex items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-xl bg-teal-light flex items-center justify-center",children:e.jsx(Ue,{className:"h-6 w-6 text-teal"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:Ye}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Active Campaigns"})]})]})}),e.jsx(h,{className:"card-modern",children:e.jsxs(u,{className:"p-4 flex items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-xl bg-blue-light flex items-center justify-center",children:e.jsx(q,{className:"h-6 w-6 text-blue-custom"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:He}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Emails Sent"})]})]})}),e.jsx(h,{className:"card-modern",children:e.jsxs(u,{className:"p-4 flex items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-xl bg-gold-light flex items-center justify-center",children:e.jsx(_e,{className:"h-6 w-6 text-gold"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:Re}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Opened"})]})]})})]}),e.jsxs(Qe,{value:S,onValueChange:E,children:[e.jsxs(Be,{className:"grid w-full grid-cols-4 rounded-xl",children:[e.jsx($,{value:"campaigns",className:"rounded-xl",children:"Campaigns"}),e.jsx($,{value:"templates",className:"rounded-xl",children:"Templates"}),e.jsxs($,{value:"testing",className:"rounded-xl",children:[e.jsx(Ce,{className:"h-4 w-4 mr-1"}),"Test & Send"]}),e.jsx($,{value:"messages",className:"rounded-xl",children:"Message Log"})]}),e.jsx(U,{value:"campaigns",className:"mt-4",children:e.jsxs(h,{className:"card-modern",children:[e.jsxs(R,{className:"flex flex-row items-center justify-between",children:[e.jsx(Y,{className:"text-lg",children:"Email Campaigns"}),e.jsxs(X,{open:Ee,onOpenChange:ie,children:[e.jsx(fe,{asChild:!0,children:e.jsxs(i,{onClick:()=>{Ae(null),pe()},children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"New Campaign"]})}),e.jsxs(Z,{className:"max-w-lg",children:[e.jsx(ee,{children:e.jsx(se,{children:Q?"Edit Campaign":"New Campaign"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Name"}),e.jsx(x,{value:r.name,onChange:s=>v({...r,name:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Description"}),e.jsx(x,{value:r.description,onChange:s=>v({...r,description:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Template"}),e.jsxs(L,{value:r.template_id,onValueChange:s=>v({...r,template_id:s}),children:[e.jsx(O,{children:e.jsx(I,{placeholder:"Select template"})}),e.jsx(H,{children:f?.map(s=>e.jsx(w,{value:s.id,children:s.name},s.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Max Sends/Day"}),e.jsx(x,{type:"number",value:r.max_sends_per_day,onChange:s=>v({...r,max_sends_per_day:parseInt(s.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Max Per Clinic"}),e.jsx(x,{type:"number",value:r.max_sends_per_clinic,onChange:s=>v({...r,max_sends_per_clinic:parseInt(s.target.value)})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Target Filter (JSON)"}),e.jsx(je,{value:r.target_filter,onChange:s=>v({...r,target_filter:s.target.value}),className:"font-mono text-sm",rows:3})]}),e.jsxs(i,{onClick:Ie,className:"w-full",disabled:xe.isPending,children:[Q?"Update":"Create"," Campaign"]})]})]})]})]}),e.jsx(u,{className:"p-0",children:e.jsxs(ye,{children:[e.jsx(Ne,{children:e.jsxs(k,{children:[e.jsx(m,{children:"Campaign"}),e.jsx(m,{children:"Template"}),e.jsx(m,{children:"Stats"}),e.jsx(m,{children:"Status"}),e.jsx(m,{className:"text-right",children:"Actions"})]})}),e.jsxs(we,{children:[T?.map(s=>e.jsxs(k,{children:[e.jsxs(o,{children:[e.jsx("div",{className:"font-medium",children:s.name}),s.description&&e.jsx("p",{className:"text-xs text-muted-foreground",children:s.description})]}),e.jsx(o,{children:f?.find(a=>a.id===s.template_id)?.name||"-"}),e.jsx(o,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Sent:"})," ",s.total_sent," |",e.jsx("span",{className:"text-muted-foreground",children:" Opened:"})," ",s.total_opened]})}),e.jsx(o,{children:e.jsx(ve,{checked:s.is_active,onCheckedChange:a=>Fe.mutate({id:s.id,active:a})})}),e.jsx(o,{className:"text-right",children:e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>Me.mutate(s.id),disabled:!s.is_active,children:[e.jsx(q,{className:"h-4 w-4 mr-1"}),"Run"]})})]},s.id)),(!T||T.length===0)&&e.jsx(k,{children:e.jsxs(o,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:[e.jsx(M,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No campaigns yet"})]})})]})]})})]})}),e.jsxs(U,{value:"templates",className:"mt-4",children:[e.jsxs(h,{className:"card-modern",children:[e.jsxs(R,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Y,{className:"text-lg",children:"Email Templates"}),e.jsx(le,{children:"Professional templates with live preview"})]}),e.jsxs(X,{open:Pe,onOpenChange:z,children:[e.jsx(fe,{asChild:!0,children:e.jsxs(i,{onClick:()=>{V(null),W()},children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"New Template"]})}),e.jsxs(Z,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(ee,{children:e.jsx(se,{children:F?"Edit Template":"New Template"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 py-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Name"}),e.jsx(x,{value:n.name,onChange:s=>g({...n,name:s.target.value,slug:s.target.value.toLowerCase().replace(/\s+/g,"-")})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Slug"}),e.jsx(x,{value:n.slug,onChange:s=>g({...n,slug:s.target.value})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Subject"}),e.jsx(x,{value:n.subject,onChange:s=>g({...n,subject:s.target.value}),placeholder:"Email subject line"})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(t,{children:"Quick Templates"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(i,{type:"button",variant:"outline",size:"sm",onClick:()=>G("welcome"),children:[e.jsx(ae,{className:"h-3 w-3 mr-1"}),"Welcome"]}),e.jsxs(i,{type:"button",variant:"outline",size:"sm",onClick:()=>G("claim_reminder"),children:[e.jsx(ae,{className:"h-3 w-3 mr-1"}),"Claim"]}),e.jsxs(i,{type:"button",variant:"outline",size:"sm",onClick:()=>G("review_request"),children:[e.jsx(ae,{className:"h-3 w-3 mr-1"}),"Review"]})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"HTML Content"}),e.jsx(je,{value:n.html_content,onChange:s=>g({...n,html_content:s.target.value}),rows:12,className:"font-mono text-xs",placeholder:"<html>...</html>"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Variables: ","{{clinic_name}}",", ","{{claim_link}}",", ","{{unsubscribe_link}}",", ","{{patient_name}}",", ","{{review_link}}"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(t,{children:"Active"}),e.jsx(ve,{checked:n.is_active,onCheckedChange:s=>g({...n,is_active:s})})]}),e.jsxs(i,{onClick:Oe,className:"w-full",disabled:oe.isPending||me.isPending,children:[F?"Update":"Create"," Template"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(t,{children:"Live Preview"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(i,{type:"button",variant:C==="mobile"?"default":"outline",size:"sm",onClick:()=>A("mobile"),children:e.jsx(ke,{className:"h-4 w-4"})}),e.jsx(i,{type:"button",variant:C==="desktop"?"default":"outline",size:"sm",onClick:()=>A("desktop"),children:e.jsx(Se,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:`border rounded-xl overflow-hidden bg-muted/30 ${C==="mobile"?"max-w-[375px] mx-auto":""}`,children:[e.jsxs("div",{className:"bg-muted/50 px-3 py-2 border-b flex items-center gap-2",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"h-2.5 w-2.5 rounded-full bg-red-400"}),e.jsx("div",{className:"h-2.5 w-2.5 rounded-full bg-yellow-400"}),e.jsx("div",{className:"h-2.5 w-2.5 rounded-full bg-green-400"})]}),e.jsx("span",{className:"text-xs text-muted-foreground flex-1 text-center truncate",children:n.subject||"Email Preview"})]}),e.jsx("div",{className:"h-[400px] overflow-auto",children:n.html_content?e.jsx("iframe",{srcDoc:he(n.html_content),className:"w-full h-full border-0",title:"Email Preview"}):e.jsx("div",{className:"h-full flex items-center justify-center text-muted-foreground",children:e.jsxs("div",{className:"text-center",children:[e.jsx(M,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"Enter HTML to see preview"})]})})})]})]})]})]})]})]}),e.jsx(u,{className:"p-0",children:e.jsxs(ye,{children:[e.jsx(Ne,{children:e.jsxs(k,{children:[e.jsx(m,{children:"Template"}),e.jsx(m,{children:"Subject"}),e.jsx(m,{children:"Category"}),e.jsx(m,{children:"Status"}),e.jsx(m,{className:"text-right",children:"Actions"})]})}),e.jsxs(we,{children:[f?.map(s=>e.jsxs(k,{children:[e.jsx(o,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-xl bg-primary/10 flex items-center justify-center",children:e.jsx(M,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.slug})]})]})}),e.jsx(o,{className:"max-w-48 truncate",children:s.subject}),e.jsx(o,{children:e.jsx(te,{variant:"outline",children:s.category||"outreach"})}),e.jsx(o,{children:s.is_active?e.jsx(te,{className:"bg-teal/20 text-teal border-0",children:"Active"}):e.jsx(te,{variant:"secondary",children:"Inactive"})}),e.jsx(o,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(i,{variant:"outline",size:"sm",onClick:()=>Le(s),children:e.jsx(_e,{className:"h-4 w-4"})}),e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>qe(s),children:e.jsx(Ge,{className:"h-4 w-4"})})]})})]},s.id)),(!f||f.length===0)&&e.jsx(k,{children:e.jsxs(o,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:[e.jsx(Xe,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No templates yet"})]})})]})]})})]}),e.jsx(X,{open:ze,onOpenChange:ne,children:e.jsxs(Z,{className:"max-w-4xl max-h-[90vh]",children:[e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(se,{children:["Template Preview: ",D?.name]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs(i,{variant:C==="mobile"?"default":"outline",size:"sm",onClick:()=>A("mobile"),children:[e.jsx(ke,{className:"h-4 w-4 mr-1"}),"Mobile"]}),e.jsxs(i,{variant:C==="desktop"?"default":"outline",size:"sm",onClick:()=>A("desktop"),children:[e.jsx(Se,{className:"h-4 w-4 mr-1"}),"Desktop"]})]})]})}),e.jsxs("div",{className:`border rounded-xl overflow-hidden bg-muted/30 ${C==="mobile"?"max-w-[375px] mx-auto":""}`,children:[e.jsxs("div",{className:"bg-muted/50 px-3 py-2 border-b flex items-center gap-2",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"h-2.5 w-2.5 rounded-full bg-red-400"}),e.jsx("div",{className:"h-2.5 w-2.5 rounded-full bg-yellow-400"}),e.jsx("div",{className:"h-2.5 w-2.5 rounded-full bg-green-400"})]}),e.jsx("span",{className:"text-xs text-muted-foreground flex-1 text-center truncate",children:D?.subject})]}),e.jsx("div",{className:"h-[500px] overflow-auto",children:D?.html_content&&e.jsx("iframe",{srcDoc:he(D.html_content),className:"w-full h-full border-0",title:"Email Preview"})})]})]})})]}),e.jsxs(U,{value:"testing",className:"mt-4 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs(h,{className:"card-modern",children:[e.jsxs(R,{children:[e.jsxs(Y,{className:"text-lg flex items-center gap-2",children:[e.jsx(Ce,{className:"h-5 w-5 text-primary"}),"Send Test Email"]}),e.jsx(le,{children:"Test your SMTP configuration and templates"})]}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Email Address"}),e.jsx(x,{type:"email",placeholder:"test@example.com",value:B,onChange:s=>re(s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Template (Optional)"}),e.jsxs(L,{value:P,onValueChange:ce,children:[e.jsx(O,{children:e.jsx(I,{placeholder:"Default test template"})}),e.jsxs(H,{children:[e.jsx(w,{value:"default",children:"Default Test Template"}),f?.map(s=>e.jsx(w,{value:s.id,children:s.name},s.id))]})]})]}),e.jsxs(i,{onClick:()=>K.mutate({email:B,templateId:P||void 0}),disabled:!B||K.isPending,className:"w-full",children:[K.isPending?e.jsx(be,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(q,{className:"h-4 w-4 mr-2"}),"Send Test Email"]})]})]}),e.jsxs(h,{className:"card-modern",children:[e.jsxs(R,{children:[e.jsxs(Y,{className:"text-lg flex items-center gap-2",children:[e.jsx(Ve,{className:"h-5 w-5 text-primary"}),"Bulk Send"]}),e.jsx(le,{children:"Send emails to multiple clinics at once"})]}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Target Clinics"}),e.jsxs(L,{value:b.claim_status,onValueChange:s=>de({...b,claim_status:s}),children:[e.jsx(O,{children:e.jsx(I,{})}),e.jsxs(H,{children:[e.jsx(w,{value:"unclaimed",children:"Unclaimed Profiles"}),e.jsx(w,{value:"claimed",children:"Claimed Profiles"}),e.jsx(w,{value:"all",children:"All Profiles"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Template"}),e.jsxs(L,{value:P,onValueChange:ce,children:[e.jsx(O,{children:e.jsx(I,{placeholder:"Select template"})}),e.jsx(H,{children:f?.map(s=>e.jsx(w,{value:s.id,children:s.name},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Limit (max emails)"}),e.jsx(x,{type:"number",value:b.limit,onChange:s=>de({...b,limit:parseInt(s.target.value)||5}),min:1,max:50})]}),e.jsxs(i,{onClick:()=>J.mutate({templateId:P,filter:{claim_status:b.claim_status},limit:b.limit}),disabled:!P||J.isPending,className:"w-full",variant:"outline",children:[J.isPending?e.jsx(be,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(q,{className:"h-4 w-4 mr-2"}),"Send to ",b.limit," Clinics"]})]})]})]}),e.jsxs(Ke,{children:[e.jsx(Ze,{className:"h-4 w-4"}),e.jsx(Je,{children:"SMTP Configuration"}),e.jsx(We,{children:"Emails are sent using your configured SMTP server. Make sure your SMTP settings are correctly configured in Settings ‚Üí Email tab."})]})]}),e.jsx(U,{value:"messages",className:"mt-4",children:e.jsx(h,{className:"card-modern",children:e.jsxs(u,{className:"p-8 text-center",children:[e.jsx(es,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground opacity-50"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Message Log Coming Soon"}),e.jsx("p",{className:"text-muted-foreground",children:"View delivery status and engagement metrics for all sent messages"})]})})})]})]})}export{ks as default};
