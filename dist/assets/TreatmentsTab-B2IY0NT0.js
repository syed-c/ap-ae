import{u as L,b,c as C,j as e}from"./chunk-CPh6voF3.js";import{r as p}from"./chunk-CffrGP6S.js";import{s as c,b as d,a9 as I,bc as k,B as j,aa as P,ab as B,ac as O,a as o,I as g,al as Q,v as w,p as H,i as K}from"./index-DflORfjh.js";import{c as A}from"./chunk-BSjc5zjM.js";import{C as f,d as y}from"./chunk-Dwq_v72W.js";import{S as V}from"./chunk-DfjE-bP6.js";import{T as M,a as R,b as D,c as m,d as U,e as u}from"./chunk-NLs5Ye4A.js";import{A as z,h as G,a as J,b as W,c as X,d as Y,e as Z,f as $,g as ee}from"./chunk--UsBvJF_.js";import{P as se}from"./chunk-HAC-i_a2.js";import{S as ae}from"./chunk-B51FxpoB.js";import{T as te}from"./chunk-BRVan1jG.js";import"./chunk-B8auUmee.js";import"./chunk-DK8nT4cj.js";import"./chunk-Drd-rt-S.js";import"./chunk-BEQ5VEiB.js";import"./chunk-yff5u8mE.js";import"./chunk-xExVBHTi.js";function re(){return L({queryKey:["admin-treatments"],queryFn:async()=>{const{data:t,error:a}=await c.from("treatments").select("*").order("display_order").order("name");if(a)throw a;return t||[]}})}function ie(){const t=b();return C({mutationFn:async a=>{const{data:i,error:n}=await c.from("treatments").insert([a]).select().single();if(n)throw n;return await A({action:"CREATE",entityType:"treatment",entityId:i.id,newValues:a}),i},onSuccess:()=>{t.invalidateQueries({queryKey:["admin-treatments"]}),d.success("Treatment created")},onError:a=>d.error("Failed: "+a.message)})}function ne(){const t=b();return C({mutationFn:async({id:a,updates:i})=>{const{data:n}=await c.from("treatments").select("*").eq("id",a).single(),{error:x}=await c.from("treatments").update(i).eq("id",a);if(x)throw x;await A({action:"UPDATE",entityType:"treatment",entityId:a,oldValues:n,newValues:i})},onSuccess:()=>{t.invalidateQueries({queryKey:["admin-treatments"]}),d.success("Treatment updated")},onError:a=>d.error("Failed: "+a.message)})}function le(){const t=b();return C({mutationFn:async a=>{const{data:i}=await c.from("treatments").select("*").eq("id",a).single(),{error:n}=await c.from("treatments").delete().eq("id",a);if(n)throw n;await A({action:"DELETE",entityType:"treatment",entityId:a,oldValues:i})},onSuccess:()=>{t.invalidateQueries({queryKey:["admin-treatments"]}),d.success("Treatment deleted")},onError:a=>d.error("Failed: "+a.message)})}function Ce(){const{data:t,isLoading:a}=re(),i=ie(),n=ne(),x=le(),[_,v]=p.useState(!1),[h,N]=p.useState(null),[T,S]=p.useState(""),[r,l]=p.useState({name:"",slug:"",description:"",icon:"",is_active:!0,display_order:0}),E=t?.filter(s=>s.name.toLowerCase().includes(T.toLowerCase())||s.slug.toLowerCase().includes(T.toLowerCase()))||[],q=async()=>{const s={...r};h?await n.mutateAsync({id:h.id,updates:s}):await i.mutateAsync(s),v(!1),N(null),l({name:"",slug:"",description:"",icon:"",is_active:!0,display_order:0})},F=s=>{N(s),l({name:s.name,slug:s.slug,description:s.description||"",icon:s.icon||"",is_active:s.is_active,display_order:s.display_order||0}),v(!0)};return a?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-display font-bold text-foreground",children:"Treatments Management"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage dental services and procedures"})]}),e.jsxs(I,{open:_,onOpenChange:v,children:[e.jsx(k,{asChild:!0,children:e.jsxs(j,{onClick:()=>{N(null),l({name:"",slug:"",description:"",icon:"",is_active:!0,display_order:0})},children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Add Treatment"]})}),e.jsxs(P,{children:[e.jsx(B,{children:e.jsx(O,{children:h?"Edit Treatment":"Add Treatment"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Name"}),e.jsx(g,{value:r.name,onChange:s=>l({...r,name:s.target.value,slug:s.target.value.toLowerCase().replace(/\s+/g,"-")}),placeholder:"Treatment name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Slug"}),e.jsx(g,{value:r.slug,onChange:s=>l({...r,slug:s.target.value}),placeholder:"treatment-slug"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Description"}),e.jsx(Q,{value:r.description,onChange:s=>l({...r,description:s.target.value}),placeholder:"Brief description"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Display Order"}),e.jsx(g,{type:"number",value:r.display_order,onChange:s=>l({...r,display_order:parseInt(s.target.value)||0})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(o,{children:"Active"}),e.jsx(V,{checked:r.is_active,onCheckedChange:s=>l({...r,is_active:s})})]}),e.jsxs(j,{onClick:q,className:"w-full",disabled:i.isPending||n.isPending,children:[h?"Update":"Create"," Treatment"]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(f,{className:"card-modern",children:e.jsxs(y,{className:"p-4 flex items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-xl bg-primary/10 flex items-center justify-center",children:e.jsx(w,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:t?.length||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Treatments"})]})]})}),e.jsx(f,{className:"card-modern",children:e.jsxs(y,{className:"p-4 flex items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-xl bg-blue-light flex items-center justify-center",children:e.jsx(w,{className:"h-6 w-6 text-blue-custom"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:t?.filter(s=>s.is_active).length||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Active"})]})]})}),e.jsx(f,{className:"card-modern",children:e.jsxs(y,{className:"p-4 flex items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-xl bg-coral-light flex items-center justify-center",children:e.jsx(w,{className:"h-6 w-6 text-coral"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:t?.filter(s=>!s.is_active).length||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Inactive"})]})]})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(H,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(g,{placeholder:"Search treatments...",value:T,onChange:s=>S(s.target.value),className:"pl-10"})]}),e.jsx(f,{className:"card-modern",children:e.jsx(y,{className:"p-0",children:e.jsxs(M,{children:[e.jsx(R,{children:e.jsxs(D,{children:[e.jsx(m,{children:"Name"}),e.jsx(m,{children:"Slug"}),e.jsx(m,{children:"Order"}),e.jsx(m,{children:"Status"}),e.jsx(m,{className:"text-right",children:"Actions"})]})}),e.jsx(U,{children:E.map(s=>e.jsxs(D,{children:[e.jsx(u,{className:"font-medium",children:s.name}),e.jsx(u,{className:"text-muted-foreground",children:s.slug}),e.jsx(u,{children:s.display_order}),e.jsx(u,{children:e.jsx(K,{variant:s.is_active?"default":"secondary",children:s.is_active?"Active":"Inactive"})}),e.jsxs(u,{className:"text-right",children:[e.jsx(j,{variant:"ghost",size:"sm",onClick:()=>F(s),children:e.jsx(ae,{className:"h-4 w-4"})}),e.jsxs(z,{children:[e.jsx(G,{asChild:!0,children:e.jsx(j,{variant:"ghost",size:"sm",className:"text-destructive",children:e.jsx(te,{className:"h-4 w-4"})})}),e.jsxs(J,{children:[e.jsxs(W,{children:[e.jsx(X,{children:"Delete Treatment?"}),e.jsxs(Y,{children:['This will permanently delete "',s.name,'". This action cannot be undone.']})]}),e.jsxs(Z,{children:[e.jsx($,{children:"Cancel"}),e.jsx(ee,{onClick:()=>x.mutate(s.id),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})]})]})]},s.id))})]})})})]})}export{Ce as default};
