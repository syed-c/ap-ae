import{u as y,b as o,c}from"./chunk-CPh6voF3.js";import{s as i,bw as m,bB as f,b as r}from"./index-DflORfjh.js";import{c as u}from"./chunk-BSjc5zjM.js";function p(){return y({queryKey:["countries"],queryFn:async()=>{const{data:t,error:e}=await i.from("countries").select("*").order("name");if(e)throw e;return t}})}function g(){return y({queryKey:["admin-states"],queryFn:async()=>{const t=m.map(s=>s.fullSlug),{data:e,error:a}=await i.from("states").select("*").in("slug",[...f,...t]).order("name");if(a)throw a;return e}})}function E(){const t=o();return c({mutationFn:async e=>{const{data:a,error:s}=await i.from("states").insert([e]).select().single();if(s)throw s;return await u({action:"CREATE",entityType:"state",entityId:a.id,newValues:e}),a},onSuccess:()=>{t.invalidateQueries({queryKey:["admin-states"]}),r.success("State created")},onError:e=>r.error("Failed: "+e.message)})}function v(){const t=o();return c({mutationFn:async({id:e,updates:a})=>{const{data:s}=await i.from("states").select("*").eq("id",e).single(),{error:n}=await i.from("states").update(a).eq("id",e);if(n)throw n;await u({action:"UPDATE",entityType:"state",entityId:e,oldValues:s,newValues:a})},onSuccess:()=>{t.invalidateQueries({queryKey:["admin-states"]}),r.success("State updated")},onError:e=>r.error("Failed: "+e.message)})}function F(){const t=o();return c({mutationFn:async({id:e,isActive:a})=>{const{error:s}=await i.from("states").update({is_active:a}).eq("id",e);if(s)throw s;await u({action:"UPDATE",entityType:"state",entityId:e,newValues:{is_active:a}})},onSuccess:()=>{t.invalidateQueries({queryKey:["admin-states"]}),t.invalidateQueries({queryKey:["states"]}),t.invalidateQueries({queryKey:["states-with-clinics"]}),r.success("State visibility updated")},onError:e=>r.error("Failed: "+e.message)})}function T(){const t=o();return c({mutationFn:async({id:e,isActive:a})=>{const{error:s}=await i.from("cities").update({is_active:a}).eq("id",e);if(s)throw s;await u({action:"UPDATE",entityType:"city",entityId:e,newValues:{is_active:a}})},onSuccess:()=>{t.invalidateQueries({queryKey:["admin-cities"]}),t.invalidateQueries({queryKey:["cities"]}),r.success("City visibility updated")},onError:e=>r.error("Failed: "+e.message)})}function h(){return y({queryKey:["cities-with-clinics"],queryFn:async()=>{const{data:t,error:e}=await i.from("clinics").select("city_id").eq("claim_status","approved");if(e)throw e;const a=t,s=new Set;if((a||[]).forEach(d=>{d.city_id&&s.add(d.city_id)}),s.size===0)return[];const{data:n,error:l}=await i.from("cities").select("id, name");if(l)throw l;return(n||[]).filter(d=>s.has(d.id))}})}function A(){const t=o();return c({mutationFn:async()=>{const{data:e,error:a}=await i.functions.invoke("seed-us-locations",{body:{action:"seed_all"}});if(a)throw a;return e},onSuccess:e=>{t.invalidateQueries({queryKey:["admin-states"]}),t.invalidateQueries({queryKey:["admin-cities"]}),t.invalidateQueries({queryKey:["geo-expansion-stats"]}),r.success(`Seeded ${e.stats?.statesInserted||0} states and ${e.stats?.citiesInserted||0} cities`)},onError:e=>r.error("Failed to seed: "+e.message)})}function K(){return y({queryKey:["location-stats"],queryFn:async()=>{const{data:t,error:e}=await i.functions.invoke("seed-us-locations",{body:{action:"get_stats"}});if(e)throw e;return t.stats}})}function Q(t){return y({queryKey:["admin-cities",t],queryFn:async()=>{let e=i.from("cities").select("*, state:states(id, name, abbreviation)").order("name");t&&(e=e.eq("state_id",t));const{data:a,error:s}=await e;if(s)throw s;return a}})}function _(t){return y({queryKey:["admin-areas",t],queryFn:async()=>{let e=i.from("areas").select("*, city:cities(*)").order("name");t&&(e=e.eq("city_id",t));const{data:a,error:s}=await e;if(s)throw s;return a}})}function V(){const t=o();return c({mutationFn:async e=>{const{data:a,error:s}=await i.from("cities").insert([e]).select().single();if(s)throw s;return await u({action:"CREATE",entityType:"city",entityId:a.id,newValues:e}),a},onSuccess:()=>{t.invalidateQueries({queryKey:["admin-cities"]}),r.success("City created")},onError:e=>r.error("Failed: "+e.message)})}function b(){const t=o();return c({mutationFn:async({id:e,updates:a})=>{const{data:s}=await i.from("cities").select("*").eq("id",e).single(),{error:n}=await i.from("cities").update(a).eq("id",e);if(n)throw n;await u({action:"UPDATE",entityType:"city",entityId:e,oldValues:s,newValues:a})},onSuccess:()=>{t.invalidateQueries({queryKey:["admin-cities"]}),r.success("City updated")},onError:e=>r.error("Failed: "+e.message)})}function I(){const t=o();return c({mutationFn:async e=>{const{data:a,error:s}=await i.from("areas").insert([e]).select().single();if(s)throw s;return await u({action:"CREATE",entityType:"area",entityId:a.id,newValues:e}),a},onSuccess:()=>{t.invalidateQueries({queryKey:["admin-areas"]}),r.success("Area created")},onError:e=>r.error("Failed: "+e.message)})}function U(){const t=o();return c({mutationFn:async({id:e,updates:a})=>{const{data:s}=await i.from("areas").select("*").eq("id",e).single(),{error:n}=await i.from("areas").update(a).eq("id",e);if(n)throw n;await u({action:"UPDATE",entityType:"area",entityId:e,oldValues:s,newValues:a})},onSuccess:()=>{t.invalidateQueries({queryKey:["admin-areas"]}),r.success("Area updated")},onError:e=>r.error("Failed: "+e.message)})}export{g as a,_ as b,V as c,b as d,I as e,U as f,E as g,v as h,F as i,T as j,Q as k,h as l,K as m,A as n,p as u};
