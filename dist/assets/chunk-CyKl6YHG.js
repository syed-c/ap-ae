import{c as l}from"./chunk-CPh6voF3.js";import{u as h,s,b as r}from"./index-DflORfjh.js";function g(){const{user:t}=h();return l({mutationFn:async({planSlug:e,clinicId:n,successUrl:a,cancelUrl:c})=>{if(!t)throw new Error("You must be logged in to upgrade");const{data:{session:i}}=await s.auth.getSession();if(!i?.access_token)throw new Error("Authentication required");const u=`${window.location.origin}/admin?tab=dashboard&subscription=success`,d=`${window.location.origin}/admin?tab=dashboard&subscription=cancelled`,o=await s.functions.invoke("create-checkout-session",{body:{planSlug:e,clinicId:n,successUrl:a||u,cancelUrl:c||d}});if(o.error)throw new Error(o.error.message||"Failed to create checkout session");return o.data},onSuccess:e=>{e?.url?(r.loading("Redirecting to secure checkout..."),window.location.href=e.url):r.error("Failed to get checkout URL")},onError:e=>{r.error(e.message||"Failed to start checkout")}})}export{g as u};
