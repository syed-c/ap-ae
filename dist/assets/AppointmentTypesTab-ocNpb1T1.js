import{b as Q,u as B,c as f,j as e}from"./chunk-CPh6voF3.js";import{r as j}from"./chunk-CffrGP6S.js";import{s as c,v as N,m as U,a9 as I,bc as z,B as n,aa as G,ab as H,ac as V,y as k,ad as Y,a as x,I as w,al as J,l as h,aK as W,ap as D,ae as X,i as Z,t as ee,b as d}from"./index-DflORfjh.js";import{u as se}from"./chunk-BdAozh8S.js";import{C as g,d as b}from"./chunk-Dwq_v72W.js";import{S as ae}from"./chunk-DfjE-bP6.js";import{S as y}from"./chunk-CQtADEjB.js";import{P as _}from"./chunk-HAC-i_a2.js";import{T as te}from"./chunk-C4_bt_FT.js";import{P as ie}from"./chunk-C2VW2Ml6.js";import{P as re}from"./chunk-4cd3rYYj.js";import{T as le}from"./chunk-BRVan1jG.js";import"./chunk-B8auUmee.js";import"./chunk-DK8nT4cj.js";import"./chunk-Drd-rt-S.js";import"./chunk-BEQ5VEiB.js";import"./chunk-yff5u8mE.js";import"./chunk-xExVBHTi.js";const T=[{value:"blue",label:"Blue",class:"bg-blue-500",ring:"ring-blue-500"},{value:"green",label:"Green",class:"bg-emerald-500",ring:"ring-emerald-500"},{value:"purple",label:"Purple",class:"bg-violet-500",ring:"ring-violet-500"},{value:"orange",label:"Orange",class:"bg-orange-500",ring:"ring-orange-500"},{value:"pink",label:"Pink",class:"bg-pink-500",ring:"ring-pink-500"},{value:"teal",label:"Teal",class:"bg-teal-500",ring:"ring-teal-500"},{value:"amber",label:"Amber",class:"bg-amber-500",ring:"ring-amber-500"},{value:"rose",label:"Rose",class:"bg-rose-500",ring:"ring-rose-500"}],ne=[{name:"New Patient Exam",duration:60,color:"blue",description:"Comprehensive first-visit examination"},{name:"Routine Cleaning",duration:45,color:"green",description:"Professional dental cleaning"},{name:"Emergency Visit",duration:30,color:"orange",description:"Urgent dental care"},{name:"Consultation",duration:30,color:"purple",description:"Treatment planning discussion"},{name:"Follow-up",duration:15,color:"teal",description:"Post-treatment check"}],oe=[{value:15,label:"15 min",icon:"âš¡"},{value:30,label:"30 min",icon:"ðŸ•"},{value:45,label:"45 min",icon:"ðŸ•’"},{value:60,label:"1 hour",icon:"ðŸ•“"},{value:90,label:"1.5 hrs",icon:"ðŸ••"},{value:120,label:"2 hours",icon:"ðŸ•"}];function ke(){const{data:i,isLoading:F}=se(),u=Q(),[P,o]=j.useState(!1),[m,C]=j.useState(null),[a,l]=j.useState({name:"",description:"",duration_minutes:30,price_from:"",price_to:"",color:"blue"}),{data:p,isLoading:q}=B({queryKey:["appointment-types",i?.id],queryFn:async()=>{const{data:s,error:t}=await c.from("appointment_types").select("*").eq("clinic_id",i.id).order("display_order");if(t)throw t;return s},enabled:!!i?.id}),v=f({mutationFn:async()=>{const s={clinic_id:i.id,name:a.name,description:a.description||null,duration_minutes:a.duration_minutes,price_from:a.price_from?parseFloat(a.price_from):null,price_to:a.price_to?parseFloat(a.price_to):null,color:a.color,is_active:!0};if(m){const{error:t}=await c.from("appointment_types").update(s).eq("id",m.id);if(t)throw t}else{const{error:t}=await c.from("appointment_types").insert(s);if(t)throw t}},onSuccess:()=>{u.invalidateQueries({queryKey:["appointment-types",i?.id]}),o(!1),S(),d.success(m?"Service updated":"Service created")},onError:s=>{d.error(s.message||"Failed to save")}}),E=f({mutationFn:async({id:s,isActive:t})=>{const{error:r}=await c.from("appointment_types").update({is_active:t}).eq("id",s);if(r)throw r},onSuccess:()=>{u.invalidateQueries({queryKey:["appointment-types",i?.id]}),d.success("Status updated")}}),$=f({mutationFn:async s=>{const{error:t}=await c.from("appointment_types").delete().eq("id",s);if(t)throw t},onSuccess:()=>{u.invalidateQueries({queryKey:["appointment-types",i?.id]}),d.success("Service deleted")}}),A=async()=>{if(!i?.id)return;const s=ne.map((r,O)=>({clinic_id:i.id,name:r.name,description:r.description,duration_minutes:r.duration,color:r.color,is_active:!0,display_order:O})),{error:t}=await c.from("appointment_types").insert(s);t?d.error("Failed to create default services"):(u.invalidateQueries({queryKey:["appointment-types",i.id]}),d.success("Default services created"))},S=()=>{l({name:"",description:"",duration_minutes:30,price_from:"",price_to:"",color:"blue"}),C(null)},L=s=>{C(s),l({name:s.name,description:s.description||"",duration_minutes:s.duration_minutes,price_from:s.price_from?.toString()||"",price_to:s.price_to?.toString()||"",color:s.color||"blue"}),o(!0)},R=s=>T.find(t=>t.value===s)?.class||"bg-primary";if(F||q)return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(y,{className:"h-10 w-64 bg-slate-700/50"}),e.jsx(y,{className:"h-10 w-32 bg-slate-700/50"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3,4,5,6].map(s=>e.jsx(y,{className:"h-44 w-full bg-slate-700/50 rounded-xl"},s))})]});if(!i)return e.jsx(g,{className:"bg-slate-800/90 border border-slate-700/50",children:e.jsxs(b,{className:"py-12 text-center",children:[e.jsx(N,{className:"h-12 w-12 mx-auto text-white/30 mb-4"}),e.jsx("p",{className:"text-white/60",children:"No clinic linked to your account"})]})});const K=p?.filter(s=>s.is_active).length||0,M=p?.length||0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between gap-4 p-5 rounded-2xl bg-slate-800/90 border border-slate-700/50 shadow-lg",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"h-14 w-14 rounded-xl bg-gradient-to-br from-primary to-teal flex items-center justify-center shadow-lg",children:e.jsx(U,{className:"h-7 w-7 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-display font-bold text-white",children:"Appointment Types"}),e.jsx("p",{className:"text-white/60 mt-1",children:"Define the services patients can book online"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-slate-700/50 border border-slate-600/50",children:[e.jsx("span",{className:"text-2xl font-bold text-primary",children:K}),e.jsxs("span",{className:"text-white/60 text-sm",children:["/ ",M," active"]})]}),e.jsxs(I,{open:P,onOpenChange:s=>{o(s),s||S()},children:[e.jsx(z,{asChild:!0,children:e.jsxs(n,{className:"gap-2 bg-primary hover:bg-primary/90 text-white font-semibold",children:[e.jsx(_,{className:"h-4 w-4"}),"Add Service"]})}),e.jsxs(G,{className:"sm:max-w-lg bg-slate-900 border-slate-700/50",children:[e.jsxs(H,{children:[e.jsxs(V,{className:"flex items-center gap-2 text-white",children:[e.jsx(k,{className:"h-5 w-5 text-primary"}),m?"Edit Service":"Create New Service"]}),e.jsx(Y,{className:"text-white/60",children:"Define a bookable service with duration and pricing"})]}),e.jsxs("div",{className:"space-y-5 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{className:"text-white",children:"Service Name *"}),e.jsx(w,{placeholder:"e.g., Routine Cleaning",value:a.name,onChange:s=>l({...a,name:s.target.value}),className:"bg-slate-800 border-slate-600/50 text-white placeholder:text-white/40"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{className:"text-white",children:"Description"}),e.jsx(J,{placeholder:"Brief description of the service...",value:a.description,onChange:s=>l({...a,description:s.target.value}),rows:2,className:"bg-slate-800 border-slate-600/50 text-white placeholder:text-white/40"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{className:"text-white flex items-center gap-2",children:[e.jsx(te,{className:"h-4 w-4 text-primary"}),"Duration"]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:oe.map(s=>e.jsxs("button",{type:"button",onClick:()=>l({...a,duration_minutes:s.value}),className:h("flex items-center justify-center gap-2 p-3 rounded-lg border-2 transition-all",a.duration_minutes===s.value?"border-primary bg-primary/10 text-primary":"border-slate-600/50 text-white/70 hover:border-slate-500"),children:[e.jsx("span",{className:"text-sm",children:s.icon}),e.jsx("span",{className:"font-medium text-sm",children:s.label})]},s.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{className:"text-white flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4 text-primary"}),"Color Tag"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:T.map(s=>e.jsx("button",{type:"button",onClick:()=>l({...a,color:s.value}),className:h("w-10 h-10 rounded-lg flex items-center justify-center transition-all",s.class,a.color===s.value?"ring-2 ring-white ring-offset-2 ring-offset-slate-900 scale-110":"hover:scale-105"),children:a.color===s.value&&e.jsx(W,{className:"h-5 w-5 text-white"})},s.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{className:"text-white flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4 text-primary"}),"Price Range (Optional)"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-white/50",children:"$"}),e.jsx(w,{type:"number",placeholder:"Min",value:a.price_from,onChange:s=>l({...a,price_from:s.target.value}),className:"pl-7 bg-slate-800 border-slate-600/50 text-white placeholder:text-white/40"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-white/50",children:"$"}),e.jsx(w,{type:"number",placeholder:"Max",value:a.price_to,onChange:s=>l({...a,price_to:s.target.value}),className:"pl-7 bg-slate-800 border-slate-600/50 text-white placeholder:text-white/40"})]})]})]})]}),e.jsxs(X,{className:"gap-2",children:[e.jsx(n,{variant:"outline",onClick:()=>o(!1),className:"border-slate-600/50 text-white hover:bg-slate-700/50",children:"Cancel"}),e.jsx(n,{onClick:()=>v.mutate(),disabled:!a.name||v.isPending,className:"bg-primary hover:bg-primary/90 text-white font-semibold",children:v.isPending?e.jsx(e.Fragment,{children:"Saving..."}):m?e.jsx(e.Fragment,{children:"Update Service"}):e.jsx(e.Fragment,{children:"Create Service"})})]})]})]})]})]}),!p||p.length===0?e.jsx(g,{className:"bg-slate-800/90 border border-slate-700/50",children:e.jsxs(b,{className:"py-16 text-center",children:[e.jsx("div",{className:"h-20 w-20 rounded-2xl bg-slate-700/50 flex items-center justify-center mx-auto mb-6",children:e.jsx(N,{className:"h-10 w-10 text-white/30"})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"No services configured yet"}),e.jsx("p",{className:"text-white/60 mb-6 max-w-md mx-auto",children:"Create appointment types so patients can book specific services online"}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsxs(n,{onClick:A,variant:"outline",className:"border-slate-600/50 text-white hover:bg-slate-700/50",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Create Default Services"]}),e.jsxs(n,{onClick:()=>o(!0),className:"bg-primary hover:bg-primary/90",children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"Add Custom Service"]})]})]})}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[p.map(s=>{const t=R(s.color);return e.jsxs(g,{className:h("bg-slate-800/90 border border-slate-700/50 overflow-hidden transition-all hover:border-slate-600/50 hover:shadow-lg group",!s.is_active&&"opacity-60"),children:[e.jsx("div",{className:h("h-1.5",t)}),e.jsxs(b,{className:"p-5",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:h("h-12 w-12 rounded-xl flex items-center justify-center",t),children:e.jsx(N,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-white text-lg",children:s.name}),!s.is_active&&e.jsx(Z,{className:"bg-slate-700 text-white/60 border-0 text-xs mt-1",children:"Inactive"})]})]}),e.jsx(ae,{checked:s.is_active,onCheckedChange:r=>E.mutate({id:s.id,isActive:r}),className:"data-[state=checked]:bg-primary"})]}),s.description&&e.jsx("p",{className:"text-white/60 text-sm mb-4 line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-white/70",children:[e.jsx(ee,{className:"h-4 w-4 text-primary"}),e.jsxs("span",{className:"text-sm font-medium",children:[s.duration_minutes," min"]})]}),(s.price_from||s.price_to)&&e.jsxs("div",{className:"flex items-center gap-1 text-white/70",children:[e.jsx(D,{className:"h-4 w-4 text-teal"}),e.jsx("span",{className:"text-sm font-medium",children:s.price_from&&s.price_to?`$${s.price_from} - $${s.price_to}`:s.price_from?`From $${s.price_from}`:`Up to $${s.price_to}`})]})]}),e.jsxs("div",{className:"flex gap-2 pt-3 border-t border-slate-700/50",children:[e.jsxs(n,{variant:"ghost",size:"sm",onClick:()=>L(s),className:"flex-1 text-white/70 hover:text-white hover:bg-slate-700/50",children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>$.mutate(s.id),className:"text-coral/70 hover:text-coral hover:bg-coral/10",children:e.jsx(le,{className:"h-4 w-4"})})]})]})]},s.id)}),e.jsx(g,{className:"bg-slate-800/50 border-2 border-dashed border-slate-600/50 hover:border-primary/50 cursor-pointer transition-all group",onClick:()=>o(!0),children:e.jsxs(b,{className:"p-5 h-full flex flex-col items-center justify-center min-h-[200px]",children:[e.jsx("div",{className:"h-14 w-14 rounded-xl bg-slate-700/50 flex items-center justify-center mb-4 group-hover:bg-primary/20 transition-colors",children:e.jsx(_,{className:"h-7 w-7 text-white/50 group-hover:text-primary transition-colors"})}),e.jsx("p",{className:"text-white/60 font-medium group-hover:text-primary transition-colors",children:"Add New Service"})]})})]})]})}export{ke as default};
