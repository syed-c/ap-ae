import{b as R,u as E,c as I,j as i}from"./chunk-CPh6voF3.js";import{r as q}from"./chunk-CffrGP6S.js";import{G as T,n as l,Z as N,L as B,i as p,w as D,U as L,p as M,m as F,o as _,A as j,s as m,b as w}from"./index-DflORfjh.js";import{C as g,d as f,a as Q,b as O,c as V}from"./chunk-Dwq_v72W.js";import{S as $}from"./chunk-DfjE-bP6.js";import{c as G}from"./chunk-BSjc5zjM.js";import{M as d}from"./chunk-B7d2qnKb.js";import{C as W}from"./chunk-j7XJPWWF.js";import{T as H}from"./chunk-C2a9wZiP.js";import{S as U,B as Z,A as K}from"./chunk-C2VW2Ml6.js";import{B as b}from"./chunk-Bl7VVhKV.js";import"./chunk-B8auUmee.js";import"./chunk-DK8nT4cj.js";import"./chunk-Drd-rt-S.js";import"./chunk-BEQ5VEiB.js";import"./chunk-yff5u8mE.js";import"./chunk-xExVBHTi.js";const s=[{id:"clinic_profiles",key:"clinic_profiles",name:"Clinic Profiles",description:"Public clinic listings and profiles",icon:D,category:"core"},{id:"dentist_profiles",key:"dentist_profiles",name:"Dentist Profiles",description:"Individual dentist pages",icon:L,category:"core"},{id:"search_directory",key:"search_directory",name:"Search & Directory",description:"Location-based clinic search",icon:M,category:"core"},{id:"appointment_booking",key:"appointment_booking",name:"Appointment Booking",description:"Online booking functionality",icon:F,category:"core"},{id:"clinic_claiming",key:"clinic_claiming",name:"Clinic Claiming",description:"Allow dentists to claim profiles",icon:_,category:"core"},{id:"sms_notifications",key:"sms_notifications",name:"SMS Notifications",description:"Send SMS to patients",icon:d,category:"messaging"},{id:"whatsapp_notifications",key:"whatsapp_notifications",name:"WhatsApp Notifications",description:"Send WhatsApp messages",icon:d,category:"messaging",isPremium:!0},{id:"email_notifications",key:"email_notifications",name:"Email Notifications",description:"Email communication system",icon:j,category:"messaging"},{id:"appointment_reminders",key:"appointment_reminders",name:"Appointment Reminders",description:"Automated reminders before appointments",icon:Z,category:"messaging"},{id:"review_collection",key:"review_collection",name:"Review Collection",description:"Review request system",icon:l,category:"reputation"},{id:"review_funnel",key:"review_funnel",name:"Review Funnel",description:"Thumbs up/down review routing",icon:l,category:"reputation"},{id:"qr_code_reviews",key:"qr_code_reviews",name:"QR Code Reviews",description:"QR codes for review collection",icon:l,category:"reputation"},{id:"ai_review_replies",key:"ai_review_replies",name:"AI Review Replies",description:"AI-suggested review responses",icon:b,category:"reputation",isPremium:!0},{id:"automation_rules",key:"automation_rules",name:"Automation Rules",description:"Custom automation workflows",icon:N,category:"automation",isPremium:!0},{id:"ai_insights",key:"ai_insights",name:"AI Insights",description:"AI-powered analytics",icon:b,category:"automation",isPremium:!0},{id:"outreach_campaigns",key:"outreach_campaigns",name:"Outreach Campaigns",description:"Email marketing campaigns",icon:j,category:"automation"},{id:"dedicated_crm_number",key:"dedicated_crm_number",name:"Dedicated CRM Number",description:"Private virtual number for dentists",icon:d,category:"premium",isPremium:!0},{id:"advanced_analytics",key:"advanced_analytics",name:"Advanced Analytics",description:"Detailed performance reports",icon:K,category:"premium",isPremium:!0},{id:"priority_support",key:"priority_support",name:"Priority Support",description:"Fast-track support tickets",icon:_,category:"premium",isPremium:!0}];function pe(){const S=R(),[c,k]=q.useState("core"),{data:y,isLoading:C}=E({queryKey:["platform-services-settings"],queryFn:async()=>{const{data:e,error:t}=await m.from("global_settings").select("*").eq("key","platform_services").single();if(t&&t.code!=="PGRST116")throw t;return e?.value||{}}}),h=I({mutationFn:async({serviceKey:e,enabled:t,config:r})=>{const a=y||{},n={...a,[e]:{enabled:t,config:r||a[e]?.config||{}}},v=await m.from("global_settings").select("id").eq("key","platform_services").single();if(v.data){const{error:o}=await m.from("global_settings").update({value:n,updated_at:new Date().toISOString()}).eq("id",v.data.id);if(o)throw o}else{const{error:o}=await m.from("global_settings").insert([{key:"platform_services",value:n}]);if(o)throw o}await G({action:t?"ENABLE_SERVICE":"DISABLE_SERVICE",entityType:"platform_service",entityId:e,newValues:{enabled:t}})},onSuccess:()=>{S.invalidateQueries({queryKey:["platform-services-settings"]}),w.success("Service updated")},onError:e=>w.error(e.message)}),u=e=>y?.[e]?.enabled??!0,x=[{id:"core",name:"Core Features",icon:T,count:s.filter(e=>e.category==="core").length},{id:"messaging",name:"Messaging",icon:d,count:s.filter(e=>e.category==="messaging").length},{id:"reputation",name:"Reputation",icon:l,count:s.filter(e=>e.category==="reputation").length},{id:"automation",name:"Automation",icon:N,count:s.filter(e=>e.category==="automation").length},{id:"premium",name:"Premium",icon:W,count:s.filter(e=>e.category==="premium").length}],A=s.filter(e=>e.category===c),P=s.filter(e=>u(e.key)).length;return C?i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx(B,{className:"h-8 w-8 animate-spin text-primary"})}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-display font-bold text-foreground",children:"Platform Services"}),i.jsx("p",{className:"text-muted-foreground mt-1",children:"Control which features are available across the platform"})]}),i.jsxs(p,{variant:"secondary",className:"text-lg px-4 py-2",children:[P," / ",s.length," Active"]})]}),i.jsx("div",{className:"grid grid-cols-5 gap-4",children:x.map(e=>{const t=e.icon,a=s.filter(n=>n.category===e.id).filter(n=>u(n.key)).length;return i.jsx(g,{className:`card-modern cursor-pointer transition-all ${c===e.id?"ring-2 ring-primary":""}`,onClick:()=>k(e.id),children:i.jsx(f,{className:"p-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:`h-10 w-10 rounded-xl flex items-center justify-center ${c===e.id?"bg-primary text-primary-foreground":"bg-muted"}`,children:i.jsx(t,{className:"h-5 w-5"})}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-sm",children:e.name}),i.jsxs("p",{className:"text-xs text-muted-foreground",children:[a,"/",e.count," active"]})]})]})})},e.id)})}),i.jsxs(g,{className:"card-modern",children:[i.jsxs(Q,{children:[i.jsxs(O,{className:"flex items-center gap-2",children:[i.jsx(H,{className:"h-5 w-5"}),x.find(e=>e.id===c)?.name," Services"]}),i.jsx(V,{children:"Toggle services on/off to control availability across the entire platform"})]}),i.jsx(f,{className:"space-y-4",children:A.map(e=>{const t=e.icon,r=u(e.key);return i.jsxs("div",{className:"flex items-center justify-between p-4 rounded-xl bg-muted/50 hover:bg-muted transition-colors",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:`h-12 w-12 rounded-xl flex items-center justify-center ${r?"bg-primary/10":"bg-muted"}`,children:i.jsx(t,{className:`h-6 w-6 ${r?"text-primary":"text-muted-foreground"}`})}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("p",{className:"font-medium",children:e.name}),e.isPremium&&i.jsx(p,{className:"bg-gold/20 text-gold text-xs",children:"Premium"})]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:e.description})]})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(p,{variant:r?"default":"secondary",children:r?"Active":"Disabled"}),i.jsx($,{checked:r,onCheckedChange:a=>h.mutate({serviceKey:e.key,enabled:a}),disabled:h.isPending})]})]},e.id)})})]}),i.jsx(g,{className:"card-modern border-blue-custom/20 bg-blue-light",children:i.jsx(f,{className:"p-4",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx(U,{className:"h-5 w-5 text-blue-custom mt-0.5"}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-blue-custom",children:"How Platform Services Work"}),i.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Disabling a service will hide it from all users (dentists and patients) across the platform. This is useful for temporarily disabling features during maintenance or for phased rollouts. Premium features can be controlled separately via Plan feature bundling."})]})]})})})]})}export{pe as default};
